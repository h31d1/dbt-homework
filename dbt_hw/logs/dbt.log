2021-10-06 07:37:53.887860 (MainThread): Running with dbt=0.19.0
2021-10-06 07:37:54.227331 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 07:37:54.246998 (MainThread): Tracking: tracking
2021-10-06 07:37:54.250954 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda1a999a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda50a0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda1aab100>]}
2021-10-06 07:37:54.307828 (MainThread): Partial parsing not enabled
2021-10-06 07:37:54.318007 (MainThread): Parsing macros/relations.sql
2021-10-06 07:37:54.325271 (MainThread): Parsing macros/adapters.sql
2021-10-06 07:37:54.353119 (MainThread): Parsing macros/catalog.sql
2021-10-06 07:37:54.359357 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 07:37:54.367557 (MainThread): Parsing macros/core.sql
2021-10-06 07:37:54.377853 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 07:37:54.436182 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 07:37:54.449210 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 07:37:54.462452 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 07:37:54.477333 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 07:37:54.511963 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 07:37:54.516387 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 07:37:54.552192 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 07:37:54.569767 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 07:37:54.601921 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 07:37:54.611300 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 07:37:54.628930 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 07:37:54.644459 (MainThread): Parsing macros/etc/query.sql
2021-10-06 07:37:54.648352 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 07:37:54.653586 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 07:37:54.668649 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 07:37:54.683421 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 07:37:54.688334 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 07:37:54.692258 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 07:37:54.698303 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 07:37:54.705643 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 07:37:54.709726 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 07:37:54.725269 (MainThread): Partial parsing not enabled
2021-10-06 07:37:54.787883 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:37:55.151321 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 07:37:55.161952 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f35770fb-3c9e-4ae4-a5c5-012cf05e0a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda1941520>]}
2021-10-06 07:37:55.241464 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 07:37:55.254619 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-10-06 07:37:55.260143 (MainThread): 
2021-10-06 07:37:55.266829 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:37:55.280976 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 07:37:55.309878 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 07:37:55.314867 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 07:37:55.317780 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 07:37:55.355209 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.04 seconds
2021-10-06 07:37:55.381971 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 07:37:55.393068 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 07:37:55.421319 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:37:55.426888 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 07:37:55.432185 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 07:37:55.444427 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:37:55.447764 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:37:55.450861 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 07:37:55.477360 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 07:37:55.496494 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 07:37:55.499908 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 07:37:55.521876 (MainThread): Using postgres connection "master".
2021-10-06 07:37:55.526385 (MainThread): On master: BEGIN
2021-10-06 07:37:55.529802 (MainThread): Opening a new connection, currently in state init
2021-10-06 07:37:55.543157 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:37:55.547377 (MainThread): Using postgres connection "master".
2021-10-06 07:37:55.554254 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 07:37:55.597895 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-10-06 07:37:55.600514 (MainThread): On master: ROLLBACK
2021-10-06 07:37:55.605016 (MainThread): Using postgres connection "master".
2021-10-06 07:37:55.607023 (MainThread): On master: BEGIN
2021-10-06 07:37:55.610476 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:37:55.613765 (MainThread): On master: COMMIT
2021-10-06 07:37:55.616755 (MainThread): Using postgres connection "master".
2021-10-06 07:37:55.621544 (MainThread): On master: COMMIT
2021-10-06 07:37:55.624559 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:37:55.628752 (MainThread): On master: Close
2021-10-06 07:37:55.632015 (MainThread): 07:37:55 | Concurrency: 2 threads (target='dev')
2021-10-06 07:37:55.635010 (MainThread): 07:37:55 | 
2021-10-06 07:37:55.667107 (Thread-1): Began running node model.my_new_project.firstnames
2021-10-06 07:37:55.672592 (Thread-1): 07:37:55 | 1 of 1 START table model public.firstnames........................... [RUN]
2021-10-06 07:37:55.676373 (Thread-1): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:37:55.684005 (Thread-1): Compiling model.my_new_project.firstnames
2021-10-06 07:37:55.729610 (Thread-1): Writing injected SQL for node "model.my_new_project.firstnames"
2021-10-06 07:37:55.787923 (Thread-1): finished collecting timing info
2021-10-06 07:37:55.841147 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:37:55.844830 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_tmp" cascade
2021-10-06 07:37:55.847425 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 07:37:55.858936 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 07:37:55.874650 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:37:55.879664 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 07:37:55.884774 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 07:37:55.920652 (Thread-1): Writing runtime SQL for node "model.my_new_project.firstnames"
2021-10-06 07:37:55.957806 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:37:55.960768 (Thread-1): On model.my_new_project.firstnames: BEGIN
2021-10-06 07:37:55.964345 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:37:55.967890 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:37:55.974856 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */


  create  table "dellstore"."public"."firstnames__dbt_tmp"
  as (
    -- 1) TASK
-- Requirements:
-- create a table with following columns:
-- first name of the actor/actress
-- number of movies where such first name has been an actor
-- sum of the price of the movies where such first name has been an actor

-- Use dbt - models, sources, snapshotting
-- try inserting a new row into the products table + running the snapshot again

-- table


-- select
select first_name, count(distinct title), sum(price) from "dellstore"."public"."products" p
join (
	select distinct concat(split_part(actor, ' ', 1),'%') first_name from "dellstore"."public"."products"
) b
on p.actor like b.first_name
group by 1
order by 1
  );
2021-10-06 07:37:56.265430 (Thread-1): SQL status: SELECT 200 in 0.29 seconds
2021-10-06 07:37:56.283427 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:37:56.286502 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames__dbt_tmp" rename to "firstnames"
2021-10-06 07:37:56.294269 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 07:37:56.317869 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 07:37:56.322307 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:37:56.326658 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 07:37:56.332615 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:37:56.340706 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:37:56.343287 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 07:37:56.346842 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 07:37:56.355759 (Thread-1): finished collecting timing info
2021-10-06 07:37:56.359496 (Thread-1): On model.my_new_project.firstnames: Close
2021-10-06 07:37:56.382919 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f35770fb-3c9e-4ae4-a5c5-012cf05e0a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda19cd730>]}
2021-10-06 07:37:56.395560 (Thread-1): 07:37:56 | 1 of 1 OK created table model public.firstnames...................... [SELECT 200 in 0.71s]
2021-10-06 07:37:56.402484 (Thread-1): Finished running node model.my_new_project.firstnames
2021-10-06 07:37:56.419441 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:37:56.427347 (MainThread): Using postgres connection "master".
2021-10-06 07:37:56.434873 (MainThread): On master: BEGIN
2021-10-06 07:37:56.438936 (MainThread): Opening a new connection, currently in state closed
2021-10-06 07:37:56.452927 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:37:56.457392 (MainThread): On master: COMMIT
2021-10-06 07:37:56.459695 (MainThread): Using postgres connection "master".
2021-10-06 07:37:56.464049 (MainThread): On master: COMMIT
2021-10-06 07:37:56.469526 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:37:56.472898 (MainThread): On master: Close
2021-10-06 07:37:56.478960 (MainThread): 07:37:56 | 
2021-10-06 07:37:56.483472 (MainThread): 07:37:56 | Finished running 1 table model in 1.21s.
2021-10-06 07:37:56.486614 (MainThread): Connection 'master' was properly closed.
2021-10-06 07:37:56.491030 (MainThread): Connection 'list_dellstore' was properly closed.
2021-10-06 07:37:56.494495 (MainThread): Connection 'model.my_new_project.firstnames' was properly closed.
2021-10-06 07:37:56.586191 (MainThread): 
2021-10-06 07:37:56.643025 (MainThread): Completed successfully
2021-10-06 07:37:56.649791 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 07:37:56.654910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda18b6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda19775e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda196c970>]}
2021-10-06 07:37:56.662716 (MainThread): Flushing usage events
2021-10-06 07:41:42.074075 (MainThread): Running with dbt=0.19.0
2021-10-06 07:41:42.299924 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['firstnames'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 07:41:42.308766 (MainThread): Tracking: tracking
2021-10-06 07:41:42.311985 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12a1459a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12bbef2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12a155190>]}
2021-10-06 07:41:42.366614 (MainThread): Partial parsing not enabled
2021-10-06 07:41:42.372864 (MainThread): Parsing macros/relations.sql
2021-10-06 07:41:42.386737 (MainThread): Parsing macros/adapters.sql
2021-10-06 07:41:42.427074 (MainThread): Parsing macros/catalog.sql
2021-10-06 07:41:42.441458 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 07:41:42.455413 (MainThread): Parsing macros/core.sql
2021-10-06 07:41:42.468602 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 07:41:42.513348 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 07:41:42.524567 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 07:41:42.533005 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 07:41:42.540306 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 07:41:42.562040 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 07:41:42.566331 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 07:41:42.599522 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 07:41:42.615656 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 07:41:42.639675 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 07:41:42.644237 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 07:41:42.652705 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 07:41:42.661919 (MainThread): Parsing macros/etc/query.sql
2021-10-06 07:41:42.665137 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 07:41:42.670042 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 07:41:42.682151 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 07:41:42.686785 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 07:41:42.691037 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 07:41:42.697545 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 07:41:42.701794 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 07:41:42.707342 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 07:41:42.712277 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 07:41:42.728094 (MainThread): Partial parsing not enabled
2021-10-06 07:41:42.789006 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:41:42.838286 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:41:43.004231 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa129fd6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12a01ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa129f74a30>]}
2021-10-06 07:41:43.006684 (MainThread): Flushing usage events
2021-10-06 07:41:43.554206 (MainThread): Connection 'snapshot.my_new_project.firstnames_snapshot' was properly closed.
2021-10-06 07:41:43.562046 (MainThread): Encountered an error:
2021-10-06 07:41:43.567196 (MainThread): Compilation Error in snapshot firstnames_snapshot (snapshots/firstnames.sql)
  Snapshot 'snapshot.my_new_project.firstnames_snapshot' (snapshots/firstnames.sql) depends on a source named 'dells.firstnames' which was not found
2021-10-06 07:41:43.577778 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 795, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 498, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in snapshot firstnames_snapshot (snapshots/firstnames.sql)
  Snapshot 'snapshot.my_new_project.firstnames_snapshot' (snapshots/firstnames.sql) depends on a source named 'dells.firstnames' which was not found

2021-10-06 07:43:26.698563 (MainThread): Running with dbt=0.19.0
2021-10-06 07:43:26.953554 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['firstnames'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 07:43:26.965849 (MainThread): Tracking: tracking
2021-10-06 07:43:26.969720 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6f9df940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b72fe6460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6f9f1130>]}
2021-10-06 07:43:27.027702 (MainThread): Partial parsing not enabled
2021-10-06 07:43:27.034852 (MainThread): Parsing macros/relations.sql
2021-10-06 07:43:27.044478 (MainThread): Parsing macros/adapters.sql
2021-10-06 07:43:27.072407 (MainThread): Parsing macros/catalog.sql
2021-10-06 07:43:27.077565 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 07:43:27.083551 (MainThread): Parsing macros/core.sql
2021-10-06 07:43:27.090019 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 07:43:27.147317 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 07:43:27.166061 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 07:43:27.180121 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 07:43:27.188479 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 07:43:27.210805 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 07:43:27.216072 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 07:43:27.256282 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 07:43:27.279340 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 07:43:27.303955 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 07:43:27.309009 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 07:43:27.319975 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 07:43:27.335942 (MainThread): Parsing macros/etc/query.sql
2021-10-06 07:43:27.341701 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 07:43:27.347956 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 07:43:27.367422 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 07:43:27.373941 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 07:43:27.380698 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 07:43:27.385957 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 07:43:27.392825 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 07:43:27.400988 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 07:43:27.406549 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 07:43:27.430009 (MainThread): Partial parsing not enabled
2021-10-06 07:43:27.498166 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:27.538720 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:43:27.760520 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 07:43:27.767221 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f86f84d-a7ac-4de5-9c9f-a4c0bb1ef419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6f812130>]}
2021-10-06 07:43:27.821446 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 07:43:27.827570 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 07:43:27.832963 (MainThread): 
2021-10-06 07:43:27.837648 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:43:27.843703 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 07:43:27.865233 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 07:43:27.867598 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 07:43:27.869999 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 07:43:27.883678 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-06 07:43:27.894456 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 07:43:27.906623 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 07:43:27.916705 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:43:27.918967 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 07:43:27.921225 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 07:43:27.928425 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:43:27.931501 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:43:27.935199 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 07:43:27.941571 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-06 07:43:27.953737 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 07:43:27.956239 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 07:43:27.968458 (MainThread): Using postgres connection "master".
2021-10-06 07:43:27.970862 (MainThread): On master: BEGIN
2021-10-06 07:43:27.972900 (MainThread): Opening a new connection, currently in state init
2021-10-06 07:43:27.983463 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:43:27.988034 (MainThread): Using postgres connection "master".
2021-10-06 07:43:27.992428 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 07:43:28.003702 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 07:43:28.006503 (MainThread): On master: ROLLBACK
2021-10-06 07:43:28.009063 (MainThread): Using postgres connection "master".
2021-10-06 07:43:28.011983 (MainThread): On master: BEGIN
2021-10-06 07:43:28.015707 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:43:28.018843 (MainThread): On master: COMMIT
2021-10-06 07:43:28.021315 (MainThread): Using postgres connection "master".
2021-10-06 07:43:28.023833 (MainThread): On master: COMMIT
2021-10-06 07:43:28.028607 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:43:28.032139 (MainThread): On master: Close
2021-10-06 07:43:28.035711 (MainThread): 07:43:28 | Concurrency: 2 threads (target='dev')
2021-10-06 07:43:28.039725 (MainThread): 07:43:28 | 
2021-10-06 07:43:28.055089 (Thread-1): Began running node model.my_new_project.firstnames
2021-10-06 07:43:28.066606 (Thread-1): 07:43:28 | 1 of 1 START table model public.firstnames........................... [RUN]
2021-10-06 07:43:28.075314 (Thread-1): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:28.082168 (Thread-1): Compiling model.my_new_project.firstnames
2021-10-06 07:43:28.131863 (Thread-1): Writing injected SQL for node "model.my_new_project.firstnames"
2021-10-06 07:43:28.141754 (Thread-1): finished collecting timing info
2021-10-06 07:43:28.194427 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:28.197918 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_tmp" cascade
2021-10-06 07:43:28.201310 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 07:43:28.213710 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 07:43:28.222067 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:28.224431 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 07:43:28.227509 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 07:43:28.242899 (Thread-1): Writing runtime SQL for node "model.my_new_project.firstnames"
2021-10-06 07:43:28.251496 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:28.254090 (Thread-1): On model.my_new_project.firstnames: BEGIN
2021-10-06 07:43:28.258366 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:43:28.261843 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:28.265108 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */


  create  table "dellstore"."public"."firstnames__dbt_tmp"
  as (
    -- 1) TASK
-- Requirements:
-- create a table with following columns:
-- first name of the actor/actress
-- number of movies where such first name has been an actor
-- sum of the price of the movies where such first name has been an actor

-- Use dbt - models, sources, snapshotting
-- try inserting a new row into the products table + running the snapshot again

-- table


-- select
select first_name as id, count(distinct title) title_count, sum(price) price_sum from "dellstore"."public"."products" p
join (
	select distinct concat(split_part(actor, ' ', 1),'%') first_name from "dellstore"."public"."products"
) b
on p.actor like b.first_name
group by 1
order by 1
  );
2021-10-06 07:43:28.421089 (Thread-1): SQL status: SELECT 200 in 0.15 seconds
2021-10-06 07:43:28.432829 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:28.435464 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames" rename to "firstnames__dbt_backup"
2021-10-06 07:43:28.439725 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 07:43:28.445239 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:28.447370 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames__dbt_tmp" rename to "firstnames"
2021-10-06 07:43:28.449930 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 07:43:28.458366 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 07:43:28.460681 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:28.462990 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 07:43:28.466673 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:43:28.471858 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:28.473948 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 07:43:28.483339 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 07:43:28.488029 (Thread-1): finished collecting timing info
2021-10-06 07:43:28.490619 (Thread-1): On model.my_new_project.firstnames: Close
2021-10-06 07:43:28.493757 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f86f84d-a7ac-4de5-9c9f-a4c0bb1ef419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6f9132b0>]}
2021-10-06 07:43:28.497833 (Thread-1): 07:43:28 | 1 of 1 OK created table model public.firstnames...................... [SELECT 200 in 0.42s]
2021-10-06 07:43:28.499834 (Thread-1): Finished running node model.my_new_project.firstnames
2021-10-06 07:43:28.504647 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:43:28.507724 (MainThread): Using postgres connection "master".
2021-10-06 07:43:28.511791 (MainThread): On master: BEGIN
2021-10-06 07:43:28.515413 (MainThread): Opening a new connection, currently in state closed
2021-10-06 07:43:28.524437 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:43:28.529243 (MainThread): On master: COMMIT
2021-10-06 07:43:28.532867 (MainThread): Using postgres connection "master".
2021-10-06 07:43:28.536002 (MainThread): On master: COMMIT
2021-10-06 07:43:28.540016 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:43:28.545107 (MainThread): On master: Close
2021-10-06 07:43:28.550531 (MainThread): 07:43:28 | 
2021-10-06 07:43:28.554834 (MainThread): 07:43:28 | Finished running 1 table model in 0.71s.
2021-10-06 07:43:28.560774 (MainThread): Connection 'master' was properly closed.
2021-10-06 07:43:28.567422 (MainThread): Connection 'model.my_new_project.firstnames' was properly closed.
2021-10-06 07:43:28.641920 (MainThread): 
2021-10-06 07:43:28.645032 (MainThread): Completed successfully
2021-10-06 07:43:28.649397 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 07:43:28.654776 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6f8370a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6f89b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6f7bd100>]}
2021-10-06 07:43:28.659519 (MainThread): Flushing usage events
2021-10-06 07:43:46.992093 (MainThread): Running with dbt=0.19.0
2021-10-06 07:43:47.199088 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-06 07:43:47.212671 (MainThread): Tracking: tracking
2021-10-06 07:43:47.218263 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c0b01820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c4107430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c0b12250>]}
2021-10-06 07:43:47.265846 (MainThread): Partial parsing not enabled
2021-10-06 07:43:47.269441 (MainThread): Parsing macros/relations.sql
2021-10-06 07:43:47.276505 (MainThread): Parsing macros/adapters.sql
2021-10-06 07:43:47.316311 (MainThread): Parsing macros/catalog.sql
2021-10-06 07:43:47.324687 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 07:43:47.332218 (MainThread): Parsing macros/core.sql
2021-10-06 07:43:47.347892 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 07:43:47.396911 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 07:43:47.410254 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 07:43:47.419723 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 07:43:47.428283 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 07:43:47.450888 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 07:43:47.457626 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 07:43:47.494634 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 07:43:47.513065 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 07:43:47.537760 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 07:43:47.542916 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 07:43:47.552658 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 07:43:47.562954 (MainThread): Parsing macros/etc/query.sql
2021-10-06 07:43:47.566522 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 07:43:47.570969 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 07:43:47.583231 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 07:43:47.587508 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 07:43:47.591237 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 07:43:47.595458 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 07:43:47.599561 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 07:43:47.604237 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 07:43:47.608580 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 07:43:47.627669 (MainThread): Partial parsing not enabled
2021-10-06 07:43:47.673701 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:43:47.709360 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:43:47.894745 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 07:43:47.900292 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ae19105-017e-448f-831c-7534405b41f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c09cef40>]}
2021-10-06 07:43:47.948357 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 07:43:47.951427 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 07:43:47.955576 (MainThread): 
2021-10-06 07:43:47.959677 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:43:47.970100 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 07:43:47.988160 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 07:43:47.991440 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 07:43:47.994013 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 07:43:48.006963 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-06 07:43:48.013903 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 07:43:48.020696 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 07:43:48.030904 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:43:48.033412 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 07:43:48.036214 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 07:43:48.043673 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:43:48.046246 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:43:48.050168 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 07:43:48.056230 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-06 07:43:48.073134 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 07:43:48.076398 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 07:43:48.086985 (MainThread): Using postgres connection "master".
2021-10-06 07:43:48.088992 (MainThread): On master: BEGIN
2021-10-06 07:43:48.091284 (MainThread): Opening a new connection, currently in state init
2021-10-06 07:43:48.098928 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:43:48.101709 (MainThread): Using postgres connection "master".
2021-10-06 07:43:48.106879 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 07:43:48.117203 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-06 07:43:48.119761 (MainThread): On master: ROLLBACK
2021-10-06 07:43:48.122313 (MainThread): Using postgres connection "master".
2021-10-06 07:43:48.124181 (MainThread): On master: BEGIN
2021-10-06 07:43:48.127636 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:43:48.130551 (MainThread): On master: COMMIT
2021-10-06 07:43:48.133290 (MainThread): Using postgres connection "master".
2021-10-06 07:43:48.136437 (MainThread): On master: COMMIT
2021-10-06 07:43:48.139026 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:43:48.141278 (MainThread): On master: Close
2021-10-06 07:43:48.145953 (MainThread): 07:43:48 | Concurrency: 2 threads (target='dev')
2021-10-06 07:43:48.148853 (MainThread): 07:43:48 | 
2021-10-06 07:43:48.157836 (Thread-1): Began running node snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:43:48.164069 (Thread-1): 07:43:48 | 1 of 1 START snapshot public.firstnames_snapshot..................... [RUN]
2021-10-06 07:43:48.169340 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:43:48.173913 (Thread-1): Compiling snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:43:48.214874 (Thread-1): finished collecting timing info
2021-10-06 07:43:48.280686 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:43:48.283983 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-06 07:43:48.287223 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 07:43:48.298420 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-06 07:43:48.344319 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:43:48.348068 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-06 07:43:48.354405 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-06 07:43:48.377678 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.firstnames_snapshot"
2021-10-06 07:43:48.391559 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:43:48.394837 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: BEGIN
2021-10-06 07:43:48.397705 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:43:48.401285 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:43:48.405046 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      

  create  table "dellstore"."public"."firstnames_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast('2021-10-06 07:43:48.296509'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        '2021-10-06 07:43:48.296509'::timestamp without time zone as dbt_updated_at,
        '2021-10-06 07:43:48.296509'::timestamp without time zone as dbt_valid_from,
        nullif('2021-10-06 07:43:48.296509'::timestamp without time zone, '2021-10-06 07:43:48.296509'::timestamp without time zone) as dbt_valid_to
    from (
        



select * from "dellstore"."public"."firstnames"

    ) sbq


  );
  
2021-10-06 07:43:48.419249 (Thread-1): SQL status: SELECT 200 in 0.01 seconds
2021-10-06 07:43:48.431249 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: COMMIT
2021-10-06 07:43:48.433950 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:43:48.436393 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: COMMIT
2021-10-06 07:43:48.441141 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:43:48.448471 (Thread-1): finished collecting timing info
2021-10-06 07:43:48.450958 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: Close
2021-10-06 07:43:48.453718 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae19105-017e-448f-831c-7534405b41f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c0925b80>]}
2021-10-06 07:43:48.458127 (Thread-1): 07:43:48 | 1 of 1 OK snapshotted public.firstnames_snapshot..................... [SELECT 200 in 0.28s]
2021-10-06 07:43:48.460384 (Thread-1): Finished running node snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:43:48.466600 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:43:48.469672 (MainThread): Using postgres connection "master".
2021-10-06 07:43:48.473343 (MainThread): On master: BEGIN
2021-10-06 07:43:48.475468 (MainThread): Opening a new connection, currently in state closed
2021-10-06 07:43:48.483394 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:43:48.486126 (MainThread): On master: COMMIT
2021-10-06 07:43:48.489171 (MainThread): Using postgres connection "master".
2021-10-06 07:43:48.492141 (MainThread): On master: COMMIT
2021-10-06 07:43:48.494394 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:43:48.497668 (MainThread): On master: Close
2021-10-06 07:43:48.500343 (MainThread): 07:43:48 | 
2021-10-06 07:43:48.502507 (MainThread): 07:43:48 | Finished running 1 snapshot in 0.54s.
2021-10-06 07:43:48.506715 (MainThread): Connection 'master' was properly closed.
2021-10-06 07:43:48.511394 (MainThread): Connection 'list_dellstore' was properly closed.
2021-10-06 07:43:48.516435 (MainThread): Connection 'snapshot.my_new_project.firstnames_snapshot' was properly closed.
2021-10-06 07:43:48.563658 (MainThread): 
2021-10-06 07:43:48.566611 (MainThread): Completed successfully
2021-10-06 07:43:48.570544 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 07:43:48.574611 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c0a54a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c0996a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c09bc130>]}
2021-10-06 07:43:48.579130 (MainThread): Flushing usage events
2021-10-06 07:49:25.798824 (MainThread): Running with dbt=0.19.0
2021-10-06 07:49:26.006908 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 07:49:26.019066 (MainThread): Tracking: tracking
2021-10-06 07:49:26.028135 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61235dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff615964400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61236f0d0>]}
2021-10-06 07:49:26.098804 (MainThread): Partial parsing not enabled
2021-10-06 07:49:26.114183 (MainThread): Parsing macros/relations.sql
2021-10-06 07:49:26.129146 (MainThread): Parsing macros/adapters.sql
2021-10-06 07:49:26.158488 (MainThread): Parsing macros/catalog.sql
2021-10-06 07:49:26.168977 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 07:49:26.180583 (MainThread): Parsing macros/core.sql
2021-10-06 07:49:26.193777 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 07:49:26.238548 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 07:49:26.251780 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 07:49:26.261210 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 07:49:26.269603 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 07:49:26.291714 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 07:49:26.296030 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 07:49:26.330719 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 07:49:26.348373 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 07:49:26.378225 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 07:49:26.382782 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 07:49:26.391908 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 07:49:26.402167 (MainThread): Parsing macros/etc/query.sql
2021-10-06 07:49:26.405686 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 07:49:26.409819 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 07:49:26.421580 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 07:49:26.426018 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 07:49:26.430168 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 07:49:26.434007 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 07:49:26.438296 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 07:49:26.444135 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 07:49:26.448873 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 07:49:26.465045 (MainThread): Partial parsing not enabled
2021-10-06 07:49:26.506451 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:26.542815 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:26.754276 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 07:49:26.760153 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b10871f-9281-4dfe-8c80-d1603cdaf677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6122268e0>]}
2021-10-06 07:49:26.810574 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 07:49:26.813764 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 07:49:26.817828 (MainThread): 
2021-10-06 07:49:26.821577 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:49:26.833793 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 07:49:26.851958 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 07:49:26.854890 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 07:49:26.858669 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 07:49:26.871689 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-06 07:49:26.882964 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 07:49:26.891722 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 07:49:26.902681 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:49:26.905285 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 07:49:26.907370 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 07:49:26.915435 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:49:26.918263 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:49:26.921268 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 07:49:26.927158 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-06 07:49:26.945126 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 07:49:26.948247 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 07:49:26.959867 (MainThread): Using postgres connection "master".
2021-10-06 07:49:26.962201 (MainThread): On master: BEGIN
2021-10-06 07:49:26.964454 (MainThread): Opening a new connection, currently in state init
2021-10-06 07:49:26.973199 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:49:26.976823 (MainThread): Using postgres connection "master".
2021-10-06 07:49:26.980634 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 07:49:26.990395 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 07:49:26.992551 (MainThread): On master: ROLLBACK
2021-10-06 07:49:26.995199 (MainThread): Using postgres connection "master".
2021-10-06 07:49:26.997154 (MainThread): On master: BEGIN
2021-10-06 07:49:27.000669 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:49:27.003492 (MainThread): On master: COMMIT
2021-10-06 07:49:27.007766 (MainThread): Using postgres connection "master".
2021-10-06 07:49:27.009894 (MainThread): On master: COMMIT
2021-10-06 07:49:27.012484 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:49:27.014678 (MainThread): On master: Close
2021-10-06 07:49:27.017203 (MainThread): 07:49:27 | Concurrency: 2 threads (target='dev')
2021-10-06 07:49:27.021286 (MainThread): 07:49:27 | 
2021-10-06 07:49:27.031757 (Thread-1): Began running node model.my_new_project.firstnames
2021-10-06 07:49:27.037094 (Thread-1): 07:49:27 | 1 of 1 START table model public.firstnames........................... [RUN]
2021-10-06 07:49:27.040708 (Thread-1): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:27.046649 (Thread-1): Compiling model.my_new_project.firstnames
2021-10-06 07:49:27.070266 (Thread-1): Writing injected SQL for node "model.my_new_project.firstnames"
2021-10-06 07:49:27.079817 (Thread-1): finished collecting timing info
2021-10-06 07:49:27.117721 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:27.120086 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_tmp" cascade
2021-10-06 07:49:27.122831 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 07:49:27.129137 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 07:49:27.135678 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:27.138311 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 07:49:27.141064 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 07:49:27.161312 (Thread-1): Writing runtime SQL for node "model.my_new_project.firstnames"
2021-10-06 07:49:27.169026 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:27.171804 (Thread-1): On model.my_new_project.firstnames: BEGIN
2021-10-06 07:49:27.174310 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:49:27.177276 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:27.180025 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */


  create  table "dellstore"."public"."firstnames__dbt_tmp"
  as (
    -- 1) TASK
-- Requirements:
-- create a table with following columns:
-- first name of the actor/actress
-- number of movies where such first name has been an actor
-- sum of the price of the movies where such first name has been an actor

-- Use dbt - models, sources, snapshotting
-- try inserting a new row into the products table + running the snapshot again

-- table


-- select
select first_name as id, count(distinct title) title_count, sum(price) price_sum from "dellstore"."public"."products" p
join (
	select distinct concat(split_part(actor, ' ', 1),'%') first_name from "dellstore"."public"."products"
) b
on p.actor like b.first_name
group by 1
order by 1
  );
2021-10-06 07:49:27.397485 (Thread-1): SQL status: SELECT 201 in 0.21 seconds
2021-10-06 07:49:27.416465 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:27.419098 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames" rename to "firstnames__dbt_backup"
2021-10-06 07:49:27.426510 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 07:49:27.439431 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:27.442785 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames__dbt_tmp" rename to "firstnames"
2021-10-06 07:49:27.446040 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 07:49:27.458066 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 07:49:27.460619 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:27.462898 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 07:49:27.466258 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:49:27.475552 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:27.478040 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 07:49:27.482358 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 07:49:27.487665 (Thread-1): finished collecting timing info
2021-10-06 07:49:27.490094 (Thread-1): On model.my_new_project.firstnames: Close
2021-10-06 07:49:27.495914 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b10871f-9281-4dfe-8c80-d1603cdaf677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6121896d0>]}
2021-10-06 07:49:27.500581 (Thread-1): 07:49:27 | 1 of 1 OK created table model public.firstnames...................... [SELECT 201 in 0.46s]
2021-10-06 07:49:27.503829 (Thread-1): Finished running node model.my_new_project.firstnames
2021-10-06 07:49:27.508919 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:49:27.511625 (MainThread): Using postgres connection "master".
2021-10-06 07:49:27.516643 (MainThread): On master: BEGIN
2021-10-06 07:49:27.519567 (MainThread): Opening a new connection, currently in state closed
2021-10-06 07:49:27.534314 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:49:27.538656 (MainThread): On master: COMMIT
2021-10-06 07:49:27.541973 (MainThread): Using postgres connection "master".
2021-10-06 07:49:27.546370 (MainThread): On master: COMMIT
2021-10-06 07:49:27.550670 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:49:27.553803 (MainThread): On master: Close
2021-10-06 07:49:27.556925 (MainThread): 07:49:27 | 
2021-10-06 07:49:27.559016 (MainThread): 07:49:27 | Finished running 1 table model in 0.74s.
2021-10-06 07:49:27.562589 (MainThread): Connection 'master' was properly closed.
2021-10-06 07:49:27.568077 (MainThread): Connection 'model.my_new_project.firstnames' was properly closed.
2021-10-06 07:49:27.622817 (MainThread): 
2021-10-06 07:49:27.625766 (MainThread): Completed successfully
2021-10-06 07:49:27.628993 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 07:49:27.633553 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6122ca340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6122a77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6122a7dc0>]}
2021-10-06 07:49:27.655045 (MainThread): Flushing usage events
2021-10-06 07:49:37.964423 (MainThread): Running with dbt=0.19.0
2021-10-06 07:49:38.208374 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-06 07:49:38.221124 (MainThread): Tracking: tracking
2021-10-06 07:49:38.230198 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6656f2a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66589d5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6656f3c310>]}
2021-10-06 07:49:38.298252 (MainThread): Partial parsing not enabled
2021-10-06 07:49:38.304798 (MainThread): Parsing macros/relations.sql
2021-10-06 07:49:38.313817 (MainThread): Parsing macros/adapters.sql
2021-10-06 07:49:38.341555 (MainThread): Parsing macros/catalog.sql
2021-10-06 07:49:38.346264 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 07:49:38.350852 (MainThread): Parsing macros/core.sql
2021-10-06 07:49:38.356780 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 07:49:38.399678 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 07:49:38.417467 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 07:49:38.426135 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 07:49:38.434842 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 07:49:38.456352 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 07:49:38.460807 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 07:49:38.493822 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 07:49:38.510674 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 07:49:38.536704 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 07:49:38.541347 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 07:49:38.550462 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 07:49:38.560001 (MainThread): Parsing macros/etc/query.sql
2021-10-06 07:49:38.563524 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 07:49:38.571032 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 07:49:38.583604 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 07:49:38.587887 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 07:49:38.591966 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 07:49:38.595323 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 07:49:38.599106 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 07:49:38.604110 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 07:49:38.608341 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 07:49:38.632824 (MainThread): Partial parsing not enabled
2021-10-06 07:49:38.699607 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:49:38.751430 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:38.939532 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 07:49:38.946521 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56f49f99-a8b1-4d28-ab8a-8a199ebbd9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6656d3e850>]}
2021-10-06 07:49:39.014526 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 07:49:39.018638 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 07:49:39.024081 (MainThread): 
2021-10-06 07:49:39.028465 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:49:39.045250 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 07:49:39.077793 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 07:49:39.081669 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 07:49:39.084723 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 07:49:39.093786 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-06 07:49:39.100247 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 07:49:39.109427 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 07:49:39.120993 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:49:39.123442 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 07:49:39.126153 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 07:49:39.135025 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:49:39.139300 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:49:39.143948 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 07:49:39.151999 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-06 07:49:39.171585 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 07:49:39.175074 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 07:49:39.188090 (MainThread): Using postgres connection "master".
2021-10-06 07:49:39.190424 (MainThread): On master: BEGIN
2021-10-06 07:49:39.192838 (MainThread): Opening a new connection, currently in state init
2021-10-06 07:49:39.201629 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:49:39.204430 (MainThread): Using postgres connection "master".
2021-10-06 07:49:39.208360 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 07:49:39.219148 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 07:49:39.222088 (MainThread): On master: ROLLBACK
2021-10-06 07:49:39.225225 (MainThread): Using postgres connection "master".
2021-10-06 07:49:39.227987 (MainThread): On master: BEGIN
2021-10-06 07:49:39.232200 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:49:39.235373 (MainThread): On master: COMMIT
2021-10-06 07:49:39.237202 (MainThread): Using postgres connection "master".
2021-10-06 07:49:39.239160 (MainThread): On master: COMMIT
2021-10-06 07:49:39.241793 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:49:39.244424 (MainThread): On master: Close
2021-10-06 07:49:39.247085 (MainThread): 07:49:39 | Concurrency: 2 threads (target='dev')
2021-10-06 07:49:39.250219 (MainThread): 07:49:39 | 
2021-10-06 07:49:39.262557 (Thread-1): Began running node snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:49:39.267999 (Thread-1): 07:49:39 | 1 of 1 START snapshot public.firstnames_snapshot..................... [RUN]
2021-10-06 07:49:39.273163 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.276826 (Thread-1): Compiling snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:49:39.298365 (Thread-1): finished collecting timing info
2021-10-06 07:49:39.338470 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.341373 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-06 07:49:39.346463 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 07:49:39.353947 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-06 07:49:39.394342 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.397270 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-06 07:49:39.401022 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-06 07:49:39.423465 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.425528 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: BEGIN
2021-10-06 07:49:39.428603 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:49:39.431055 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.434095 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-06 07:49:39.475409 (Thread-1): SQL status: SELECT 7 in 0.04 seconds
2021-10-06 07:49:39.524155 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.527307 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

        

  create temporary table "firstnames_snapshot__dbt_tmp074939507420"
  as (
    with snapshot_query as (

        



select * from "dellstore"."public"."firstnames"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "dellstore"."public"."firstnames_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            '2021-10-06 07:49:39.352656'::timestamp without time zone as dbt_updated_at,
            '2021-10-06 07:49:39.352656'::timestamp without time zone as dbt_valid_from,
            nullif('2021-10-06 07:49:39.352656'::timestamp without time zone, '2021-10-06 07:49:39.352656'::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast('2021-10-06 07:49:39.352656'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            '2021-10-06 07:49:39.352656'::timestamp without time zone as dbt_updated_at,
            '2021-10-06 07:49:39.352656'::timestamp without time zone as dbt_valid_from,
            '2021-10-06 07:49:39.352656'::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.title_count != source_data.title_count
        or
        (
            ((snapshotted_data.title_count is null) and not (source_data.title_count is null))
            or
            ((not snapshotted_data.title_count is null) and (source_data.title_count is null))
        ) or snapshotted_data.price_sum != source_data.price_sum
        or
        (
            ((snapshotted_data.price_sum is null) and not (source_data.price_sum is null))
            or
            ((not snapshotted_data.price_sum is null) and (source_data.price_sum is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.title_count != source_data.title_count
        or
        (
            ((snapshotted_data.title_count is null) and not (source_data.title_count is null))
            or
            ((not snapshotted_data.title_count is null) and (source_data.title_count is null))
        ) or snapshotted_data.price_sum != source_data.price_sum
        or
        (
            ((snapshotted_data.price_sum is null) and not (source_data.price_sum is null))
            or
            ((not snapshotted_data.price_sum is null) and (source_data.price_sum is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates
  );
    
2021-10-06 07:49:39.548346 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-10-06 07:49:39.559581 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.564203 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot__dbt_tmp074939507420'
        
      order by ordinal_position

  
2021-10-06 07:49:39.575220 (Thread-1): SQL status: SELECT 9 in 0.01 seconds
2021-10-06 07:49:39.586343 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.588987 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-06 07:49:39.598144 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-10-06 07:49:39.607863 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.611158 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot__dbt_tmp074939507420'
        
      order by ordinal_position

  
2021-10-06 07:49:39.628327 (Thread-1): SQL status: SELECT 9 in 0.01 seconds
2021-10-06 07:49:39.648293 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.652635 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-06 07:49:39.667700 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-10-06 07:49:39.695445 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.700413 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot__dbt_tmp074939507420'
        
      order by ordinal_position

  
2021-10-06 07:49:39.720687 (Thread-1): SQL status: SELECT 9 in 0.01 seconds
2021-10-06 07:49:39.764577 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.firstnames_snapshot"
2021-10-06 07:49:39.795915 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.800815 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      update "dellstore"."public"."firstnames_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "firstnames_snapshot__dbt_tmp074939507420" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dellstore"."public"."firstnames_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dellstore"."public"."firstnames_snapshot".dbt_valid_to is null;

    insert into "dellstore"."public"."firstnames_snapshot" ("id", "title_count", "price_sum", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title_count",DBT_INTERNAL_SOURCE."price_sum",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "firstnames_snapshot__dbt_tmp074939507420" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
2021-10-06 07:49:39.815086 (Thread-1): SQL status: INSERT 0 1 in 0.01 seconds
2021-10-06 07:49:39.839422 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: COMMIT
2021-10-06 07:49:39.842117 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:49:39.844881 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: COMMIT
2021-10-06 07:49:39.851054 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:49:39.858071 (Thread-1): finished collecting timing info
2021-10-06 07:49:39.862199 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: Close
2021-10-06 07:49:39.867453 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56f49f99-a8b1-4d28-ab8a-8a199ebbd9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6656d5e1f0>]}
2021-10-06 07:49:39.873269 (Thread-1): 07:49:39 | 1 of 1 OK snapshotted public.firstnames_snapshot..................... [INSERT 0 1 in 0.60s]
2021-10-06 07:49:39.877233 (Thread-1): Finished running node snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:49:39.887530 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:49:39.891889 (MainThread): Using postgres connection "master".
2021-10-06 07:49:39.894455 (MainThread): On master: BEGIN
2021-10-06 07:49:39.897101 (MainThread): Opening a new connection, currently in state closed
2021-10-06 07:49:39.908949 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:49:39.913197 (MainThread): On master: COMMIT
2021-10-06 07:49:39.927448 (MainThread): Using postgres connection "master".
2021-10-06 07:49:39.930792 (MainThread): On master: COMMIT
2021-10-06 07:49:39.934282 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:49:39.938071 (MainThread): On master: Close
2021-10-06 07:49:39.940994 (MainThread): 07:49:39 | 
2021-10-06 07:49:39.943324 (MainThread): 07:49:39 | Finished running 1 snapshot in 0.91s.
2021-10-06 07:49:39.947494 (MainThread): Connection 'master' was properly closed.
2021-10-06 07:49:39.952362 (MainThread): Connection 'list_dellstore' was properly closed.
2021-10-06 07:49:39.955960 (MainThread): Connection 'snapshot.my_new_project.firstnames_snapshot' was properly closed.
2021-10-06 07:49:40.023570 (MainThread): 
2021-10-06 07:49:40.026592 (MainThread): Completed successfully
2021-10-06 07:49:40.032421 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 07:49:40.037035 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6656d4f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6656d2b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6656dbe520>]}
2021-10-06 07:49:40.042145 (MainThread): Flushing usage events
2021-10-06 07:51:45.109655 (MainThread): Running with dbt=0.19.0
2021-10-06 07:51:45.352416 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 07:51:45.366190 (MainThread): Tracking: tracking
2021-10-06 07:51:45.371923 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3005f9d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3007a48310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3005fae1c0>]}
2021-10-06 07:51:45.442579 (MainThread): Partial parsing not enabled
2021-10-06 07:51:45.446522 (MainThread): Parsing macros/relations.sql
2021-10-06 07:51:45.451570 (MainThread): Parsing macros/adapters.sql
2021-10-06 07:51:45.475966 (MainThread): Parsing macros/catalog.sql
2021-10-06 07:51:45.481313 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 07:51:45.486680 (MainThread): Parsing macros/core.sql
2021-10-06 07:51:45.493330 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 07:51:45.540209 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 07:51:45.552980 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 07:51:45.563158 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 07:51:45.572073 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 07:51:45.592996 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 07:51:45.597537 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 07:51:45.630459 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 07:51:45.646871 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 07:51:45.672510 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 07:51:45.677800 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 07:51:45.686154 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 07:51:45.695013 (MainThread): Parsing macros/etc/query.sql
2021-10-06 07:51:45.698360 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 07:51:45.703016 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 07:51:45.714106 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 07:51:45.718251 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 07:51:45.722214 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 07:51:45.725837 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 07:51:45.729598 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 07:51:45.734538 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 07:51:45.739226 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 07:51:45.756586 (MainThread): Partial parsing not enabled
2021-10-06 07:51:45.876952 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:45.928982 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:46.116467 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 07:51:46.123422 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da8524a0-0353-404a-8b9d-afb6aaf80259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3005dd0280>]}
2021-10-06 07:51:46.169368 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 07:51:46.172449 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 07:51:46.175541 (MainThread): 
2021-10-06 07:51:46.179292 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:51:46.187587 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 07:51:46.204229 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 07:51:46.206905 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 07:51:46.210368 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 07:51:46.218771 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 07:51:46.226401 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 07:51:46.235207 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 07:51:46.246450 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:51:46.248558 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 07:51:46.251770 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 07:51:46.259298 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:51:46.261958 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:51:46.266223 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 07:51:46.270671 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-06 07:51:46.280206 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 07:51:46.283395 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 07:51:46.294333 (MainThread): Using postgres connection "master".
2021-10-06 07:51:46.297085 (MainThread): On master: BEGIN
2021-10-06 07:51:46.298895 (MainThread): Opening a new connection, currently in state init
2021-10-06 07:51:46.306810 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:51:46.309437 (MainThread): Using postgres connection "master".
2021-10-06 07:51:46.312859 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 07:51:46.324639 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 07:51:46.327727 (MainThread): On master: ROLLBACK
2021-10-06 07:51:46.330726 (MainThread): Using postgres connection "master".
2021-10-06 07:51:46.333388 (MainThread): On master: BEGIN
2021-10-06 07:51:46.335941 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:51:46.339397 (MainThread): On master: COMMIT
2021-10-06 07:51:46.344388 (MainThread): Using postgres connection "master".
2021-10-06 07:51:46.347185 (MainThread): On master: COMMIT
2021-10-06 07:51:46.351130 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:51:46.354190 (MainThread): On master: Close
2021-10-06 07:51:46.357391 (MainThread): 07:51:46 | Concurrency: 2 threads (target='dev')
2021-10-06 07:51:46.360732 (MainThread): 07:51:46 | 
2021-10-06 07:51:46.369454 (Thread-1): Began running node model.my_new_project.firstnames
2021-10-06 07:51:46.373481 (Thread-1): 07:51:46 | 1 of 1 START table model public.firstnames........................... [RUN]
2021-10-06 07:51:46.379573 (Thread-1): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:46.385566 (Thread-1): Compiling model.my_new_project.firstnames
2021-10-06 07:51:46.409733 (Thread-1): Writing injected SQL for node "model.my_new_project.firstnames"
2021-10-06 07:51:46.417122 (Thread-1): finished collecting timing info
2021-10-06 07:51:46.447030 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:46.449211 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_tmp" cascade
2021-10-06 07:51:46.451241 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 07:51:46.458342 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 07:51:46.463135 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:46.465917 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 07:51:46.469116 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 07:51:46.488170 (Thread-1): Writing runtime SQL for node "model.my_new_project.firstnames"
2021-10-06 07:51:46.496356 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:46.499401 (Thread-1): On model.my_new_project.firstnames: BEGIN
2021-10-06 07:51:46.504481 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:51:46.508030 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:46.511190 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */


  create  table "dellstore"."public"."firstnames__dbt_tmp"
  as (
    -- 1) TASK
-- Requirements:
-- create a table with following columns:
-- first name of the actor/actress
-- number of movies where such first name has been an actor
-- sum of the price of the movies where such first name has been an actor

-- Use dbt - models, sources, snapshotting
-- try inserting a new row into the products table + running the snapshot again

-- table


-- select
select first_name as id, count(distinct title) title_count, sum(price) price_sum from "dellstore"."public"."products" p
join (
	select distinct concat(split_part(actor, ' ', 1),'%') first_name from "dellstore"."public"."products"
) b
on p.actor like b.first_name
group by 1
order by 1
  );
2021-10-06 07:51:46.655117 (Thread-1): SQL status: SELECT 201 in 0.14 seconds
2021-10-06 07:51:46.665103 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:46.667242 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames" rename to "firstnames__dbt_backup"
2021-10-06 07:51:46.669744 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 07:51:46.674102 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:46.676158 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames__dbt_tmp" rename to "firstnames"
2021-10-06 07:51:46.680203 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 07:51:46.689575 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 07:51:46.691502 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:46.693390 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 07:51:46.696887 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:51:46.702932 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:46.705113 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 07:51:46.714238 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 07:51:46.720226 (Thread-1): finished collecting timing info
2021-10-06 07:51:46.722862 (Thread-1): On model.my_new_project.firstnames: Close
2021-10-06 07:51:46.727227 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da8524a0-0353-404a-8b9d-afb6aaf80259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3005e51790>]}
2021-10-06 07:51:46.732984 (Thread-1): 07:51:46 | 1 of 1 OK created table model public.firstnames...................... [SELECT 201 in 0.35s]
2021-10-06 07:51:46.735992 (Thread-1): Finished running node model.my_new_project.firstnames
2021-10-06 07:51:46.741926 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:51:46.745946 (MainThread): Using postgres connection "master".
2021-10-06 07:51:46.747932 (MainThread): On master: BEGIN
2021-10-06 07:51:46.750539 (MainThread): Opening a new connection, currently in state closed
2021-10-06 07:51:46.757672 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:51:46.768424 (MainThread): On master: COMMIT
2021-10-06 07:51:46.771943 (MainThread): Using postgres connection "master".
2021-10-06 07:51:46.775312 (MainThread): On master: COMMIT
2021-10-06 07:51:46.789255 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-10-06 07:51:46.796282 (MainThread): On master: Close
2021-10-06 07:51:46.799494 (MainThread): 07:51:46 | 
2021-10-06 07:51:46.802326 (MainThread): 07:51:46 | Finished running 1 table model in 0.62s.
2021-10-06 07:51:46.808840 (MainThread): Connection 'master' was properly closed.
2021-10-06 07:51:46.815157 (MainThread): Connection 'model.my_new_project.firstnames' was properly closed.
2021-10-06 07:51:46.887121 (MainThread): 
2021-10-06 07:51:46.890111 (MainThread): Completed successfully
2021-10-06 07:51:46.893626 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 07:51:46.901030 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3005ffccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3005e57fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3005db28e0>]}
2021-10-06 07:51:46.907369 (MainThread): Flushing usage events
2021-10-06 07:51:49.955177 (MainThread): Running with dbt=0.19.0
2021-10-06 07:51:50.227266 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-06 07:51:50.238529 (MainThread): Tracking: tracking
2021-10-06 07:51:50.250627 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75afea910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75ca96370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75affb340>]}
2021-10-06 07:51:50.336920 (MainThread): Partial parsing not enabled
2021-10-06 07:51:50.351411 (MainThread): Parsing macros/relations.sql
2021-10-06 07:51:50.361158 (MainThread): Parsing macros/adapters.sql
2021-10-06 07:51:50.423325 (MainThread): Parsing macros/catalog.sql
2021-10-06 07:51:50.432781 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 07:51:50.442423 (MainThread): Parsing macros/core.sql
2021-10-06 07:51:50.481272 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 07:51:50.545413 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 07:51:50.564750 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 07:51:50.581030 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 07:51:50.588791 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 07:51:50.611712 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 07:51:50.618899 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 07:51:50.657321 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 07:51:50.681387 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 07:51:50.720751 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 07:51:50.725620 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 07:51:50.735254 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 07:51:50.749352 (MainThread): Parsing macros/etc/query.sql
2021-10-06 07:51:50.753814 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 07:51:50.759236 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 07:51:50.776490 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 07:51:50.791273 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 07:51:50.805164 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 07:51:50.815563 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 07:51:50.824398 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 07:51:50.835579 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 07:51:50.844541 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 07:51:50.872163 (MainThread): Partial parsing not enabled
2021-10-06 07:51:50.962094 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:51:51.017445 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:51.297796 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 07:51:51.308215 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43c3a7c4-380c-41b7-81b0-5f2134211c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75aec7e50>]}
2021-10-06 07:51:51.397368 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 07:51:51.401912 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 07:51:51.409522 (MainThread): 
2021-10-06 07:51:51.414166 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:51:51.422842 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 07:51:51.451004 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 07:51:51.458329 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 07:51:51.462343 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 07:51:51.474632 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 07:51:51.480871 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 07:51:51.492649 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 07:51:51.507690 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:51:51.510817 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 07:51:51.513946 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 07:51:51.521445 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:51:51.525280 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:51:51.528342 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 07:51:51.534916 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-06 07:51:51.549722 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 07:51:51.553293 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 07:51:51.571613 (MainThread): Using postgres connection "master".
2021-10-06 07:51:51.575323 (MainThread): On master: BEGIN
2021-10-06 07:51:51.578858 (MainThread): Opening a new connection, currently in state init
2021-10-06 07:51:51.593603 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:51:51.598270 (MainThread): Using postgres connection "master".
2021-10-06 07:51:51.604192 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 07:51:51.619733 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 07:51:51.623171 (MainThread): On master: ROLLBACK
2021-10-06 07:51:51.626882 (MainThread): Using postgres connection "master".
2021-10-06 07:51:51.629567 (MainThread): On master: BEGIN
2021-10-06 07:51:51.632472 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:51:51.636584 (MainThread): On master: COMMIT
2021-10-06 07:51:51.641667 (MainThread): Using postgres connection "master".
2021-10-06 07:51:51.645222 (MainThread): On master: COMMIT
2021-10-06 07:51:51.650167 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:51:51.654002 (MainThread): On master: Close
2021-10-06 07:51:51.657469 (MainThread): 07:51:51 | Concurrency: 2 threads (target='dev')
2021-10-06 07:51:51.662136 (MainThread): 07:51:51 | 
2021-10-06 07:51:51.675503 (Thread-1): Began running node snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:51:51.678888 (Thread-1): 07:51:51 | 1 of 1 START snapshot public.firstnames_snapshot..................... [RUN]
2021-10-06 07:51:51.681910 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:51.686256 (Thread-1): Compiling snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:51:51.718905 (Thread-1): finished collecting timing info
2021-10-06 07:51:51.783279 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:51.786074 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-06 07:51:51.788502 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 07:51:51.798070 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-06 07:51:51.925155 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:51.927683 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-06 07:51:51.930533 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-06 07:51:51.960417 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:51.964476 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: BEGIN
2021-10-06 07:51:51.972410 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:51:51.975436 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:51.980191 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-06 07:51:52.001495 (Thread-1): SQL status: SELECT 7 in 0.02 seconds
2021-10-06 07:51:52.047057 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:52.050673 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

        

  create temporary table "firstnames_snapshot__dbt_tmp075152032892"
  as (
    with snapshot_query as (

        



select * from "dellstore"."public"."firstnames"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "dellstore"."public"."firstnames_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            '2021-10-06 07:51:51.796926'::timestamp without time zone as dbt_updated_at,
            '2021-10-06 07:51:51.796926'::timestamp without time zone as dbt_valid_from,
            nullif('2021-10-06 07:51:51.796926'::timestamp without time zone, '2021-10-06 07:51:51.796926'::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast('2021-10-06 07:51:51.796926'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            '2021-10-06 07:51:51.796926'::timestamp without time zone as dbt_updated_at,
            '2021-10-06 07:51:51.796926'::timestamp without time zone as dbt_valid_from,
            '2021-10-06 07:51:51.796926'::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.title_count != source_data.title_count
        or
        (
            ((snapshotted_data.title_count is null) and not (source_data.title_count is null))
            or
            ((not snapshotted_data.title_count is null) and (source_data.title_count is null))
        ) or snapshotted_data.price_sum != source_data.price_sum
        or
        (
            ((snapshotted_data.price_sum is null) and not (source_data.price_sum is null))
            or
            ((not snapshotted_data.price_sum is null) and (source_data.price_sum is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.title_count != source_data.title_count
        or
        (
            ((snapshotted_data.title_count is null) and not (source_data.title_count is null))
            or
            ((not snapshotted_data.title_count is null) and (source_data.title_count is null))
        ) or snapshotted_data.price_sum != source_data.price_sum
        or
        (
            ((snapshotted_data.price_sum is null) and not (source_data.price_sum is null))
            or
            ((not snapshotted_data.price_sum is null) and (source_data.price_sum is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates
  );
    
2021-10-06 07:51:52.063535 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 07:51:52.071151 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:52.073685 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot__dbt_tmp075152032892'
        
      order by ordinal_position

  
2021-10-06 07:51:52.079876 (Thread-1): SQL status: SELECT 9 in 0.00 seconds
2021-10-06 07:51:52.086181 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:52.088575 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-06 07:51:52.094924 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-10-06 07:51:52.101550 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:52.103869 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot__dbt_tmp075152032892'
        
      order by ordinal_position

  
2021-10-06 07:51:52.118502 (Thread-1): SQL status: SELECT 9 in 0.01 seconds
2021-10-06 07:51:52.125876 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:52.127711 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-06 07:51:52.133206 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-10-06 07:51:52.142562 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:52.145086 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot__dbt_tmp075152032892'
        
      order by ordinal_position

  
2021-10-06 07:51:52.150504 (Thread-1): SQL status: SELECT 9 in 0.00 seconds
2021-10-06 07:51:52.161514 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.firstnames_snapshot"
2021-10-06 07:51:52.170569 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:52.173026 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      update "dellstore"."public"."firstnames_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "firstnames_snapshot__dbt_tmp075152032892" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dellstore"."public"."firstnames_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dellstore"."public"."firstnames_snapshot".dbt_valid_to is null;

    insert into "dellstore"."public"."firstnames_snapshot" ("id", "title_count", "price_sum", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title_count",DBT_INTERNAL_SOURCE."price_sum",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "firstnames_snapshot__dbt_tmp075152032892" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
2021-10-06 07:51:52.177204 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-06 07:51:52.187251 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: COMMIT
2021-10-06 07:51:52.189555 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:51:52.191966 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: COMMIT
2021-10-06 07:51:52.195566 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:51:52.202279 (Thread-1): finished collecting timing info
2021-10-06 07:51:52.205175 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: Close
2021-10-06 07:51:52.209038 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43c3a7c4-380c-41b7-81b0-5f2134211c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75ae46fa0>]}
2021-10-06 07:51:52.219350 (Thread-1): 07:51:52 | 1 of 1 OK snapshotted public.firstnames_snapshot..................... [INSERT 0 1 in 0.53s]
2021-10-06 07:51:52.222992 (Thread-1): Finished running node snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:51:52.228405 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:51:52.231902 (MainThread): Using postgres connection "master".
2021-10-06 07:51:52.234461 (MainThread): On master: BEGIN
2021-10-06 07:51:52.237063 (MainThread): Opening a new connection, currently in state closed
2021-10-06 07:51:52.245963 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:51:52.249437 (MainThread): On master: COMMIT
2021-10-06 07:51:52.253024 (MainThread): Using postgres connection "master".
2021-10-06 07:51:52.256189 (MainThread): On master: COMMIT
2021-10-06 07:51:52.261365 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:51:52.264861 (MainThread): On master: Close
2021-10-06 07:51:52.269622 (MainThread): 07:51:52 | 
2021-10-06 07:51:52.274914 (MainThread): 07:51:52 | Finished running 1 snapshot in 0.85s.
2021-10-06 07:51:52.278507 (MainThread): Connection 'master' was properly closed.
2021-10-06 07:51:52.282480 (MainThread): Connection 'snapshot.my_new_project.firstnames_snapshot' was properly closed.
2021-10-06 07:51:52.339483 (MainThread): 
2021-10-06 07:51:52.341849 (MainThread): Completed successfully
2021-10-06 07:51:52.344581 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 07:51:52.349477 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75aec48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75ae84040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75aec7700>]}
2021-10-06 07:51:52.362588 (MainThread): Flushing usage events
2021-10-06 07:55:10.232658 (MainThread): Running with dbt=0.19.0
2021-10-06 07:55:10.501693 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 07:55:10.519714 (MainThread): Tracking: tracking
2021-10-06 07:55:10.526903 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597f0ec970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5980b18280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597f0fd160>]}
2021-10-06 07:55:10.609437 (MainThread): Partial parsing not enabled
2021-10-06 07:55:10.632411 (MainThread): Parsing macros/relations.sql
2021-10-06 07:55:10.639324 (MainThread): Parsing macros/adapters.sql
2021-10-06 07:55:10.673347 (MainThread): Parsing macros/catalog.sql
2021-10-06 07:55:10.678576 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 07:55:10.683847 (MainThread): Parsing macros/core.sql
2021-10-06 07:55:10.690963 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 07:55:10.739352 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 07:55:10.750970 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 07:55:10.760657 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 07:55:10.768180 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 07:55:10.790163 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 07:55:10.794698 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 07:55:10.832853 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 07:55:10.855557 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 07:55:10.883550 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 07:55:10.887616 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 07:55:10.896278 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 07:55:10.906264 (MainThread): Parsing macros/etc/query.sql
2021-10-06 07:55:10.909782 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 07:55:10.918649 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 07:55:10.932014 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 07:55:10.936518 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 07:55:10.940481 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 07:55:10.943925 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 07:55:10.947872 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 07:55:10.952611 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 07:55:10.956741 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 07:55:10.971618 (MainThread): Partial parsing not enabled
2021-10-06 07:55:11.012647 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:11.048402 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:11.225493 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 07:55:11.231764 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5f0e007-090c-44cc-8fb1-eb39ed586bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597efc5c10>]}
2021-10-06 07:55:11.288339 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 07:55:11.292313 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 07:55:11.296548 (MainThread): 
2021-10-06 07:55:11.302078 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:55:11.311622 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 07:55:11.331714 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 07:55:11.333687 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 07:55:11.336870 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 07:55:11.345697 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 07:55:11.350955 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 07:55:11.362688 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 07:55:11.374734 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:55:11.377222 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 07:55:11.379515 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 07:55:11.388274 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:55:11.390552 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:55:11.392490 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 07:55:11.397308 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-06 07:55:11.424483 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 07:55:11.428544 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 07:55:11.452411 (MainThread): Using postgres connection "master".
2021-10-06 07:55:11.454477 (MainThread): On master: BEGIN
2021-10-06 07:55:11.456486 (MainThread): Opening a new connection, currently in state init
2021-10-06 07:55:11.469794 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:55:11.477502 (MainThread): Using postgres connection "master".
2021-10-06 07:55:11.483462 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 07:55:11.499987 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 07:55:11.503619 (MainThread): On master: ROLLBACK
2021-10-06 07:55:11.507329 (MainThread): Using postgres connection "master".
2021-10-06 07:55:11.510754 (MainThread): On master: BEGIN
2021-10-06 07:55:11.515288 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:55:11.519049 (MainThread): On master: COMMIT
2021-10-06 07:55:11.522797 (MainThread): Using postgres connection "master".
2021-10-06 07:55:11.526349 (MainThread): On master: COMMIT
2021-10-06 07:55:11.530243 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:55:11.532834 (MainThread): On master: Close
2021-10-06 07:55:11.536205 (MainThread): 07:55:11 | Concurrency: 2 threads (target='dev')
2021-10-06 07:55:11.540615 (MainThread): 07:55:11 | 
2021-10-06 07:55:11.550897 (Thread-1): Began running node model.my_new_project.firstnames
2021-10-06 07:55:11.557521 (Thread-1): 07:55:11 | 1 of 1 START table model public.firstnames........................... [RUN]
2021-10-06 07:55:11.562548 (Thread-1): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:11.576006 (Thread-1): Compiling model.my_new_project.firstnames
2021-10-06 07:55:11.602150 (Thread-1): Writing injected SQL for node "model.my_new_project.firstnames"
2021-10-06 07:55:11.611529 (Thread-1): finished collecting timing info
2021-10-06 07:55:11.642187 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:11.644722 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_tmp" cascade
2021-10-06 07:55:11.646712 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 07:55:11.654237 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 07:55:11.658986 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:11.661428 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 07:55:11.664082 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 07:55:11.677250 (Thread-1): Writing runtime SQL for node "model.my_new_project.firstnames"
2021-10-06 07:55:11.683556 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:11.685528 (Thread-1): On model.my_new_project.firstnames: BEGIN
2021-10-06 07:55:11.687885 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:55:11.690786 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:11.693387 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */


  create  table "dellstore"."public"."firstnames__dbt_tmp"
  as (
    -- 1) TASK
-- Requirements:
-- create a table with following columns:
-- first name of the actor/actress
-- number of movies where such first name has been an actor
-- sum of the price of the movies where such first name has been an actor

-- Use dbt - models, sources, snapshotting
-- try inserting a new row into the products table + running the snapshot again

-- table


-- select
select first_name as id, count(distinct title) title_count, sum(price) price_sum from "dellstore"."public"."products" p
join (
	select distinct concat(split_part(actor, ' ', 1),'%') first_name from "dellstore"."public"."products"
) b
on p.actor like b.first_name
group by 1
order by 1
  );
2021-10-06 07:55:11.833852 (Thread-1): SQL status: SELECT 201 in 0.14 seconds
2021-10-06 07:55:11.844312 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:11.846776 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames" rename to "firstnames__dbt_backup"
2021-10-06 07:55:11.851488 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 07:55:11.857437 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:11.859797 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames__dbt_tmp" rename to "firstnames"
2021-10-06 07:55:11.863086 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 07:55:11.873002 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 07:55:11.875164 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:11.876829 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 07:55:11.880739 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:55:11.892831 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:11.895912 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 07:55:11.903230 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 07:55:11.907635 (Thread-1): finished collecting timing info
2021-10-06 07:55:11.909633 (Thread-1): On model.my_new_project.firstnames: Close
2021-10-06 07:55:11.912471 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5f0e007-090c-44cc-8fb1-eb39ed586bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ef31370>]}
2021-10-06 07:55:11.915747 (Thread-1): 07:55:11 | 1 of 1 OK created table model public.firstnames...................... [SELECT 201 in 0.35s]
2021-10-06 07:55:11.917687 (Thread-1): Finished running node model.my_new_project.firstnames
2021-10-06 07:55:11.923046 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:55:11.926829 (MainThread): Using postgres connection "master".
2021-10-06 07:55:11.930781 (MainThread): On master: BEGIN
2021-10-06 07:55:11.932902 (MainThread): Opening a new connection, currently in state closed
2021-10-06 07:55:11.941281 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:55:11.944940 (MainThread): On master: COMMIT
2021-10-06 07:55:11.947614 (MainThread): Using postgres connection "master".
2021-10-06 07:55:11.949919 (MainThread): On master: COMMIT
2021-10-06 07:55:11.952479 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:55:11.954968 (MainThread): On master: Close
2021-10-06 07:55:11.958800 (MainThread): 07:55:11 | 
2021-10-06 07:55:11.961437 (MainThread): 07:55:11 | Finished running 1 table model in 0.66s.
2021-10-06 07:55:11.965406 (MainThread): Connection 'master' was properly closed.
2021-10-06 07:55:11.968012 (MainThread): Connection 'model.my_new_project.firstnames' was properly closed.
2021-10-06 07:55:12.026296 (MainThread): 
2021-10-06 07:55:12.029661 (MainThread): Completed successfully
2021-10-06 07:55:12.033477 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 07:55:12.037540 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597efedca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597efbc700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597efcfaf0>]}
2021-10-06 07:55:12.042996 (MainThread): Flushing usage events
2021-10-06 07:55:15.530643 (MainThread): Running with dbt=0.19.0
2021-10-06 07:55:15.884594 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-06 07:55:15.895148 (MainThread): Tracking: tracking
2021-10-06 07:55:15.901760 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce34638b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce4f0f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce34752e0>]}
2021-10-06 07:55:15.947290 (MainThread): Partial parsing not enabled
2021-10-06 07:55:15.951920 (MainThread): Parsing macros/relations.sql
2021-10-06 07:55:15.956957 (MainThread): Parsing macros/adapters.sql
2021-10-06 07:55:15.992077 (MainThread): Parsing macros/catalog.sql
2021-10-06 07:55:15.999377 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 07:55:16.005401 (MainThread): Parsing macros/core.sql
2021-10-06 07:55:16.018364 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 07:55:16.070636 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 07:55:16.087583 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 07:55:16.101221 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 07:55:16.110237 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 07:55:16.144117 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 07:55:16.151440 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 07:55:16.191557 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 07:55:16.212412 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 07:55:16.255482 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 07:55:16.260569 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 07:55:16.276531 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 07:55:16.296261 (MainThread): Parsing macros/etc/query.sql
2021-10-06 07:55:16.307278 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 07:55:16.312470 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 07:55:16.331149 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 07:55:16.338368 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 07:55:16.346072 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 07:55:16.353426 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 07:55:16.359940 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 07:55:16.369333 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 07:55:16.380842 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 07:55:16.410491 (MainThread): Partial parsing not enabled
2021-10-06 07:55:16.491974 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 07:55:16.583870 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:16.889941 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 07:55:16.910775 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf625b1c-128d-4d9b-995a-11d411a2b91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce3335640>]}
2021-10-06 07:55:16.974459 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 07:55:16.979477 (MainThread): Found 1 model, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 07:55:16.987581 (MainThread): 
2021-10-06 07:55:16.998391 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:55:17.006999 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 07:55:17.026762 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 07:55:17.030137 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 07:55:17.036737 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 07:55:17.053242 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 07:55:17.063620 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 07:55:17.072462 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 07:55:17.081721 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:55:17.084451 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 07:55:17.086182 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 07:55:17.094989 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:55:17.099825 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 07:55:17.103862 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 07:55:17.110323 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-06 07:55:17.129577 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 07:55:17.134080 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 07:55:17.154424 (MainThread): Using postgres connection "master".
2021-10-06 07:55:17.156697 (MainThread): On master: BEGIN
2021-10-06 07:55:17.158561 (MainThread): Opening a new connection, currently in state init
2021-10-06 07:55:17.167646 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:55:17.170642 (MainThread): Using postgres connection "master".
2021-10-06 07:55:17.174084 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 07:55:17.186949 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 07:55:17.190464 (MainThread): On master: ROLLBACK
2021-10-06 07:55:17.193968 (MainThread): Using postgres connection "master".
2021-10-06 07:55:17.197357 (MainThread): On master: BEGIN
2021-10-06 07:55:17.202455 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:55:17.205391 (MainThread): On master: COMMIT
2021-10-06 07:55:17.208505 (MainThread): Using postgres connection "master".
2021-10-06 07:55:17.210753 (MainThread): On master: COMMIT
2021-10-06 07:55:17.212875 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:55:17.215379 (MainThread): On master: Close
2021-10-06 07:55:17.220450 (MainThread): 07:55:17 | Concurrency: 2 threads (target='dev')
2021-10-06 07:55:17.223727 (MainThread): 07:55:17 | 
2021-10-06 07:55:17.233309 (Thread-1): Began running node snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:55:17.238304 (Thread-1): 07:55:17 | 1 of 1 START snapshot public.firstnames_snapshot..................... [RUN]
2021-10-06 07:55:17.243565 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.246421 (Thread-1): Compiling snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:55:17.272078 (Thread-1): finished collecting timing info
2021-10-06 07:55:17.334881 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.338265 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-06 07:55:17.342013 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 07:55:17.357022 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-10-06 07:55:17.477018 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.490380 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-06 07:55:17.504147 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-06 07:55:17.560627 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.563917 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: BEGIN
2021-10-06 07:55:17.569719 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 07:55:17.576199 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.581300 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-06 07:55:17.598983 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-10-06 07:55:17.636181 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.639343 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

        

  create temporary table "firstnames_snapshot__dbt_tmp075517621118"
  as (
    with snapshot_query as (

        



select * from "dellstore"."public"."firstnames"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "dellstore"."public"."firstnames_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            '2021-10-06 07:55:17.355717'::timestamp without time zone as dbt_updated_at,
            '2021-10-06 07:55:17.355717'::timestamp without time zone as dbt_valid_from,
            nullif('2021-10-06 07:55:17.355717'::timestamp without time zone, '2021-10-06 07:55:17.355717'::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast('2021-10-06 07:55:17.355717'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            '2021-10-06 07:55:17.355717'::timestamp without time zone as dbt_updated_at,
            '2021-10-06 07:55:17.355717'::timestamp without time zone as dbt_valid_from,
            '2021-10-06 07:55:17.355717'::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.title_count != source_data.title_count
        or
        (
            ((snapshotted_data.title_count is null) and not (source_data.title_count is null))
            or
            ((not snapshotted_data.title_count is null) and (source_data.title_count is null))
        ) or snapshotted_data.price_sum != source_data.price_sum
        or
        (
            ((snapshotted_data.price_sum is null) and not (source_data.price_sum is null))
            or
            ((not snapshotted_data.price_sum is null) and (source_data.price_sum is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.title_count != source_data.title_count
        or
        (
            ((snapshotted_data.title_count is null) and not (source_data.title_count is null))
            or
            ((not snapshotted_data.title_count is null) and (source_data.title_count is null))
        ) or snapshotted_data.price_sum != source_data.price_sum
        or
        (
            ((snapshotted_data.price_sum is null) and not (source_data.price_sum is null))
            or
            ((not snapshotted_data.price_sum is null) and (source_data.price_sum is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates
  );
    
2021-10-06 07:55:17.651319 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 07:55:17.658746 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.660912 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot__dbt_tmp075517621118'
        
      order by ordinal_position

  
2021-10-06 07:55:17.667241 (Thread-1): SQL status: SELECT 9 in 0.00 seconds
2021-10-06 07:55:17.674073 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.676035 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-06 07:55:17.681487 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-10-06 07:55:17.686774 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.688936 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot__dbt_tmp075517621118'
        
      order by ordinal_position

  
2021-10-06 07:55:17.700268 (Thread-1): SQL status: SELECT 9 in 0.01 seconds
2021-10-06 07:55:17.708032 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.710935 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-06 07:55:17.717217 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-10-06 07:55:17.727608 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.729778 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'firstnames_snapshot__dbt_tmp075517621118'
        
      order by ordinal_position

  
2021-10-06 07:55:17.736841 (Thread-1): SQL status: SELECT 9 in 0.00 seconds
2021-10-06 07:55:17.751566 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.firstnames_snapshot"
2021-10-06 07:55:17.760048 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.763336 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.firstnames_snapshot"} */

      update "dellstore"."public"."firstnames_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "firstnames_snapshot__dbt_tmp075517621118" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dellstore"."public"."firstnames_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dellstore"."public"."firstnames_snapshot".dbt_valid_to is null;

    insert into "dellstore"."public"."firstnames_snapshot" ("id", "title_count", "price_sum", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."title_count",DBT_INTERNAL_SOURCE."price_sum",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "firstnames_snapshot__dbt_tmp075517621118" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
2021-10-06 07:55:17.766833 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-06 07:55:17.778078 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: COMMIT
2021-10-06 07:55:17.781039 (Thread-1): Using postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 07:55:17.783893 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: COMMIT
2021-10-06 07:55:17.789284 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:55:17.806098 (Thread-1): finished collecting timing info
2021-10-06 07:55:17.809044 (Thread-1): On snapshot.my_new_project.firstnames_snapshot: Close
2021-10-06 07:55:17.817447 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf625b1c-128d-4d9b-995a-11d411a2b91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce33d3c40>]}
2021-10-06 07:55:17.825780 (Thread-1): 07:55:17 | 1 of 1 OK snapshotted public.firstnames_snapshot..................... [INSERT 0 1 in 0.57s]
2021-10-06 07:55:17.829359 (Thread-1): Finished running node snapshot.my_new_project.firstnames_snapshot
2021-10-06 07:55:17.835860 (MainThread): Acquiring new postgres connection "master".
2021-10-06 07:55:17.844153 (MainThread): Using postgres connection "master".
2021-10-06 07:55:17.851884 (MainThread): On master: BEGIN
2021-10-06 07:55:17.856586 (MainThread): Opening a new connection, currently in state closed
2021-10-06 07:55:17.863809 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 07:55:17.869298 (MainThread): On master: COMMIT
2021-10-06 07:55:17.872992 (MainThread): Using postgres connection "master".
2021-10-06 07:55:17.875753 (MainThread): On master: COMMIT
2021-10-06 07:55:17.878956 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 07:55:17.882746 (MainThread): On master: Close
2021-10-06 07:55:17.888469 (MainThread): 07:55:17 | 
2021-10-06 07:55:17.894214 (MainThread): 07:55:17 | Finished running 1 snapshot in 0.89s.
2021-10-06 07:55:17.897787 (MainThread): Connection 'master' was properly closed.
2021-10-06 07:55:17.903077 (MainThread): Connection 'snapshot.my_new_project.firstnames_snapshot' was properly closed.
2021-10-06 07:55:17.990825 (MainThread): 
2021-10-06 07:55:18.004989 (MainThread): Completed successfully
2021-10-06 07:55:18.009992 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 07:55:18.020816 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce33ef8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce324fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce324fca0>]}
2021-10-06 07:55:18.045232 (MainThread): Flushing usage events
2021-10-06 10:33:28.320756 (MainThread): Running with dbt=0.19.0
2021-10-06 10:33:28.830778 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:33:28.848200 (MainThread): Tracking: tracking
2021-10-06 10:33:28.852854 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184f2e7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1850d92310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184f2f8280>]}
2021-10-06 10:33:28.947714 (MainThread): Partial parsing not enabled
2021-10-06 10:33:28.954501 (MainThread): Parsing macros/relations.sql
2021-10-06 10:33:28.963306 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:33:29.003132 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:33:29.013366 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:33:29.022828 (MainThread): Parsing macros/core.sql
2021-10-06 10:33:29.033261 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:33:29.114845 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:33:29.134599 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:33:29.154402 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:33:29.170371 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:33:29.207598 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:33:29.222545 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:33:29.284787 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:33:29.312898 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:33:29.356948 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:33:29.365338 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:33:29.383369 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:33:29.398848 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:33:29.405784 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:33:29.414667 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:33:29.444460 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:33:29.452755 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:33:29.463539 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:33:29.468744 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:33:29.487537 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:33:29.497995 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:33:29.504346 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:33:29.535792 (MainThread): Partial parsing not enabled
2021-10-06 10:33:29.662528 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:33:29.763781 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:33:29.791439 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184f24b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184f1156a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184f107a90>]}
2021-10-06 10:33:29.798878 (MainThread): Flushing usage events
2021-10-06 10:33:30.377392 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:33:30.385461 (MainThread): Encountered an error:
2021-10-06 10:33:30.396500 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  expected token ':', got '}'
    line 2
      {% set n = length({{column_name}}), s = int({{column_name}}[n-1]), par = (n-1)%%2 %}
2021-10-06 10:33:30.429587 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set n = length({{column_name}}), s = int({{column_name}}[n-1]), par = (n-1)%%2 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  expected token ':', got '}'
    line 2
      {% set n = length({{column_name}}), s = int({{column_name}}[n-1]), par = (n-1)%%2 %}

2021-10-06 10:37:09.415126 (MainThread): Running with dbt=0.19.0
2021-10-06 10:37:09.724876 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:37:09.735291 (MainThread): Tracking: tracking
2021-10-06 10:37:09.739473 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fda11d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fdd724460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fda12e130>]}
2021-10-06 10:37:09.789451 (MainThread): Partial parsing not enabled
2021-10-06 10:37:09.795787 (MainThread): Parsing macros/relations.sql
2021-10-06 10:37:09.816357 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:37:09.927514 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:37:09.934768 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:37:09.942494 (MainThread): Parsing macros/core.sql
2021-10-06 10:37:09.963225 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:37:10.041949 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:37:10.070420 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:37:10.081146 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:37:10.090524 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:37:10.121410 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:37:10.126555 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:37:10.177085 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:37:10.196797 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:37:10.236176 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:37:10.247010 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:37:10.260937 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:37:10.277596 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:37:10.282825 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:37:10.289172 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:37:10.314692 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:37:10.324011 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:37:10.329579 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:37:10.334015 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:37:10.339933 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:37:10.346920 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:37:10.353102 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:37:10.382058 (MainThread): Partial parsing not enabled
2021-10-06 10:37:10.445080 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:37:10.504829 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:37:10.554198 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:37:10.817895 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:37:10.832155 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '760ade3b-3001-4590-9d08-600f1dbaa1f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fda01aa30>]}
2021-10-06 10:37:10.907483 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:37:10.912439 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:37:10.917266 (MainThread): 
2021-10-06 10:37:10.921935 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:37:10.929377 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:37:10.952346 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:37:10.956006 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:37:10.962594 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:37:10.986180 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 10:37:10.992327 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:37:11.003237 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:37:11.018669 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:37:11.021172 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:37:11.023058 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:37:11.034449 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:37:11.039138 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:37:11.043776 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:37:11.051472 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-06 10:37:11.065059 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:37:11.068014 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:37:11.088592 (MainThread): Using postgres connection "master".
2021-10-06 10:37:11.091496 (MainThread): On master: BEGIN
2021-10-06 10:37:11.094960 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:37:11.105998 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:37:11.109338 (MainThread): Using postgres connection "master".
2021-10-06 10:37:11.112108 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:37:11.124065 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 10:37:11.128435 (MainThread): On master: ROLLBACK
2021-10-06 10:37:11.132178 (MainThread): Using postgres connection "master".
2021-10-06 10:37:11.135312 (MainThread): On master: BEGIN
2021-10-06 10:37:11.139090 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:37:11.142930 (MainThread): On master: COMMIT
2021-10-06 10:37:11.145513 (MainThread): Using postgres connection "master".
2021-10-06 10:37:11.149312 (MainThread): On master: COMMIT
2021-10-06 10:37:11.154047 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:37:11.156074 (MainThread): On master: Close
2021-10-06 10:37:11.159299 (MainThread): 10:37:11 | Concurrency: 2 threads (target='dev')
2021-10-06 10:37:11.162969 (MainThread): 10:37:11 | 
2021-10-06 10:37:11.176352 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:37:11.184512 (Thread-1): 10:37:11 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:37:11.189228 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:37:11.193854 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:37:11.220800 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:37:11.240334 (Thread-1): finished collecting timing info
2021-10-06 10:37:11.307014 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:37:11.311223 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 10:37:11.318596 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:37:11.331348 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 10:37:11.338442 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:37:11.341468 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 10:37:11.345794 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 10:37:11.362748 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:37:11.387371 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:37:11.391936 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 10:37:11.395468 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:37:11.402391 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:37:11.408038 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1
  );

2021-10-06 10:37:11.440412 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2021-10-06 10:37:11.455167 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:37:11.459117 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 10:37:11.465022 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 10:37:11.479726 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 10:37:11.483016 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:37:11.487026 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 10:37:11.492115 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:37:11.501798 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:37:11.506449 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 10:37:11.511392 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 10:37:11.522741 (Thread-1): finished collecting timing info
2021-10-06 10:37:11.526426 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 10:37:11.531462 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '760ade3b-3001-4590-9d08-600f1dbaa1f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd964e3d0>]}
2021-10-06 10:37:11.541546 (Thread-1): 10:37:11 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.34s]
2021-10-06 10:37:11.545279 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:37:11.555415 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:37:11.568160 (MainThread): Using postgres connection "master".
2021-10-06 10:37:11.573353 (MainThread): On master: BEGIN
2021-10-06 10:37:11.575790 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:37:11.588123 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:37:11.592368 (MainThread): On master: COMMIT
2021-10-06 10:37:11.595503 (MainThread): Using postgres connection "master".
2021-10-06 10:37:11.601684 (MainThread): On master: COMMIT
2021-10-06 10:37:11.606525 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:37:11.609145 (MainThread): On master: Close
2021-10-06 10:37:11.613329 (MainThread): 10:37:11 | 
2021-10-06 10:37:11.617979 (MainThread): 10:37:11 | Finished running 1 view model in 0.69s.
2021-10-06 10:37:11.622523 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:37:11.626618 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:37:11.711158 (MainThread): 
2021-10-06 10:37:11.713990 (MainThread): Completed successfully
2021-10-06 10:37:11.718250 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 10:37:11.724156 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fdbb49be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd9ef43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd9ef4760>]}
2021-10-06 10:37:11.731819 (MainThread): Flushing usage events
2021-10-06 10:41:45.009839 (MainThread): Running with dbt=0.19.0
2021-10-06 10:41:45.247238 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:41:45.261000 (MainThread): Tracking: tracking
2021-10-06 10:41:45.264737 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fefefca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65025f7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64ff0010d0>]}
2021-10-06 10:41:45.304130 (MainThread): Partial parsing not enabled
2021-10-06 10:41:45.308029 (MainThread): Parsing macros/relations.sql
2021-10-06 10:41:45.312861 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:41:45.340273 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:41:45.347447 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:41:45.352663 (MainThread): Parsing macros/core.sql
2021-10-06 10:41:45.360200 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:41:45.405976 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:41:45.419993 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:41:45.430971 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:41:45.438817 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:41:45.460936 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:41:45.465432 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:41:45.501930 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:41:45.519455 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:41:45.546254 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:41:45.550764 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:41:45.559283 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:41:45.568017 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:41:45.571854 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:41:45.576260 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:41:45.586827 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:41:45.591023 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:41:45.595201 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:41:45.599226 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:41:45.604663 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:41:45.610980 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:41:45.616770 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:41:45.639019 (MainThread): Partial parsing not enabled
2021-10-06 10:41:45.686123 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:41:45.723230 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:41:45.746532 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:41:45.969654 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:41:45.980786 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c4956af-cddc-4274-8b1e-9689d292a052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fee3f070>]}
2021-10-06 10:41:46.052909 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:41:46.057195 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:41:46.062990 (MainThread): 
2021-10-06 10:41:46.072347 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:41:46.079345 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:41:46.106695 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:41:46.110133 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:41:46.114193 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:41:46.126393 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 10:41:46.132237 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:41:46.147040 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:41:46.157520 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:41:46.160663 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:41:46.163938 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:41:46.173454 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:41:46.176328 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:41:46.179056 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:41:46.186448 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 10:41:46.208486 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:41:46.213434 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:41:46.233885 (MainThread): Using postgres connection "master".
2021-10-06 10:41:46.237231 (MainThread): On master: BEGIN
2021-10-06 10:41:46.240741 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:41:46.251228 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:41:46.254517 (MainThread): Using postgres connection "master".
2021-10-06 10:41:46.261342 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:41:46.276433 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 10:41:46.286781 (MainThread): On master: ROLLBACK
2021-10-06 10:41:46.291090 (MainThread): Using postgres connection "master".
2021-10-06 10:41:46.294940 (MainThread): On master: BEGIN
2021-10-06 10:41:46.301083 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:41:46.305291 (MainThread): On master: COMMIT
2021-10-06 10:41:46.310789 (MainThread): Using postgres connection "master".
2021-10-06 10:41:46.314251 (MainThread): On master: COMMIT
2021-10-06 10:41:46.319052 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:41:46.322460 (MainThread): On master: Close
2021-10-06 10:41:46.326826 (MainThread): 10:41:46 | Concurrency: 2 threads (target='dev')
2021-10-06 10:41:46.331707 (MainThread): 10:41:46 | 
2021-10-06 10:41:46.344893 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:41:46.349336 (Thread-1): 10:41:46 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:41:46.352956 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:41:46.356990 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:41:46.390176 (Thread-1): finished collecting timing info
2021-10-06 10:41:46.395512 (Thread-1): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 9, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'Luhns' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
2021-10-06 10:41:46.413645 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4956af-cddc-4274-8b1e-9689d292a052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fedbc790>]}
2021-10-06 10:41:46.423117 (Thread-1): 10:41:46 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.06s]
2021-10-06 10:41:46.427562 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:41:46.435964 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:41:46.443264 (MainThread): Using postgres connection "master".
2021-10-06 10:41:46.448046 (MainThread): On master: BEGIN
2021-10-06 10:41:46.453509 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:41:46.469529 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-06 10:41:46.473213 (MainThread): On master: COMMIT
2021-10-06 10:41:46.476520 (MainThread): Using postgres connection "master".
2021-10-06 10:41:46.479541 (MainThread): On master: COMMIT
2021-10-06 10:41:46.482046 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:41:46.485419 (MainThread): On master: Close
2021-10-06 10:41:46.492749 (MainThread): 10:41:46 | 
2021-10-06 10:41:46.496391 (MainThread): 10:41:46 | Finished running 1 view model in 0.42s.
2021-10-06 10:41:46.502916 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:41:46.512124 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:41:46.590206 (MainThread): 
2021-10-06 10:41:46.593021 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:41:46.597731 (MainThread): 
2021-10-06 10:41:46.601616 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
2021-10-06 10:41:46.607616 (MainThread):   'Luhns' is undefined
2021-10-06 10:41:46.612988 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 10:41:46.621179 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fed8dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64feeb29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64feeb26d0>]}
2021-10-06 10:41:46.629265 (MainThread): Flushing usage events
2021-10-06 10:43:06.949452 (MainThread): Running with dbt=0.19.0
2021-10-06 10:43:07.194952 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:43:07.206768 (MainThread): Tracking: tracking
2021-10-06 10:43:07.212628 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdee9c6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf1fce430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdee9d7100>]}
2021-10-06 10:43:07.267176 (MainThread): Partial parsing not enabled
2021-10-06 10:43:07.275059 (MainThread): Parsing macros/relations.sql
2021-10-06 10:43:07.288074 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:43:07.321690 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:43:07.329374 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:43:07.335734 (MainThread): Parsing macros/core.sql
2021-10-06 10:43:07.342810 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:43:07.393820 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:43:07.406170 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:43:07.416005 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:43:07.424331 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:43:07.446519 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:43:07.451798 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:43:07.484966 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:43:07.509531 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:43:07.539725 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:43:07.550159 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:43:07.566042 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:43:07.578091 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:43:07.583413 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:43:07.593014 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:43:07.608602 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:43:07.614543 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:43:07.620634 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:43:07.625915 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:43:07.630838 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:43:07.639186 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:43:07.646181 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:43:07.665179 (MainThread): Partial parsing not enabled
2021-10-06 10:43:07.715942 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:43:07.750464 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:43:07.756158 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdee992d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdee7f5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdee7e98b0>]}
2021-10-06 10:43:07.758685 (MainThread): Flushing usage events
2021-10-06 10:43:08.313924 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:43:08.321210 (MainThread): Encountered an error:
2021-10-06 10:43:08.325499 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  expected token ':', got '}'
    line 2
      {% set {{column_name}} = 'Invalid' %}
2021-10-06 10:43:08.335128 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set {{column_name}} = 'Invalid' %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  expected token ':', got '}'
    line 2
      {% set {{column_name}} = 'Invalid' %}

2021-10-06 10:43:45.738044 (MainThread): Running with dbt=0.19.0
2021-10-06 10:43:45.948930 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:43:45.960504 (MainThread): Tracking: tracking
2021-10-06 10:43:45.964535 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7055aa4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70590a9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7055ab4100>]}
2021-10-06 10:43:46.015711 (MainThread): Partial parsing not enabled
2021-10-06 10:43:46.021676 (MainThread): Parsing macros/relations.sql
2021-10-06 10:43:46.028023 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:43:46.069646 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:43:46.074582 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:43:46.080211 (MainThread): Parsing macros/core.sql
2021-10-06 10:43:46.086384 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:43:46.130357 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:43:46.143108 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:43:46.151470 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:43:46.158545 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:43:46.179808 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:43:46.184696 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:43:46.216193 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:43:46.233763 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:43:46.258261 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:43:46.262920 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:43:46.271342 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:43:46.279980 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:43:46.283374 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:43:46.287788 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:43:46.298984 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:43:46.303619 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:43:46.307693 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:43:46.311249 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:43:46.315301 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:43:46.320501 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:43:46.324607 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:43:46.339108 (MainThread): Partial parsing not enabled
2021-10-06 10:43:46.381762 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:43:46.414274 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:43:46.437908 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:43:46.637116 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:43:46.646783 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4d4c908-9505-4778-a8ef-da1a3ba0f7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70558f30a0>]}
2021-10-06 10:43:46.713072 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:43:46.716386 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:43:46.720140 (MainThread): 
2021-10-06 10:43:46.723486 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:43:46.728667 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:43:46.743579 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:43:46.746336 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:43:46.748510 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:43:46.760131 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 10:43:46.767118 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:43:46.783158 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:43:46.804923 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:43:46.808044 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:43:46.811422 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:43:46.817810 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:43:46.820545 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:43:46.824423 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:43:46.833052 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 10:43:46.852514 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:43:46.856538 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:43:46.869729 (MainThread): Using postgres connection "master".
2021-10-06 10:43:46.872271 (MainThread): On master: BEGIN
2021-10-06 10:43:46.873957 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:43:46.880936 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:43:46.883537 (MainThread): Using postgres connection "master".
2021-10-06 10:43:46.886129 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:43:46.895358 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 10:43:46.900649 (MainThread): On master: ROLLBACK
2021-10-06 10:43:46.903251 (MainThread): Using postgres connection "master".
2021-10-06 10:43:46.905531 (MainThread): On master: BEGIN
2021-10-06 10:43:46.909233 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:43:46.912973 (MainThread): On master: COMMIT
2021-10-06 10:43:46.915204 (MainThread): Using postgres connection "master".
2021-10-06 10:43:46.918108 (MainThread): On master: COMMIT
2021-10-06 10:43:46.920572 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:43:46.922716 (MainThread): On master: Close
2021-10-06 10:43:46.925072 (MainThread): 10:43:46 | Concurrency: 2 threads (target='dev')
2021-10-06 10:43:46.927281 (MainThread): 10:43:46 | 
2021-10-06 10:43:46.936148 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:43:46.940965 (Thread-1): 10:43:46 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:43:46.946992 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:43:46.952217 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:43:46.972832 (Thread-1): finished collecting timing info
2021-10-06 10:43:46.976328 (Thread-1): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 9, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'Luhns' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
2021-10-06 10:43:46.982592 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4d4c908-9505-4778-a8ef-da1a3ba0f7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7054fede20>]}
2021-10-06 10:43:46.986233 (Thread-1): 10:43:46 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.04s]
2021-10-06 10:43:46.989358 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:43:46.996140 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:43:47.001423 (MainThread): Using postgres connection "master".
2021-10-06 10:43:47.003558 (MainThread): On master: BEGIN
2021-10-06 10:43:47.006612 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:43:47.016684 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:43:47.020219 (MainThread): On master: COMMIT
2021-10-06 10:43:47.024287 (MainThread): Using postgres connection "master".
2021-10-06 10:43:47.026575 (MainThread): On master: COMMIT
2021-10-06 10:43:47.030202 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:43:47.033572 (MainThread): On master: Close
2021-10-06 10:43:47.036208 (MainThread): 10:43:47 | 
2021-10-06 10:43:47.038568 (MainThread): 10:43:47 | Finished running 1 view model in 0.31s.
2021-10-06 10:43:47.042689 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:43:47.047980 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:43:47.100170 (MainThread): 
2021-10-06 10:43:47.103788 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:43:47.108980 (MainThread): 
2021-10-06 10:43:47.114063 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
2021-10-06 10:43:47.118690 (MainThread):   'Luhns' is undefined
2021-10-06 10:43:47.122771 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 10:43:47.128009 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7055935b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7055945c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7055945cd0>]}
2021-10-06 10:43:47.132238 (MainThread): Flushing usage events
2021-10-06 10:45:10.973257 (MainThread): Running with dbt=0.19.0
2021-10-06 10:45:11.179451 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:45:11.192054 (MainThread): Tracking: tracking
2021-10-06 10:45:11.195679 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5ace2ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5923cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5923cfd0>]}
2021-10-06 10:45:11.249322 (MainThread): Partial parsing not enabled
2021-10-06 10:45:11.256608 (MainThread): Parsing macros/relations.sql
2021-10-06 10:45:11.264009 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:45:11.307866 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:45:11.313860 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:45:11.318855 (MainThread): Parsing macros/core.sql
2021-10-06 10:45:11.325511 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:45:11.372771 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:45:11.391916 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:45:11.408738 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:45:11.417529 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:45:11.444655 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:45:11.451732 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:45:11.490768 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:45:11.513412 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:45:11.544476 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:45:11.552982 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:45:11.563217 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:45:11.573267 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:45:11.576640 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:45:11.580579 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:45:11.602608 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:45:11.607774 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:45:11.612010 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:45:11.615347 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:45:11.619268 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:45:11.624646 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:45:11.629022 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:45:11.654264 (MainThread): Partial parsing not enabled
2021-10-06 10:45:11.707952 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:45:11.743036 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:45:11.779132 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:45:12.033911 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:45:12.045069 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e59a45e2-8f29-4abc-9798-69e178faaf4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5908d040>]}
2021-10-06 10:45:12.115784 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:45:12.119294 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:45:12.123351 (MainThread): 
2021-10-06 10:45:12.126607 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:45:12.136453 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:45:12.164909 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:45:12.167290 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:45:12.170240 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:45:12.181607 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 10:45:12.197319 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:45:12.208374 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:45:12.219135 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:45:12.221347 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:45:12.223365 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:45:12.231051 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:45:12.235097 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:45:12.240433 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:45:12.251746 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 10:45:12.267422 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:45:12.270316 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:45:12.282170 (MainThread): Using postgres connection "master".
2021-10-06 10:45:12.284944 (MainThread): On master: BEGIN
2021-10-06 10:45:12.287506 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:45:12.299667 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:45:12.303584 (MainThread): Using postgres connection "master".
2021-10-06 10:45:12.307607 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:45:12.316643 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 10:45:12.325979 (MainThread): On master: ROLLBACK
2021-10-06 10:45:12.329260 (MainThread): Using postgres connection "master".
2021-10-06 10:45:12.331729 (MainThread): On master: BEGIN
2021-10-06 10:45:12.335281 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:45:12.340400 (MainThread): On master: COMMIT
2021-10-06 10:45:12.344307 (MainThread): Using postgres connection "master".
2021-10-06 10:45:12.347310 (MainThread): On master: COMMIT
2021-10-06 10:45:12.351272 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:45:12.354069 (MainThread): On master: Close
2021-10-06 10:45:12.358321 (MainThread): 10:45:12 | Concurrency: 2 threads (target='dev')
2021-10-06 10:45:12.364026 (MainThread): 10:45:12 | 
2021-10-06 10:45:12.379973 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:45:12.385156 (Thread-1): 10:45:12 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:45:12.388503 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:45:12.394017 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:45:12.425621 (Thread-1): finished collecting timing info
2021-10-06 10:45:12.431502 (Thread-1): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 9, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'Luhns' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
2021-10-06 10:45:12.438555 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e59a45e2-8f29-4abc-9798-69e178faaf4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a59108940>]}
2021-10-06 10:45:12.449938 (Thread-1): 10:45:12 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.05s]
2021-10-06 10:45:12.455307 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:45:12.464425 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:45:12.466855 (MainThread): Using postgres connection "master".
2021-10-06 10:45:12.469405 (MainThread): On master: BEGIN
2021-10-06 10:45:12.471550 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:45:12.488215 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-06 10:45:12.501414 (MainThread): On master: COMMIT
2021-10-06 10:45:12.504866 (MainThread): Using postgres connection "master".
2021-10-06 10:45:12.511673 (MainThread): On master: COMMIT
2021-10-06 10:45:12.517266 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:45:12.521669 (MainThread): On master: Close
2021-10-06 10:45:12.527752 (MainThread): 10:45:12 | 
2021-10-06 10:45:12.532408 (MainThread): 10:45:12 | Finished running 1 view model in 0.40s.
2021-10-06 10:45:12.538363 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:45:12.550621 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:45:12.652751 (MainThread): 
2021-10-06 10:45:12.655609 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:45:12.659462 (MainThread): 
2021-10-06 10:45:12.667026 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
2021-10-06 10:45:12.671606 (MainThread):   'Luhns' is undefined
2021-10-06 10:45:12.676882 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 10:45:12.683355 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a590b37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a590ef580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a590ef5e0>]}
2021-10-06 10:45:12.687079 (MainThread): Flushing usage events
2021-10-06 10:46:41.543736 (MainThread): Running with dbt=0.19.0
2021-10-06 10:46:41.750106 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:46:41.765353 (MainThread): Tracking: tracking
2021-10-06 10:46:41.770062 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98bbb9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a9a5e72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98bce190>]}
2021-10-06 10:46:41.819283 (MainThread): Partial parsing not enabled
2021-10-06 10:46:41.822606 (MainThread): Parsing macros/relations.sql
2021-10-06 10:46:41.828177 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:46:41.863140 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:46:41.869620 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:46:41.880168 (MainThread): Parsing macros/core.sql
2021-10-06 10:46:41.888528 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:46:41.932686 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:46:41.943487 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:46:41.958857 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:46:41.966143 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:46:41.985861 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:46:41.989927 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:46:42.021226 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:46:42.044454 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:46:42.067634 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:46:42.072054 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:46:42.082887 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:46:42.091568 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:46:42.095206 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:46:42.099461 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:46:42.111621 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:46:42.116203 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:46:42.120531 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:46:42.124000 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:46:42.128453 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:46:42.134135 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:46:42.139386 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:46:42.154092 (MainThread): Partial parsing not enabled
2021-10-06 10:46:42.200237 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:46:42.231930 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:46:42.254957 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:46:42.449945 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:46:42.458291 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '362e717a-362d-490a-9c6d-31fc0b5f98a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98a0a370>]}
2021-10-06 10:46:42.524748 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:46:42.531848 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:46:42.538130 (MainThread): 
2021-10-06 10:46:42.543681 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:46:42.552816 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:46:42.580253 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:46:42.583416 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:46:42.586423 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:46:42.602092 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 10:46:42.607172 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:46:42.615828 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:46:42.632890 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:46:42.634976 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:46:42.636651 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:46:42.648128 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:46:42.650694 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:46:42.653952 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:46:42.660122 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 10:46:42.672767 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:46:42.675458 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:46:42.686469 (MainThread): Using postgres connection "master".
2021-10-06 10:46:42.688719 (MainThread): On master: BEGIN
2021-10-06 10:46:42.690477 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:46:42.698567 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:46:42.700862 (MainThread): Using postgres connection "master".
2021-10-06 10:46:42.703611 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:46:42.712127 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 10:46:42.719039 (MainThread): On master: ROLLBACK
2021-10-06 10:46:42.721682 (MainThread): Using postgres connection "master".
2021-10-06 10:46:42.723756 (MainThread): On master: BEGIN
2021-10-06 10:46:42.727046 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:46:42.730021 (MainThread): On master: COMMIT
2021-10-06 10:46:42.733239 (MainThread): Using postgres connection "master".
2021-10-06 10:46:42.736045 (MainThread): On master: COMMIT
2021-10-06 10:46:42.738522 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:46:42.740951 (MainThread): On master: Close
2021-10-06 10:46:42.745050 (MainThread): 10:46:42 | Concurrency: 2 threads (target='dev')
2021-10-06 10:46:42.749843 (MainThread): 10:46:42 | 
2021-10-06 10:46:42.760272 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:46:42.763792 (Thread-1): 10:46:42 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:46:42.766754 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:46:42.770895 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:46:42.791752 (Thread-1): finished collecting timing info
2021-10-06 10:46:42.794840 (Thread-1): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 6, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'Luhns' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
2021-10-06 10:46:42.800699 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '362e717a-362d-490a-9c6d-31fc0b5f98a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a981051f0>]}
2021-10-06 10:46:42.805456 (Thread-1): 10:46:42 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.03s]
2021-10-06 10:46:42.807863 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:46:42.813696 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:46:42.816360 (MainThread): Using postgres connection "master".
2021-10-06 10:46:42.818899 (MainThread): On master: BEGIN
2021-10-06 10:46:42.821216 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:46:42.833054 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:46:42.836173 (MainThread): On master: COMMIT
2021-10-06 10:46:42.840273 (MainThread): Using postgres connection "master".
2021-10-06 10:46:42.842772 (MainThread): On master: COMMIT
2021-10-06 10:46:42.845653 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:46:42.848700 (MainThread): On master: Close
2021-10-06 10:46:42.853729 (MainThread): 10:46:42 | 
2021-10-06 10:46:42.857059 (MainThread): 10:46:42 | Finished running 1 view model in 0.31s.
2021-10-06 10:46:42.860074 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:46:42.863837 (MainThread): Connection 'list_dellstore' was properly closed.
2021-10-06 10:46:42.867478 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:46:42.920362 (MainThread): 
2021-10-06 10:46:42.923256 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:46:42.927021 (MainThread): 
2021-10-06 10:46:42.931978 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
2021-10-06 10:46:42.938220 (MainThread):   'Luhns' is undefined
2021-10-06 10:46:42.942347 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 10:46:42.952734 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a989e6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a9895aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98a6fdf0>]}
2021-10-06 10:46:42.958042 (MainThread): Flushing usage events
2021-10-06 10:47:18.088422 (MainThread): Running with dbt=0.19.0
2021-10-06 10:47:18.335769 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:47:18.345319 (MainThread): Tracking: tracking
2021-10-06 10:47:18.352156 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26b9cf970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26d3fb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26b9e0160>]}
2021-10-06 10:47:18.394468 (MainThread): Partial parsing not enabled
2021-10-06 10:47:18.398472 (MainThread): Parsing macros/relations.sql
2021-10-06 10:47:18.403635 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:47:18.427366 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:47:18.432888 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:47:18.438141 (MainThread): Parsing macros/core.sql
2021-10-06 10:47:18.444904 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:47:18.490977 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:47:18.502042 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:47:18.513959 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:47:18.521971 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:47:18.542209 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:47:18.552162 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:47:18.591627 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:47:18.608752 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:47:18.635402 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:47:18.641845 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:47:18.651427 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:47:18.660072 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:47:18.667007 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:47:18.677057 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:47:18.690135 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:47:18.695026 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:47:18.699080 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:47:18.702235 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:47:18.705750 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:47:18.711187 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:47:18.715751 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:47:18.730842 (MainThread): Partial parsing not enabled
2021-10-06 10:47:18.797387 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:47:18.828597 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:47:18.863651 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:47:19.096197 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:47:19.107436 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd75560c4-8e8c-4ea5-b071-dc8713047cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26b81e2e0>]}
2021-10-06 10:47:19.175640 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:47:19.179736 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:47:19.189332 (MainThread): 
2021-10-06 10:47:19.198618 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:47:19.205906 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:47:19.226407 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:47:19.229579 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:47:19.231887 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:47:19.245912 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 10:47:19.256596 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:47:19.266543 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:47:19.275001 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:47:19.277155 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:47:19.279453 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:47:19.291366 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:47:19.297681 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:47:19.301215 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:47:19.310272 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 10:47:19.323143 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:47:19.325922 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:47:19.340121 (MainThread): Using postgres connection "master".
2021-10-06 10:47:19.343732 (MainThread): On master: BEGIN
2021-10-06 10:47:19.347013 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:47:19.358633 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:47:19.362024 (MainThread): Using postgres connection "master".
2021-10-06 10:47:19.366288 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:47:19.374020 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 10:47:19.380965 (MainThread): On master: ROLLBACK
2021-10-06 10:47:19.383922 (MainThread): Using postgres connection "master".
2021-10-06 10:47:19.386661 (MainThread): On master: BEGIN
2021-10-06 10:47:19.389866 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:47:19.393646 (MainThread): On master: COMMIT
2021-10-06 10:47:19.396384 (MainThread): Using postgres connection "master".
2021-10-06 10:47:19.399130 (MainThread): On master: COMMIT
2021-10-06 10:47:19.402053 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:47:19.405759 (MainThread): On master: Close
2021-10-06 10:47:19.409577 (MainThread): 10:47:19 | Concurrency: 2 threads (target='dev')
2021-10-06 10:47:19.412938 (MainThread): 10:47:19 | 
2021-10-06 10:47:19.420992 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:47:19.427214 (Thread-1): 10:47:19 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:47:19.431478 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:47:19.434664 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:47:19.461914 (Thread-1): finished collecting timing info
2021-10-06 10:47:19.465816 (Thread-1): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 6, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'Luhns' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
2021-10-06 10:47:19.472827 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75560c4-8e8c-4ea5-b071-dc8713047cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26af1cdf0>]}
2021-10-06 10:47:19.477617 (Thread-1): 10:47:19 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.04s]
2021-10-06 10:47:19.481048 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:47:19.486189 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:47:19.489978 (MainThread): Using postgres connection "master".
2021-10-06 10:47:19.493965 (MainThread): On master: BEGIN
2021-10-06 10:47:19.497912 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:47:19.509517 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:47:19.513693 (MainThread): On master: COMMIT
2021-10-06 10:47:19.517628 (MainThread): Using postgres connection "master".
2021-10-06 10:47:19.519859 (MainThread): On master: COMMIT
2021-10-06 10:47:19.523103 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:47:19.528804 (MainThread): On master: Close
2021-10-06 10:47:19.532783 (MainThread): 10:47:19 | 
2021-10-06 10:47:19.535979 (MainThread): 10:47:19 | Finished running 1 view model in 0.34s.
2021-10-06 10:47:19.539408 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:47:19.546091 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:47:19.642756 (MainThread): 
2021-10-06 10:47:19.646238 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:47:19.653777 (MainThread): 
2021-10-06 10:47:19.662148 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
2021-10-06 10:47:19.665390 (MainThread):   'Luhns' is undefined
2021-10-06 10:47:19.670003 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 10:47:19.679225 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26b8f7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26b929fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26b7a0d90>]}
2021-10-06 10:47:19.683591 (MainThread): Flushing usage events
2021-10-06 10:48:54.168110 (MainThread): Running with dbt=0.19.0
2021-10-06 10:48:54.386332 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:48:54.398002 (MainThread): Tracking: tracking
2021-10-06 10:48:54.404033 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aaf378970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ab0da4280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aaf38a160>]}
2021-10-06 10:48:54.461015 (MainThread): Partial parsing not enabled
2021-10-06 10:48:54.468492 (MainThread): Parsing macros/relations.sql
2021-10-06 10:48:54.475001 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:48:54.506218 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:48:54.513176 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:48:54.523681 (MainThread): Parsing macros/core.sql
2021-10-06 10:48:54.537258 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:48:54.582337 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:48:54.593819 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:48:54.603961 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:48:54.611329 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:48:54.630923 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:48:54.635358 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:48:54.670120 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:48:54.687927 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:48:54.712825 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:48:54.720176 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:48:54.742192 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:48:54.756890 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:48:54.761474 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:48:54.767927 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:48:54.781590 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:48:54.791791 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:48:54.800483 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:48:54.805219 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:48:54.808894 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:48:54.813580 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:48:54.817662 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:48:54.833669 (MainThread): Partial parsing not enabled
2021-10-06 10:48:54.876404 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:48:54.905610 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:48:54.930961 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:48:55.102986 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:48:55.110866 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '148883a4-1ca4-484a-b439-51abba1ff03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aaf1c9160>]}
2021-10-06 10:48:55.160044 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:48:55.163468 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:48:55.167938 (MainThread): 
2021-10-06 10:48:55.172200 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:48:55.179435 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:48:55.200611 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:48:55.203700 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:48:55.206252 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:48:55.218251 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 10:48:55.226372 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:48:55.242754 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:48:55.256390 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:48:55.259091 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:48:55.262013 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:48:55.272771 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:48:55.275752 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:48:55.279559 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:48:55.285088 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 10:48:55.305709 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:48:55.309422 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:48:55.330438 (MainThread): Using postgres connection "master".
2021-10-06 10:48:55.333534 (MainThread): On master: BEGIN
2021-10-06 10:48:55.336750 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:48:55.346918 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:48:55.353920 (MainThread): Using postgres connection "master".
2021-10-06 10:48:55.360493 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:48:55.373815 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 10:48:55.379727 (MainThread): On master: ROLLBACK
2021-10-06 10:48:55.383554 (MainThread): Using postgres connection "master".
2021-10-06 10:48:55.386039 (MainThread): On master: BEGIN
2021-10-06 10:48:55.391346 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:48:55.394822 (MainThread): On master: COMMIT
2021-10-06 10:48:55.398359 (MainThread): Using postgres connection "master".
2021-10-06 10:48:55.401219 (MainThread): On master: COMMIT
2021-10-06 10:48:55.405180 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:48:55.409130 (MainThread): On master: Close
2021-10-06 10:48:55.413695 (MainThread): 10:48:55 | Concurrency: 2 threads (target='dev')
2021-10-06 10:48:55.420133 (MainThread): 10:48:55 | 
2021-10-06 10:48:55.434528 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:48:55.445476 (Thread-1): 10:48:55 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:48:55.454279 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:48:55.458999 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:48:55.487499 (Thread-1): finished collecting timing info
2021-10-06 10:48:55.491355 (Thread-1): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 6, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'Luhns' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Luhns' is undefined
2021-10-06 10:48:55.503526 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '148883a4-1ca4-484a-b439-51abba1ff03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aae8c4df0>]}
2021-10-06 10:48:55.510177 (Thread-1): 10:48:55 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.05s]
2021-10-06 10:48:55.513656 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:48:55.520447 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:48:55.523202 (MainThread): Using postgres connection "master".
2021-10-06 10:48:55.525796 (MainThread): On master: BEGIN
2021-10-06 10:48:55.528366 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:48:55.540580 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:48:55.544121 (MainThread): On master: COMMIT
2021-10-06 10:48:55.547564 (MainThread): Using postgres connection "master".
2021-10-06 10:48:55.551716 (MainThread): On master: COMMIT
2021-10-06 10:48:55.555452 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:48:55.557709 (MainThread): On master: Close
2021-10-06 10:48:55.560657 (MainThread): 10:48:55 | 
2021-10-06 10:48:55.563660 (MainThread): 10:48:55 | Finished running 1 view model in 0.39s.
2021-10-06 10:48:55.569332 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:48:55.572548 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:48:55.624448 (MainThread): 
2021-10-06 10:48:55.628408 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:48:55.633299 (MainThread): 
2021-10-06 10:48:55.639256 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
2021-10-06 10:48:55.643588 (MainThread):   'Luhns' is undefined
2021-10-06 10:48:55.646580 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 10:48:55.650960 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aaf29ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aaf2b12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aaf149c10>]}
2021-10-06 10:48:55.658302 (MainThread): Flushing usage events
2021-10-06 10:50:27.128587 (MainThread): Running with dbt=0.19.0
2021-10-06 10:50:27.345375 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:50:27.360316 (MainThread): Tracking: tracking
2021-10-06 10:50:27.364484 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aa31a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ad921460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aa32c130>]}
2021-10-06 10:50:27.418904 (MainThread): Partial parsing not enabled
2021-10-06 10:50:27.433834 (MainThread): Parsing macros/Luhns.sql
2021-10-06 10:50:27.439298 (MainThread): Parsing macros/relations.sql
2021-10-06 10:50:27.445300 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:50:27.482341 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:50:27.491053 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:50:27.498391 (MainThread): Parsing macros/core.sql
2021-10-06 10:50:27.508529 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:50:27.558569 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:50:27.571463 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:50:27.581378 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:50:27.588762 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:50:27.608166 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:50:27.612982 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:50:27.644135 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:50:27.667402 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:50:27.691188 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:50:27.696126 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:50:27.705922 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:50:27.715955 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:50:27.720601 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:50:27.724646 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:50:27.736030 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:50:27.741021 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:50:27.746015 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:50:27.750072 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:50:27.753868 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:50:27.759289 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:50:27.764847 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:50:27.779166 (MainThread): Partial parsing not enabled
2021-10-06 10:50:27.824671 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:50:27.854262 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:50:27.877387 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:50:28.070961 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:50:28.082442 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97b12d78-af40-4eec-900a-ccde7c13ea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aa1df8b0>]}
2021-10-06 10:50:28.146247 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:50:28.151348 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:50:28.158319 (MainThread): 
2021-10-06 10:50:28.162673 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:50:28.167392 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:50:28.192360 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:50:28.196809 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:50:28.201713 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:50:28.214414 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 10:50:28.224886 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:50:28.233830 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:50:28.249306 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:50:28.251529 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:50:28.253853 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:50:28.261916 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:50:28.264689 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:50:28.269941 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:50:28.276395 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 10:50:28.289639 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:50:28.293453 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:50:28.311232 (MainThread): Using postgres connection "master".
2021-10-06 10:50:28.313736 (MainThread): On master: BEGIN
2021-10-06 10:50:28.315936 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:50:28.322362 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:50:28.324906 (MainThread): Using postgres connection "master".
2021-10-06 10:50:28.327268 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:50:28.337478 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 10:50:28.343417 (MainThread): On master: ROLLBACK
2021-10-06 10:50:28.346834 (MainThread): Using postgres connection "master".
2021-10-06 10:50:28.348891 (MainThread): On master: BEGIN
2021-10-06 10:50:28.352723 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:50:28.355150 (MainThread): On master: COMMIT
2021-10-06 10:50:28.357198 (MainThread): Using postgres connection "master".
2021-10-06 10:50:28.359186 (MainThread): On master: COMMIT
2021-10-06 10:50:28.361302 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:50:28.363309 (MainThread): On master: Close
2021-10-06 10:50:28.368387 (MainThread): 10:50:28 | Concurrency: 2 threads (target='dev')
2021-10-06 10:50:28.371368 (MainThread): 10:50:28 | 
2021-10-06 10:50:28.381112 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:50:28.384605 (Thread-1): 10:50:28 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:50:28.388416 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:50:28.391814 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:50:28.414776 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:50:28.426405 (Thread-1): finished collecting timing info
2021-10-06 10:50:28.460272 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:50:28.462827 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 10:50:28.464943 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:50:28.472940 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 10:50:28.477314 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:50:28.479855 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 10:50:28.482590 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 10:50:28.490778 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:50:28.498970 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:50:28.501414 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 10:50:28.504886 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:50:28.507622 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:50:28.510427 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    (creditcard / 100)::numeric(16, 2)
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
--where 
    (creditcard / 100)::numeric(16, 2)
 = 'Invalid'
group by 1,2
  );

2021-10-06 10:50:28.514843 (Thread-1): Postgres error: syntax error at or near "="
LINE 11:  = 'Invalid'
          ^

2021-10-06 10:50:28.519811 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 10:50:28.524452 (Thread-1): finished collecting timing info
2021-10-06 10:50:28.527761 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 10:50:28.530973 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "="
  LINE 11:  = 'Invalid'
            ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "="
LINE 11:  = 'Invalid'
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "="
  LINE 11:  = 'Invalid'
            ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 10:50:28.543827 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b12d78-af40-4eec-900a-ccde7c13ea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aa1780a0>]}
2021-10-06 10:50:28.549253 (Thread-1): 10:50:28 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.16s]
2021-10-06 10:50:28.554664 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:50:28.563495 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:50:28.567687 (MainThread): Using postgres connection "master".
2021-10-06 10:50:28.571537 (MainThread): On master: BEGIN
2021-10-06 10:50:28.577759 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:50:28.587795 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:50:28.592676 (MainThread): On master: COMMIT
2021-10-06 10:50:28.596559 (MainThread): Using postgres connection "master".
2021-10-06 10:50:28.601345 (MainThread): On master: COMMIT
2021-10-06 10:50:28.606967 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:50:28.610347 (MainThread): On master: Close
2021-10-06 10:50:28.616201 (MainThread): 10:50:28 | 
2021-10-06 10:50:28.619936 (MainThread): 10:50:28 | Finished running 1 view model in 0.45s.
2021-10-06 10:50:28.622373 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:50:28.625675 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:50:28.689426 (MainThread): 
2021-10-06 10:50:28.692756 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:50:28.696091 (MainThread): 
2021-10-06 10:50:28.699750 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 10:50:28.704209 (MainThread):   syntax error at or near "="
2021-10-06 10:50:28.709817 (MainThread):   LINE 11:  = 'Invalid'
2021-10-06 10:50:28.713388 (MainThread):             ^
2021-10-06 10:50:28.717342 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 10:50:28.720341 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 10:50:28.723940 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aa0c1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aa14cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06a9840940>]}
2021-10-06 10:50:28.730505 (MainThread): Flushing usage events
2021-10-06 10:51:45.821894 (MainThread): Running with dbt=0.19.0
2021-10-06 10:51:46.040590 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:51:46.052909 (MainThread): Tracking: tracking
2021-10-06 10:51:46.056145 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dbb1a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dd5c62b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dbb2b190>]}
2021-10-06 10:51:46.108492 (MainThread): Partial parsing not enabled
2021-10-06 10:51:46.118183 (MainThread): Parsing macros/Luhns.sql
2021-10-06 10:51:46.124262 (MainThread): Parsing macros/relations.sql
2021-10-06 10:51:46.130731 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:51:46.161258 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:51:46.169619 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:51:46.178914 (MainThread): Parsing macros/core.sql
2021-10-06 10:51:46.193248 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:51:46.245100 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:51:46.258837 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:51:46.269691 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:51:46.277349 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:51:46.297374 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:51:46.301518 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:51:46.334802 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:51:46.350515 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:51:46.377261 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:51:46.381839 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:51:46.390236 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:51:46.400861 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:51:46.404321 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:51:46.412648 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:51:46.427051 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:51:46.432113 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:51:46.436763 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:51:46.440194 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:51:46.444264 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:51:46.449818 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:51:46.454414 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:51:46.469753 (MainThread): Partial parsing not enabled
2021-10-06 10:51:46.513792 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:51:46.545938 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:51:46.568801 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:51:46.746676 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:51:46.754045 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69594902-a08e-472d-ac0c-da3519fdaf39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34db9d9d60>]}
2021-10-06 10:51:46.807123 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:51:46.812664 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:51:46.820094 (MainThread): 
2021-10-06 10:51:46.826427 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:51:46.834176 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:51:46.854189 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:51:46.856641 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:51:46.859734 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:51:46.882035 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 10:51:46.898112 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:51:46.914884 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:51:46.934906 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:51:46.938082 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:51:46.940966 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:51:46.955633 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:51:46.959284 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:51:46.964650 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:51:46.972814 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 10:51:46.995406 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:51:46.999234 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:51:47.018431 (MainThread): Using postgres connection "master".
2021-10-06 10:51:47.022050 (MainThread): On master: BEGIN
2021-10-06 10:51:47.024611 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:51:47.033083 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:51:47.035986 (MainThread): Using postgres connection "master".
2021-10-06 10:51:47.039198 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:51:47.052464 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 10:51:47.059705 (MainThread): On master: ROLLBACK
2021-10-06 10:51:47.063099 (MainThread): Using postgres connection "master".
2021-10-06 10:51:47.066037 (MainThread): On master: BEGIN
2021-10-06 10:51:47.068931 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:51:47.073078 (MainThread): On master: COMMIT
2021-10-06 10:51:47.077930 (MainThread): Using postgres connection "master".
2021-10-06 10:51:47.080148 (MainThread): On master: COMMIT
2021-10-06 10:51:47.084785 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:51:47.087887 (MainThread): On master: Close
2021-10-06 10:51:47.091222 (MainThread): 10:51:47 | Concurrency: 2 threads (target='dev')
2021-10-06 10:51:47.095543 (MainThread): 10:51:47 | 
2021-10-06 10:51:47.104139 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:51:47.108076 (Thread-1): 10:51:47 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:51:47.110636 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:51:47.114690 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:51:47.141286 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:51:47.152987 (Thread-1): finished collecting timing info
2021-10-06 10:51:47.192433 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:51:47.194902 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 10:51:47.197047 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:51:47.204799 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 10:51:47.209751 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:51:47.212171 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 10:51:47.215760 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 10:51:47.233575 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:51:47.246372 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:51:47.249270 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 10:51:47.252937 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:51:47.256531 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:51:47.259946 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    (creditcard / 100)::numeric(16, 2)
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 10:51:47.266520 (Thread-1): Postgres error: operator does not exist: character varying / integer
LINE 5:     (creditcard / 100)::numeric(16, 2)
                        ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2021-10-06 10:51:47.270230 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 10:51:47.275781 (Thread-1): finished collecting timing info
2021-10-06 10:51:47.281568 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 10:51:47.284830 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: character varying / integer
  LINE 5:     (creditcard / 100)::numeric(16, 2)
                          ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: operator does not exist: character varying / integer
LINE 5:     (creditcard / 100)::numeric(16, 2)
                        ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: character varying / integer
  LINE 5:     (creditcard / 100)::numeric(16, 2)
                          ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 10:51:47.289973 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69594902-a08e-472d-ac0c-da3519fdaf39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dba1ae20>]}
2021-10-06 10:51:47.293508 (Thread-1): 10:51:47 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.18s]
2021-10-06 10:51:47.297634 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:51:47.305125 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:51:47.307179 (MainThread): Using postgres connection "master".
2021-10-06 10:51:47.309182 (MainThread): On master: BEGIN
2021-10-06 10:51:47.311183 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:51:47.321777 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:51:47.325044 (MainThread): On master: COMMIT
2021-10-06 10:51:47.328041 (MainThread): Using postgres connection "master".
2021-10-06 10:51:47.331406 (MainThread): On master: COMMIT
2021-10-06 10:51:47.336176 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:51:47.338200 (MainThread): On master: Close
2021-10-06 10:51:47.340935 (MainThread): 10:51:47 | 
2021-10-06 10:51:47.343646 (MainThread): 10:51:47 | Finished running 1 view model in 0.52s.
2021-10-06 10:51:47.349716 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:51:47.354321 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:51:47.429271 (MainThread): 
2021-10-06 10:51:47.432885 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:51:47.437093 (MainThread): 
2021-10-06 10:51:47.440833 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 10:51:47.444745 (MainThread):   operator does not exist: character varying / integer
2021-10-06 10:51:47.450276 (MainThread):   LINE 5:     (creditcard / 100)::numeric(16, 2)
2021-10-06 10:51:47.456018 (MainThread):                           ^
2021-10-06 10:51:47.460891 (MainThread):   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2021-10-06 10:51:47.466246 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 10:51:47.473024 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 10:51:47.482997 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34db9c5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34db9ff2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dba25a90>]}
2021-10-06 10:51:47.489633 (MainThread): Flushing usage events
2021-10-06 10:52:18.185453 (MainThread): Running with dbt=0.19.0
2021-10-06 10:52:18.404834 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:52:18.414307 (MainThread): Tracking: tracking
2021-10-06 10:52:18.417771 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97011bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa973721400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97012d0d0>]}
2021-10-06 10:52:18.459113 (MainThread): Partial parsing not enabled
2021-10-06 10:52:18.468705 (MainThread): Parsing macros/Luhns.sql
2021-10-06 10:52:18.474327 (MainThread): Parsing macros/relations.sql
2021-10-06 10:52:18.481810 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:52:18.546420 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:52:18.558132 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:52:18.578165 (MainThread): Parsing macros/core.sql
2021-10-06 10:52:18.594943 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:52:18.668807 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:52:18.694123 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:52:18.714138 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:52:18.733387 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:52:18.769454 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:52:18.774813 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:52:18.823528 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:52:18.850528 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:52:18.887986 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:52:18.893389 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:52:18.906332 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:52:18.918028 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:52:18.924049 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:52:18.928429 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:52:18.943854 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:52:18.949623 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:52:18.957266 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:52:18.962780 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:52:18.969664 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:52:18.977303 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:52:18.982240 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:52:19.000853 (MainThread): Partial parsing not enabled
2021-10-06 10:52:19.065139 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:52:19.102619 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:52:19.131333 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:52:19.352943 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:52:19.367592 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d1fd8b3-29ca-41b9-b12d-01a2b06fe413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96ffe0df0>]}
2021-10-06 10:52:19.417630 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:52:19.421028 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:52:19.424351 (MainThread): 
2021-10-06 10:52:19.427465 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:52:19.435290 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:52:19.456788 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:52:19.460517 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:52:19.462949 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:52:19.477351 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 10:52:19.490263 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:52:19.500169 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:52:19.508794 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:52:19.511155 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:52:19.513294 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:52:19.521463 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:52:19.523910 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:52:19.526605 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:52:19.533057 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 10:52:19.548048 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:52:19.551170 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:52:19.566525 (MainThread): Using postgres connection "master".
2021-10-06 10:52:19.569341 (MainThread): On master: BEGIN
2021-10-06 10:52:19.572739 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:52:19.584281 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:52:19.588909 (MainThread): Using postgres connection "master".
2021-10-06 10:52:19.595224 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:52:19.612145 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 10:52:19.622576 (MainThread): On master: ROLLBACK
2021-10-06 10:52:19.626058 (MainThread): Using postgres connection "master".
2021-10-06 10:52:19.628474 (MainThread): On master: BEGIN
2021-10-06 10:52:19.631702 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:52:19.635375 (MainThread): On master: COMMIT
2021-10-06 10:52:19.639703 (MainThread): Using postgres connection "master".
2021-10-06 10:52:19.642605 (MainThread): On master: COMMIT
2021-10-06 10:52:19.645656 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:52:19.648510 (MainThread): On master: Close
2021-10-06 10:52:19.651701 (MainThread): 10:52:19 | Concurrency: 2 threads (target='dev')
2021-10-06 10:52:19.655877 (MainThread): 10:52:19 | 
2021-10-06 10:52:19.668707 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:52:19.675801 (Thread-1): 10:52:19 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:52:19.680166 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:52:19.683817 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:52:19.722333 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:52:19.733635 (Thread-1): finished collecting timing info
2021-10-06 10:52:19.775750 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:52:19.778879 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 10:52:19.782144 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:52:19.791736 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 10:52:19.797364 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:52:19.800648 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 10:52:19.803586 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 10:52:19.811589 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:52:19.819791 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:52:19.822099 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 10:52:19.825341 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:52:19.828316 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:52:19.831625 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    (creditcard::numeric / 100)::numeric(16, 2)
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 10:52:19.847533 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 10:52:19.859774 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:52:19.861891 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 10:52:19.865542 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 10:52:19.870786 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:52:19.873036 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 10:52:19.876169 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 10:52:19.885564 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 10:52:19.887946 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:52:19.890147 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 10:52:19.894203 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:52:19.902882 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:52:19.905882 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 10:52:19.912823 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 10:52:19.921327 (Thread-1): finished collecting timing info
2021-10-06 10:52:19.924267 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 10:52:19.929509 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d1fd8b3-29ca-41b9-b12d-01a2b06fe413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9700227c0>]}
2021-10-06 10:52:19.934286 (Thread-1): 10:52:19 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.25s]
2021-10-06 10:52:19.937828 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:52:19.943695 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:52:19.947714 (MainThread): Using postgres connection "master".
2021-10-06 10:52:19.950852 (MainThread): On master: BEGIN
2021-10-06 10:52:19.954209 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:52:19.967419 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:52:19.973380 (MainThread): On master: COMMIT
2021-10-06 10:52:19.977589 (MainThread): Using postgres connection "master".
2021-10-06 10:52:19.979859 (MainThread): On master: COMMIT
2021-10-06 10:52:19.983118 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:52:19.986441 (MainThread): On master: Close
2021-10-06 10:52:19.991180 (MainThread): 10:52:19 | 
2021-10-06 10:52:19.993547 (MainThread): 10:52:19 | Finished running 1 view model in 0.56s.
2021-10-06 10:52:19.996657 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:52:20.000366 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:52:20.049429 (MainThread): 
2021-10-06 10:52:20.054047 (MainThread): Completed successfully
2021-10-06 10:52:20.057535 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 10:52:20.061671 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96ffc2520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa970040040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96feea370>]}
2021-10-06 10:52:20.067145 (MainThread): Flushing usage events
2021-10-06 10:53:17.756950 (MainThread): Running with dbt=0.19.0
2021-10-06 10:53:18.029190 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:53:18.037419 (MainThread): Tracking: tracking
2021-10-06 10:53:18.040954 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ebe39910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ef440430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ebe4b100>]}
2021-10-06 10:53:18.076189 (MainThread): Partial parsing not enabled
2021-10-06 10:53:18.091193 (MainThread): Parsing macros/Luhns.sql
2021-10-06 10:53:18.095592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ebdd87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ebe5ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ebe5ebb0>]}
2021-10-06 10:53:18.097820 (MainThread): Flushing usage events
2021-10-06 10:53:18.638888 (MainThread): Encountered an error:
2021-10-06 10:53:18.651904 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set n = length({{column_name}}), s = int({{column_name}}[n-1]), par = (n-1)%%2 %}
2021-10-06 10:53:18.670656 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set n = length({{column_name}}), s = int({{column_name}}[n-1]), par = (n-1)%%2 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set n = length({{column_name}}), s = int({{column_name}}[n-1]), par = (n-1)%%2 %}

2021-10-06 10:54:22.556494 (MainThread): Running with dbt=0.19.0
2021-10-06 10:54:22.860767 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:54:22.876997 (MainThread): Tracking: tracking
2021-10-06 10:54:22.892666 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9b3de0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9b580c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9b3df1160>]}
2021-10-06 10:54:22.955172 (MainThread): Partial parsing not enabled
2021-10-06 10:54:22.968915 (MainThread): Parsing macros/Luhns.sql
2021-10-06 10:54:22.974625 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9b3d7e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9b3e04b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9b3e04c70>]}
2021-10-06 10:54:22.977838 (MainThread): Flushing usage events
2021-10-06 10:54:23.476784 (MainThread): Encountered an error:
2021-10-06 10:54:23.493848 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set n = length({{column_name}}) %} --, s = int({{column_name}}[n-1]), par = (n-1)%%2 %}
2021-10-06 10:54:23.517986 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set n = length({{column_name}}) %} --, s = int({{column_name}}[n-1]), par = (n-1)%%2 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set n = length({{column_name}}) %} --, s = int({{column_name}}[n-1]), par = (n-1)%%2 %}

2021-10-06 10:54:45.109489 (MainThread): Running with dbt=0.19.0
2021-10-06 10:54:45.359205 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:54:45.370046 (MainThread): Tracking: tracking
2021-10-06 10:54:45.374962 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5406fb0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5408a5b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5406fc2160>]}
2021-10-06 10:54:45.420954 (MainThread): Partial parsing not enabled
2021-10-06 10:54:45.440625 (MainThread): Parsing macros/Luhns.sql
2021-10-06 10:54:45.444988 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5406f4e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5406fd4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5406fd4c10>]}
2021-10-06 10:54:45.448028 (MainThread): Flushing usage events
2021-10-06 10:54:45.990023 (MainThread): Encountered an error:
2021-10-06 10:54:45.997587 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set n = length({{column_name}}) %}
2021-10-06 10:54:46.007091 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set n = length({{column_name}}) %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set n = length({{column_name}}) %}

2021-10-06 10:55:15.914316 (MainThread): Running with dbt=0.19.0
2021-10-06 10:55:16.163706 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:55:16.178776 (MainThread): Tracking: tracking
2021-10-06 10:55:16.185870 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79538a8a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7955353370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79538b91f0>]}
2021-10-06 10:55:16.241176 (MainThread): Partial parsing not enabled
2021-10-06 10:55:16.252297 (MainThread): Parsing macros/Luhns.sql
2021-10-06 10:55:16.257523 (MainThread): Parsing macros/relations.sql
2021-10-06 10:55:16.262440 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:55:16.288016 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:55:16.298561 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:55:16.305862 (MainThread): Parsing macros/core.sql
2021-10-06 10:55:16.315924 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:55:16.362054 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:55:16.375316 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:55:16.385621 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:55:16.393193 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:55:16.413189 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:55:16.418948 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:55:16.452877 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:55:16.468984 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:55:16.493176 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:55:16.503489 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:55:16.511779 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:55:16.521700 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:55:16.525477 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:55:16.530039 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:55:16.542174 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:55:16.551790 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:55:16.560484 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:55:16.564181 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:55:16.568050 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:55:16.573280 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:55:16.577557 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:55:16.594528 (MainThread): Partial parsing not enabled
2021-10-06 10:55:16.649202 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:55:16.682022 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:16.707614 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:55:16.934282 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:55:16.949663 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '696fdc0e-08e1-4e8e-bbe1-4f78d25fcda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7953763fa0>]}
2021-10-06 10:55:17.070590 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:55:17.075275 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:55:17.079924 (MainThread): 
2021-10-06 10:55:17.088018 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:55:17.102758 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:55:17.126770 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:55:17.132082 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:55:17.135866 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:55:17.145042 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 10:55:17.154676 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:55:17.162540 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:55:17.176710 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:55:17.179802 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:55:17.182201 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:55:17.192854 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:55:17.196893 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:55:17.201490 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:55:17.207473 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 10:55:17.223402 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:55:17.226840 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:55:17.241914 (MainThread): Using postgres connection "master".
2021-10-06 10:55:17.244502 (MainThread): On master: BEGIN
2021-10-06 10:55:17.246941 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:55:17.255530 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:55:17.258134 (MainThread): Using postgres connection "master".
2021-10-06 10:55:17.261234 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:55:17.271886 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 10:55:17.279749 (MainThread): On master: ROLLBACK
2021-10-06 10:55:17.283963 (MainThread): Using postgres connection "master".
2021-10-06 10:55:17.287493 (MainThread): On master: BEGIN
2021-10-06 10:55:17.290604 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:55:17.293579 (MainThread): On master: COMMIT
2021-10-06 10:55:17.296326 (MainThread): Using postgres connection "master".
2021-10-06 10:55:17.299670 (MainThread): On master: COMMIT
2021-10-06 10:55:17.304621 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:55:17.306783 (MainThread): On master: Close
2021-10-06 10:55:17.309536 (MainThread): 10:55:17 | Concurrency: 2 threads (target='dev')
2021-10-06 10:55:17.315732 (MainThread): 10:55:17 | 
2021-10-06 10:55:17.327606 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:55:17.335082 (Thread-1): 10:55:17 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:55:17.339209 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:17.342806 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:55:17.371018 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:55:17.386316 (Thread-1): finished collecting timing info
2021-10-06 10:55:17.450126 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:17.454756 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 10:55:17.459103 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:55:17.473284 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 10:55:17.484683 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:17.487758 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 10:55:17.490791 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 10:55:17.501689 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:55:17.511018 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:17.513767 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 10:55:17.516951 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:55:17.521042 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:17.526145 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    
    (creditcard::numeric / 100)::numeric(16, 2)
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 10:55:17.537551 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 10:55:17.552461 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:17.555001 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 10:55:17.558285 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 10:55:17.565629 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:17.569592 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 10:55:17.576851 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 10:55:17.594732 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 10:55:17.597945 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:17.600639 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 10:55:17.605532 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:55:17.614520 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:17.617478 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 10:55:17.623120 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 10:55:17.630659 (Thread-1): finished collecting timing info
2021-10-06 10:55:17.633140 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 10:55:17.639329 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '696fdc0e-08e1-4e8e-bbe1-4f78d25fcda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79537afbe0>]}
2021-10-06 10:55:17.647733 (Thread-1): 10:55:17 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.30s]
2021-10-06 10:55:17.653506 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:55:17.660135 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:55:17.663602 (MainThread): Using postgres connection "master".
2021-10-06 10:55:17.667026 (MainThread): On master: BEGIN
2021-10-06 10:55:17.669496 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:55:17.680267 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:55:17.686223 (MainThread): On master: COMMIT
2021-10-06 10:55:17.689700 (MainThread): Using postgres connection "master".
2021-10-06 10:55:17.695052 (MainThread): On master: COMMIT
2021-10-06 10:55:17.701722 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:55:17.706360 (MainThread): On master: Close
2021-10-06 10:55:17.709652 (MainThread): 10:55:17 | 
2021-10-06 10:55:17.712883 (MainThread): 10:55:17 | Finished running 1 view model in 0.62s.
2021-10-06 10:55:17.717017 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:55:17.721019 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:55:17.801852 (MainThread): 
2021-10-06 10:55:17.805706 (MainThread): Completed successfully
2021-10-06 10:55:17.813244 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 10:55:17.820831 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7953874400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79536d3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7953676610>]}
2021-10-06 10:55:17.825903 (MainThread): Flushing usage events
2021-10-06 10:55:42.081200 (MainThread): Running with dbt=0.19.0
2021-10-06 10:55:42.320382 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:55:42.332835 (MainThread): Tracking: tracking
2021-10-06 10:55:42.338670 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3c2c38fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3c623e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3c2c480a0>]}
2021-10-06 10:55:42.390946 (MainThread): Partial parsing not enabled
2021-10-06 10:55:42.403508 (MainThread): Parsing macros/Luhns.sql
2021-10-06 10:55:42.408773 (MainThread): Parsing macros/relations.sql
2021-10-06 10:55:42.412706 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:55:42.435918 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:55:42.440562 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:55:42.445876 (MainThread): Parsing macros/core.sql
2021-10-06 10:55:42.453167 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:55:42.503058 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:55:42.521958 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:55:42.530723 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:55:42.544386 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:55:42.573403 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:55:42.580626 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:55:42.614508 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:55:42.630283 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:55:42.654486 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:55:42.658862 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:55:42.675411 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:55:42.687472 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:55:42.690817 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:55:42.695153 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:55:42.709463 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:55:42.717805 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:55:42.724642 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:55:42.729202 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:55:42.735628 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:55:42.741448 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:55:42.745784 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:55:42.765864 (MainThread): Partial parsing not enabled
2021-10-06 10:55:42.811349 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:55:42.845206 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:55:42.853769 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3c2c09ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3c2a5bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3c2a57880>]}
2021-10-06 10:55:42.856309 (MainThread): Flushing usage events
2021-10-06 10:55:43.376591 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:55:43.385829 (MainThread): Encountered an error:
2021-10-06 10:55:43.392402 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'length' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-06 10:55:43.413325 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'length' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'length' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-06 10:59:22.261434 (MainThread): Running with dbt=0.19.0
2021-10-06 10:59:22.600848 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:59:22.611058 (MainThread): Tracking: tracking
2021-10-06 10:59:22.615336 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc982da79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9848522b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc982db8190>]}
2021-10-06 10:59:22.660158 (MainThread): Partial parsing not enabled
2021-10-06 10:59:22.674889 (MainThread): Parsing macros/Luhns.sql
2021-10-06 10:59:22.681260 (MainThread): Parsing macros/relations.sql
2021-10-06 10:59:22.687823 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:59:22.721640 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:59:22.726873 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:59:22.731789 (MainThread): Parsing macros/core.sql
2021-10-06 10:59:22.739336 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:59:22.784743 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:59:22.797358 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:59:22.807560 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:59:22.814690 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:59:22.835516 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:59:22.844510 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:59:22.883187 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:59:22.873106 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:59:22.900973 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:59:22.905807 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:59:22.915930 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:59:22.928900 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:59:22.932680 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:59:22.937395 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:59:22.950599 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:59:22.955122 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:59:22.959251 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:59:22.962838 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:59:22.966813 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:59:22.972412 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:59:22.977760 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:59:22.996217 (MainThread): Partial parsing not enabled
2021-10-06 10:59:23.038959 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:59:23.067386 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:59:23.075252 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc982d7b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc982bcce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc982bc7970>]}
2021-10-06 10:59:23.078803 (MainThread): Flushing usage events
2021-10-06 10:59:23.618783 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:59:23.626812 (MainThread): Encountered an error:
2021-10-06 10:59:23.632038 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'length' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-06 10:59:23.641899 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'length' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'length' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-06 10:59:38.436075 (MainThread): Running with dbt=0.19.0
2021-10-06 10:59:38.660468 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 10:59:38.668487 (MainThread): Tracking: tracking
2021-10-06 10:59:38.671727 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cfefc970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d1928280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cff0e160>]}
2021-10-06 10:59:38.719787 (MainThread): Partial parsing not enabled
2021-10-06 10:59:38.734295 (MainThread): Parsing macros/Luhns.sql
2021-10-06 10:59:38.739875 (MainThread): Parsing macros/relations.sql
2021-10-06 10:59:38.747801 (MainThread): Parsing macros/adapters.sql
2021-10-06 10:59:38.783406 (MainThread): Parsing macros/catalog.sql
2021-10-06 10:59:38.789819 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 10:59:38.796209 (MainThread): Parsing macros/core.sql
2021-10-06 10:59:38.802355 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 10:59:38.848541 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 10:59:38.861918 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 10:59:38.872567 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 10:59:38.880797 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 10:59:38.903160 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 10:59:38.908121 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 10:59:38.943824 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 10:59:38.962752 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 10:59:38.988860 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 10:59:38.999880 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 10:59:39.016345 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 10:59:39.025047 (MainThread): Parsing macros/etc/query.sql
2021-10-06 10:59:39.028812 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 10:59:39.032968 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 10:59:39.045846 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 10:59:39.050487 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 10:59:39.054715 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 10:59:39.058520 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 10:59:39.062566 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 10:59:39.067709 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 10:59:39.072039 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 10:59:39.088850 (MainThread): Partial parsing not enabled
2021-10-06 10:59:39.133779 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 10:59:39.163605 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:59:39.188065 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 10:59:39.368485 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 10:59:39.384029 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06275bed-8730-46a1-8012-9fe4f0ae1cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cfdbb4f0>]}
2021-10-06 10:59:39.437524 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:59:39.440784 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 10:59:39.446361 (MainThread): 
2021-10-06 10:59:39.450653 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:59:39.459808 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 10:59:39.635610 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 10:59:39.638866 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 10:59:39.641392 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:59:39.657104 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 10:59:39.667899 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 10:59:39.675674 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 10:59:39.686268 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:59:39.688663 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 10:59:39.690723 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 10:59:39.699037 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:59:39.702436 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 10:59:39.706327 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 10:59:39.713655 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 10:59:39.731262 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 10:59:39.734907 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 10:59:39.752557 (MainThread): Using postgres connection "master".
2021-10-06 10:59:39.755716 (MainThread): On master: BEGIN
2021-10-06 10:59:39.759557 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:59:39.770032 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:59:39.774299 (MainThread): Using postgres connection "master".
2021-10-06 10:59:39.778387 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 10:59:39.785857 (MainThread): SQL status: SELECT 2 in 0.00 seconds
2021-10-06 10:59:39.791262 (MainThread): On master: ROLLBACK
2021-10-06 10:59:39.794065 (MainThread): Using postgres connection "master".
2021-10-06 10:59:39.797029 (MainThread): On master: BEGIN
2021-10-06 10:59:39.800031 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:59:39.803644 (MainThread): On master: COMMIT
2021-10-06 10:59:39.805613 (MainThread): Using postgres connection "master".
2021-10-06 10:59:39.808059 (MainThread): On master: COMMIT
2021-10-06 10:59:39.810556 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:59:39.812855 (MainThread): On master: Close
2021-10-06 10:59:39.816953 (MainThread): 10:59:39 | Concurrency: 2 threads (target='dev')
2021-10-06 10:59:39.820054 (MainThread): 10:59:39 | 
2021-10-06 10:59:39.832751 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 10:59:39.837246 (Thread-1): 10:59:39 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 10:59:39.841279 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:59:39.845731 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 10:59:39.866782 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:59:39.876244 (Thread-1): finished collecting timing info
2021-10-06 10:59:39.920517 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:59:39.923080 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 10:59:39.925467 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:59:39.932081 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 10:59:39.937454 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:59:39.939764 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 10:59:39.942203 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 10:59:39.956894 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 10:59:39.969687 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:59:39.973971 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 10:59:39.977637 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 10:59:39.980702 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 10:59:39.983764 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    sequence(creditcard)
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 10:59:39.988450 (Thread-1): Postgres error: function sequence(character varying) does not exist
LINE 5:     sequence(creditcard)
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-10-06 10:59:39.991752 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 10:59:39.996724 (Thread-1): finished collecting timing info
2021-10-06 10:59:40.000762 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 10:59:40.004323 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  function sequence(character varying) does not exist
  LINE 5:     sequence(creditcard)
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function sequence(character varying) does not exist
LINE 5:     sequence(creditcard)
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  function sequence(character varying) does not exist
  LINE 5:     sequence(creditcard)
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 10:59:40.010560 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06275bed-8730-46a1-8012-9fe4f0ae1cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cfe10400>]}
2021-10-06 10:59:40.017068 (Thread-1): 10:59:40 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.17s]
2021-10-06 10:59:40.021336 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 10:59:40.028425 (MainThread): Acquiring new postgres connection "master".
2021-10-06 10:59:40.031392 (MainThread): Using postgres connection "master".
2021-10-06 10:59:40.033896 (MainThread): On master: BEGIN
2021-10-06 10:59:40.037045 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:59:40.048796 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 10:59:40.051852 (MainThread): On master: COMMIT
2021-10-06 10:59:40.054776 (MainThread): Using postgres connection "master".
2021-10-06 10:59:40.057681 (MainThread): On master: COMMIT
2021-10-06 10:59:40.060949 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 10:59:40.063604 (MainThread): On master: Close
2021-10-06 10:59:40.067775 (MainThread): 10:59:40 | 
2021-10-06 10:59:40.070818 (MainThread): 10:59:40 | Finished running 1 view model in 0.62s.
2021-10-06 10:59:40.075183 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:59:40.078428 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 10:59:40.135593 (MainThread): 
2021-10-06 10:59:40.138321 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:59:40.281561 (MainThread): 
2021-10-06 10:59:40.287898 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 10:59:40.295319 (MainThread):   function sequence(character varying) does not exist
2021-10-06 10:59:40.300716 (MainThread):   LINE 5:     sequence(creditcard)
2021-10-06 10:59:40.307712 (MainThread):               ^
2021-10-06 10:59:40.313450 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-06 10:59:40.317010 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 10:59:40.319873 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 10:59:40.325024 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cfe04700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cfd22fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cfde1310>]}
2021-10-06 10:59:40.330990 (MainThread): Flushing usage events
2021-10-06 11:07:52.388013 (MainThread): Running with dbt=0.19.0
2021-10-06 11:07:52.729232 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 11:07:52.743736 (MainThread): Tracking: tracking
2021-10-06 11:07:52.752145 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9dfe78910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e347f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9dfe89100>]}
2021-10-06 11:07:52.824139 (MainThread): Partial parsing not enabled
2021-10-06 11:07:52.841556 (MainThread): Parsing macros/Luhns.sql
2021-10-06 11:07:52.847711 (MainThread): Parsing macros/relations.sql
2021-10-06 11:07:52.854228 (MainThread): Parsing macros/adapters.sql
2021-10-06 11:07:52.891332 (MainThread): Parsing macros/catalog.sql
2021-10-06 11:07:52.898286 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 11:07:52.905286 (MainThread): Parsing macros/core.sql
2021-10-06 11:07:52.914119 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 11:07:52.962385 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 11:07:52.973542 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 11:07:52.981941 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 11:07:52.990532 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 11:07:53.011829 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 11:07:53.015973 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 11:07:53.048368 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 11:07:53.071827 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 11:07:53.097708 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 11:07:53.104403 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 11:07:53.116766 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 11:07:53.126189 (MainThread): Parsing macros/etc/query.sql
2021-10-06 11:07:53.130615 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 11:07:53.135226 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 11:07:53.146262 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 11:07:53.151320 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 11:07:53.155524 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 11:07:53.158841 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 11:07:53.162696 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 11:07:53.173141 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 11:07:53.177704 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 11:07:53.196497 (MainThread): Partial parsing not enabled
2021-10-06 11:07:53.243670 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 11:07:53.276565 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 11:07:53.301858 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 11:07:53.525322 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 11:07:53.537176 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4df5c33e-3c13-4770-9e2e-ed836fb050fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9dfd419a0>]}
2021-10-06 11:07:53.612599 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:07:53.617071 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 11:07:53.625356 (MainThread): 
2021-10-06 11:07:53.632573 (MainThread): Acquiring new postgres connection "master".
2021-10-06 11:07:53.640764 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 11:07:53.670922 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 11:07:53.675668 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 11:07:53.677994 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:07:53.693988 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 11:07:53.703031 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 11:07:53.713642 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 11:07:53.728295 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 11:07:53.731018 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 11:07:53.733829 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 11:07:53.745266 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:07:53.749001 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 11:07:53.752531 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 11:07:53.759939 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 11:07:53.775934 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 11:07:53.779655 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 11:07:53.794772 (MainThread): Using postgres connection "master".
2021-10-06 11:07:53.797057 (MainThread): On master: BEGIN
2021-10-06 11:07:53.799412 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:07:53.809763 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:07:53.813273 (MainThread): Using postgres connection "master".
2021-10-06 11:07:53.818116 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 11:07:53.830707 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 11:07:53.837895 (MainThread): On master: ROLLBACK
2021-10-06 11:07:53.841035 (MainThread): Using postgres connection "master".
2021-10-06 11:07:53.843536 (MainThread): On master: BEGIN
2021-10-06 11:07:53.848232 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:07:53.852203 (MainThread): On master: COMMIT
2021-10-06 11:07:53.855164 (MainThread): Using postgres connection "master".
2021-10-06 11:07:53.857621 (MainThread): On master: COMMIT
2021-10-06 11:07:53.860724 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:07:53.862928 (MainThread): On master: Close
2021-10-06 11:07:53.865495 (MainThread): 11:07:53 | Concurrency: 2 threads (target='dev')
2021-10-06 11:07:53.868784 (MainThread): 11:07:53 | 
2021-10-06 11:07:53.878593 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 11:07:53.882958 (Thread-1): 11:07:53 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 11:07:53.891067 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 11:07:53.894765 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 11:07:53.927703 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 11:07:53.942496 (Thread-1): finished collecting timing info
2021-10-06 11:07:53.998670 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 11:07:54.002263 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 11:07:54.005978 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:07:54.017178 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:07:54.024448 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 11:07:54.028505 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 11:07:54.034769 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:07:54.056917 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 11:07:54.072955 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 11:07:54.076168 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 11:07:54.080601 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:07:54.083583 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 11:07:54.087219 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    <generator object select_or_reject at 0x7fa9dfc4ee40>
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 11:07:54.092084 (Thread-1): Postgres error: syntax error at or near "<"
LINE 5:     <generator object select_or_reject at 0x7fa9dfc4ee40>
            ^

2021-10-06 11:07:54.096058 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 11:07:54.099212 (Thread-1): finished collecting timing info
2021-10-06 11:07:54.102146 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 11:07:54.105705 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "<"
  LINE 5:     <generator object select_or_reject at 0x7fa9dfc4ee40>
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "<"
LINE 5:     <generator object select_or_reject at 0x7fa9dfc4ee40>
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "<"
  LINE 5:     <generator object select_or_reject at 0x7fa9dfc4ee40>
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 11:07:54.113099 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4df5c33e-3c13-4770-9e2e-ed836fb050fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9dfd7ad60>]}
2021-10-06 11:07:54.128908 (Thread-1): 11:07:54 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.23s]
2021-10-06 11:07:54.133754 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 11:07:54.142743 (MainThread): Acquiring new postgres connection "master".
2021-10-06 11:07:54.146517 (MainThread): Using postgres connection "master".
2021-10-06 11:07:54.149443 (MainThread): On master: BEGIN
2021-10-06 11:07:54.152711 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:07:54.165442 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:07:54.168370 (MainThread): On master: COMMIT
2021-10-06 11:07:54.173925 (MainThread): Using postgres connection "master".
2021-10-06 11:07:54.180485 (MainThread): On master: COMMIT
2021-10-06 11:07:54.183810 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:07:54.187013 (MainThread): On master: Close
2021-10-06 11:07:54.195117 (MainThread): 11:07:54 | 
2021-10-06 11:07:54.198083 (MainThread): 11:07:54 | Finished running 1 view model in 0.56s.
2021-10-06 11:07:54.202268 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:07:54.207759 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 11:07:54.273216 (MainThread): 
2021-10-06 11:07:54.276467 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 11:07:54.280605 (MainThread): 
2021-10-06 11:07:54.286035 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 11:07:54.295130 (MainThread):   syntax error at or near "<"
2021-10-06 11:07:54.301414 (MainThread):   LINE 5:     <generator object select_or_reject at 0x7fa9dfc4ee40>
2021-10-06 11:07:54.306388 (MainThread):               ^
2021-10-06 11:07:54.312913 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 11:07:54.317154 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 11:07:54.322341 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9dfc20ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9dfc47190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9dfc470a0>]}
2021-10-06 11:07:54.331788 (MainThread): Flushing usage events
2021-10-06 11:10:21.498630 (MainThread): Running with dbt=0.19.0
2021-10-06 11:10:21.718812 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 11:10:21.730504 (MainThread): Tracking: tracking
2021-10-06 11:10:21.735355 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e404d89a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e41f842b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e404ea190>]}
2021-10-06 11:10:21.780881 (MainThread): Partial parsing not enabled
2021-10-06 11:10:21.791461 (MainThread): Parsing macros/Luhns.sql
2021-10-06 11:10:21.796881 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e404787c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e404feb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e404feb20>]}
2021-10-06 11:10:21.800955 (MainThread): Flushing usage events
2021-10-06 11:10:22.449389 (MainThread): Encountered an error:
2021-10-06 11:10:22.460809 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set c = {{column_name}} %}
2021-10-06 11:10:22.475235 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set c = {{column_name}} %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set c = {{column_name}} %}

2021-10-06 12:56:19.717130 (MainThread): Running with dbt=0.19.0
2021-10-06 12:56:20.030442 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 12:56:20.046705 (MainThread): Tracking: tracking
2021-10-06 12:56:20.052579 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b461f0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b497f73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b462020a0>]}
2021-10-06 12:56:20.116415 (MainThread): Partial parsing not enabled
2021-10-06 12:56:20.128775 (MainThread): Parsing macros/Luhns.sql
2021-10-06 12:56:20.133879 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4618f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b46215640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b46215fa0>]}
2021-10-06 12:56:20.138130 (MainThread): Flushing usage events
2021-10-06 12:56:20.753004 (MainThread): Encountered an error:
2021-10-06 12:56:20.760938 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set c = {{column_name}} %}
2021-10-06 12:56:20.776643 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set c = {{column_name}} %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set c = {{column_name}} %}

2021-10-06 12:58:56.882832 (MainThread): Running with dbt=0.19.0
2021-10-06 12:58:57.136764 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 12:58:57.148187 (MainThread): Tracking: tracking
2021-10-06 12:58:57.153824 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8b8f3970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8d39f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8b904160>]}
2021-10-06 12:58:57.219514 (MainThread): Partial parsing not enabled
2021-10-06 12:58:57.228482 (MainThread): Parsing macros/Luhns.sql
2021-10-06 12:58:57.235909 (MainThread): Parsing macros/relations.sql
2021-10-06 12:58:57.242998 (MainThread): Parsing macros/adapters.sql
2021-10-06 12:58:57.271396 (MainThread): Parsing macros/catalog.sql
2021-10-06 12:58:57.277722 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 12:58:57.283806 (MainThread): Parsing macros/core.sql
2021-10-06 12:58:57.290497 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 12:58:57.335088 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 12:58:57.347541 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 12:58:57.357850 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 12:58:57.366403 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 12:58:57.388892 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 12:58:57.393948 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 12:58:57.430617 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 12:58:57.456145 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 12:58:57.487097 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 12:58:57.496590 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 12:58:57.505927 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 12:58:57.514986 (MainThread): Parsing macros/etc/query.sql
2021-10-06 12:58:57.518392 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 12:58:57.522850 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 12:58:57.536546 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 12:58:57.544928 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 12:58:57.549411 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 12:58:57.553248 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 12:58:57.557676 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 12:58:57.562589 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 12:58:57.566549 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 12:58:57.582265 (MainThread): Partial parsing not enabled
2021-10-06 12:58:57.627544 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 12:58:57.659023 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:58:57.701382 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 12:58:57.930913 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 12:58:57.939806 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f36949af-8dd8-4e46-b505-894942ad11eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8b7bae80>]}
2021-10-06 12:58:58.006822 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 12:58:58.011052 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 12:58:58.015097 (MainThread): 
2021-10-06 12:58:58.020582 (MainThread): Acquiring new postgres connection "master".
2021-10-06 12:58:58.027215 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 12:58:58.064858 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 12:58:58.083041 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 12:58:58.091876 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 12:58:58.117972 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.03 seconds
2021-10-06 12:58:58.126188 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 12:58:58.142856 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 12:58:58.155106 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 12:58:58.157652 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 12:58:58.161062 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 12:58:58.175081 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 12:58:58.177774 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 12:58:58.179979 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 12:58:58.194751 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 12:58:58.210605 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 12:58:58.213036 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 12:58:58.225537 (MainThread): Using postgres connection "master".
2021-10-06 12:58:58.227523 (MainThread): On master: BEGIN
2021-10-06 12:58:58.229471 (MainThread): Opening a new connection, currently in state init
2021-10-06 12:58:58.238819 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 12:58:58.241964 (MainThread): Using postgres connection "master".
2021-10-06 12:58:58.245520 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 12:58:58.261112 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 12:58:58.266620 (MainThread): On master: ROLLBACK
2021-10-06 12:58:58.269648 (MainThread): Using postgres connection "master".
2021-10-06 12:58:58.272082 (MainThread): On master: BEGIN
2021-10-06 12:58:58.275504 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 12:58:58.277828 (MainThread): On master: COMMIT
2021-10-06 12:58:58.280458 (MainThread): Using postgres connection "master".
2021-10-06 12:58:58.284353 (MainThread): On master: COMMIT
2021-10-06 12:58:58.287789 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 12:58:58.290960 (MainThread): On master: Close
2021-10-06 12:58:58.294427 (MainThread): 12:58:58 | Concurrency: 2 threads (target='dev')
2021-10-06 12:58:58.296998 (MainThread): 12:58:58 | 
2021-10-06 12:58:58.306082 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 12:58:58.311768 (Thread-1): 12:58:58 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 12:58:58.315268 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:58:58.319883 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 12:58:58.351301 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 12:58:58.376893 (Thread-1): finished collecting timing info
2021-10-06 12:58:58.425622 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:58:58.428788 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 12:58:58.431868 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 12:58:58.447506 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2021-10-06 12:58:58.454731 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:58:58.457066 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 12:58:58.460160 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 12:58:58.472864 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 12:58:58.496688 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:58:58.500432 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 12:58:58.504628 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 12:58:58.507599 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:58:58.511188 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    
    <generator object select_or_reject at 0x7f3c8b6cff90>
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 12:58:58.515178 (Thread-1): Postgres error: syntax error at or near "<"
LINE 6:     <generator object select_or_reject at 0x7f3c8b6cff90>
            ^

2021-10-06 12:58:58.519225 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 12:58:58.523098 (Thread-1): finished collecting timing info
2021-10-06 12:58:58.526545 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 12:58:58.531924 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "<"
  LINE 6:     <generator object select_or_reject at 0x7f3c8b6cff90>
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "<"
LINE 6:     <generator object select_or_reject at 0x7f3c8b6cff90>
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "<"
  LINE 6:     <generator object select_or_reject at 0x7f3c8b6cff90>
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 12:58:58.540552 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36949af-8dd8-4e46-b505-894942ad11eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8b80b730>]}
2021-10-06 12:58:58.544891 (Thread-1): 12:58:58 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.23s]
2021-10-06 12:58:58.547840 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 12:58:58.555376 (MainThread): Acquiring new postgres connection "master".
2021-10-06 12:58:58.560075 (MainThread): Using postgres connection "master".
2021-10-06 12:58:58.563431 (MainThread): On master: BEGIN
2021-10-06 12:58:58.566140 (MainThread): Opening a new connection, currently in state closed
2021-10-06 12:58:58.576072 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 12:58:58.580936 (MainThread): On master: COMMIT
2021-10-06 12:58:58.584250 (MainThread): Using postgres connection "master".
2021-10-06 12:58:58.587461 (MainThread): On master: COMMIT
2021-10-06 12:58:58.591007 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 12:58:58.594259 (MainThread): On master: Close
2021-10-06 12:58:58.598644 (MainThread): 12:58:58 | 
2021-10-06 12:58:58.602630 (MainThread): 12:58:58 | Finished running 1 view model in 0.58s.
2021-10-06 12:58:58.607603 (MainThread): Connection 'master' was properly closed.
2021-10-06 12:58:58.611541 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 12:58:58.684824 (MainThread): 
2021-10-06 12:58:58.688973 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 12:58:58.692816 (MainThread): 
2021-10-06 12:58:58.697200 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 12:58:58.702077 (MainThread):   syntax error at or near "<"
2021-10-06 12:58:58.705766 (MainThread):   LINE 6:     <generator object select_or_reject at 0x7f3c8b6cff90>
2021-10-06 12:58:58.710960 (MainThread):               ^
2021-10-06 12:58:58.717931 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 12:58:58.723471 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 12:58:58.729886 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8b69bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8b71afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8b8097f0>]}
2021-10-06 12:58:58.735904 (MainThread): Flushing usage events
2021-10-06 12:59:45.928911 (MainThread): Running with dbt=0.19.0
2021-10-06 12:59:46.213172 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 12:59:46.227750 (MainThread): Tracking: tracking
2021-10-06 12:59:46.231007 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8203732940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8206d39460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8203744130>]}
2021-10-06 12:59:46.285685 (MainThread): Partial parsing not enabled
2021-10-06 12:59:46.300728 (MainThread): Parsing macros/Luhns.sql
2021-10-06 12:59:46.305827 (MainThread): Parsing macros/relations.sql
2021-10-06 12:59:46.310183 (MainThread): Parsing macros/adapters.sql
2021-10-06 12:59:46.341336 (MainThread): Parsing macros/catalog.sql
2021-10-06 12:59:46.348045 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 12:59:46.355021 (MainThread): Parsing macros/core.sql
2021-10-06 12:59:46.363936 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 12:59:46.421687 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 12:59:46.434143 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 12:59:46.445240 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 12:59:46.460724 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 12:59:46.485031 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 12:59:46.490718 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 12:59:46.536886 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 12:59:46.553107 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 12:59:46.578810 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 12:59:46.582800 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 12:59:46.592143 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 12:59:46.604444 (MainThread): Parsing macros/etc/query.sql
2021-10-06 12:59:46.608548 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 12:59:46.613863 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 12:59:46.625927 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 12:59:46.630233 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 12:59:46.634135 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 12:59:46.638965 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 12:59:46.643198 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 12:59:46.648752 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 12:59:46.653405 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 12:59:46.672082 (MainThread): Partial parsing not enabled
2021-10-06 12:59:46.712394 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 12:59:46.744179 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:59:46.769238 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 12:59:46.942226 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 12:59:46.956157 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41a28856-1e23-4c00-bee6-88d7134ed865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82035f9160>]}
2021-10-06 12:59:47.006099 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 12:59:47.008942 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 12:59:47.012529 (MainThread): 
2021-10-06 12:59:47.015914 (MainThread): Acquiring new postgres connection "master".
2021-10-06 12:59:47.020918 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 12:59:47.037160 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 12:59:47.039371 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 12:59:47.041186 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 12:59:47.055636 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 12:59:47.069575 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 12:59:47.048896 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 12:59:47.065275 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 12:59:47.068987 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 12:59:47.071757 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 12:59:47.079228 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 12:59:47.081700 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 12:59:47.085083 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 12:59:47.091213 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 12:59:47.104965 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 12:59:47.108116 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 12:59:47.126722 (MainThread): Using postgres connection "master".
2021-10-06 12:59:47.130252 (MainThread): On master: BEGIN
2021-10-06 12:59:47.132930 (MainThread): Opening a new connection, currently in state init
2021-10-06 12:59:47.144147 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 12:59:47.151892 (MainThread): Using postgres connection "master".
2021-10-06 12:59:47.158112 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 12:59:47.172463 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 12:59:47.181892 (MainThread): On master: ROLLBACK
2021-10-06 12:59:47.188168 (MainThread): Using postgres connection "master".
2021-10-06 12:59:47.193234 (MainThread): On master: BEGIN
2021-10-06 12:59:47.198179 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 12:59:47.201868 (MainThread): On master: COMMIT
2021-10-06 12:59:47.205743 (MainThread): Using postgres connection "master".
2021-10-06 12:59:47.209123 (MainThread): On master: COMMIT
2021-10-06 12:59:47.212899 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 12:59:47.216286 (MainThread): On master: Close
2021-10-06 12:59:47.223357 (MainThread): 12:59:47 | Concurrency: 2 threads (target='dev')
2021-10-06 12:59:47.227065 (MainThread): 12:59:47 | 
2021-10-06 12:59:47.235254 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 12:59:47.247730 (Thread-1): 12:59:47 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 12:59:47.250117 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:59:47.252622 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 12:59:47.277012 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 12:59:47.289677 (Thread-1): finished collecting timing info
2021-10-06 12:59:47.340376 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:59:47.343364 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 12:59:47.346944 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 12:59:47.358193 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 12:59:47.372519 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:59:47.376690 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 12:59:47.382279 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 12:59:47.400504 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 12:59:47.408672 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:59:47.410873 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 12:59:47.413612 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 12:59:47.417329 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 12:59:47.420045 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    
    <generator object select_or_reject at 0x7f820350ae40>
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 12:59:47.424111 (Thread-1): Postgres error: syntax error at or near "<"
LINE 6:     <generator object select_or_reject at 0x7f820350ae40>
            ^

2021-10-06 12:59:47.428182 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 12:59:47.432747 (Thread-1): finished collecting timing info
2021-10-06 12:59:47.436397 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 12:59:47.441071 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "<"
  LINE 6:     <generator object select_or_reject at 0x7f820350ae40>
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "<"
LINE 6:     <generator object select_or_reject at 0x7f820350ae40>
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "<"
  LINE 6:     <generator object select_or_reject at 0x7f820350ae40>
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 12:59:47.447926 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41a28856-1e23-4c00-bee6-88d7134ed865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8203554790>]}
2021-10-06 12:59:47.451851 (Thread-1): 12:59:47 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.20s]
2021-10-06 12:59:47.454054 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 12:59:47.459835 (MainThread): Acquiring new postgres connection "master".
2021-10-06 12:59:47.462681 (MainThread): Using postgres connection "master".
2021-10-06 12:59:47.464892 (MainThread): On master: BEGIN
2021-10-06 12:59:47.467032 (MainThread): Opening a new connection, currently in state closed
2021-10-06 12:59:47.473937 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 12:59:47.477300 (MainThread): On master: COMMIT
2021-10-06 12:59:47.480977 (MainThread): Using postgres connection "master".
2021-10-06 12:59:47.483792 (MainThread): On master: COMMIT
2021-10-06 12:59:47.488008 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 12:59:47.490479 (MainThread): On master: Close
2021-10-06 12:59:47.493845 (MainThread): 12:59:47 | 
2021-10-06 12:59:47.498711 (MainThread): 12:59:47 | Finished running 1 view model in 0.48s.
2021-10-06 12:59:47.502102 (MainThread): Connection 'master' was properly closed.
2021-10-06 12:59:47.504720 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 12:59:47.557420 (MainThread): 
2021-10-06 12:59:47.560206 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 12:59:47.565152 (MainThread): 
2021-10-06 12:59:47.570455 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 12:59:47.575655 (MainThread):   syntax error at or near "<"
2021-10-06 12:59:47.580349 (MainThread):   LINE 6:     <generator object select_or_reject at 0x7f820350ae40>
2021-10-06 12:59:47.584344 (MainThread):               ^
2021-10-06 12:59:47.589432 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 12:59:47.593080 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 12:59:47.597082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82034d9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f820355bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202c5b490>]}
2021-10-06 12:59:47.601667 (MainThread): Flushing usage events
2021-10-06 13:00:43.202439 (MainThread): Running with dbt=0.19.0
2021-10-06 13:00:43.485835 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 13:00:43.495783 (MainThread): Tracking: tracking
2021-10-06 13:00:43.498996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6adc02fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b12083a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6adc13070>]}
2021-10-06 13:00:43.528465 (MainThread): Partial parsing not enabled
2021-10-06 13:00:43.540607 (MainThread): Parsing macros/Luhns.sql
2021-10-06 13:00:43.552134 (MainThread): Parsing macros/relations.sql
2021-10-06 13:00:43.562980 (MainThread): Parsing macros/adapters.sql
2021-10-06 13:00:43.592851 (MainThread): Parsing macros/catalog.sql
2021-10-06 13:00:43.602326 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 13:00:43.612331 (MainThread): Parsing macros/core.sql
2021-10-06 13:00:43.619373 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 13:00:43.661823 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 13:00:43.672657 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 13:00:43.681231 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 13:00:43.689026 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 13:00:43.715882 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 13:00:43.724103 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 13:00:43.761245 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 13:00:43.778763 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 13:00:43.807514 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 13:00:43.811858 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 13:00:43.820094 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 13:00:43.828594 (MainThread): Parsing macros/etc/query.sql
2021-10-06 13:00:43.831821 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 13:00:43.835553 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 13:00:43.846489 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 13:00:43.850687 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 13:00:43.855894 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 13:00:43.859120 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 13:00:43.863010 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 13:00:43.867891 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 13:00:43.872862 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 13:00:43.889550 (MainThread): Partial parsing not enabled
2021-10-06 13:00:43.938154 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 13:00:43.965372 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:00:43.992627 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 13:00:44.184151 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 13:00:44.191021 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11bd8cf2-d03d-4f64-b185-0b901fd4df75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6adb040a0>]}
2021-10-06 13:00:44.249565 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 13:00:44.253803 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 13:00:44.260155 (MainThread): 
2021-10-06 13:00:44.264037 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:00:44.271584 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 13:00:44.290265 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 13:00:44.293327 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 13:00:44.296746 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 13:00:44.311696 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 13:00:44.320451 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 13:00:44.329338 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 13:00:44.342592 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:00:44.345566 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 13:00:44.348410 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 13:00:44.357422 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:00:44.360261 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:00:44.363001 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 13:00:44.372005 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 13:00:44.399793 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 13:00:44.403277 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 13:00:44.428422 (MainThread): Using postgres connection "master".
2021-10-06 13:00:44.432563 (MainThread): On master: BEGIN
2021-10-06 13:00:44.435233 (MainThread): Opening a new connection, currently in state init
2021-10-06 13:00:44.445690 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:00:44.449411 (MainThread): Using postgres connection "master".
2021-10-06 13:00:44.453512 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 13:00:44.471058 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 13:00:44.478278 (MainThread): On master: ROLLBACK
2021-10-06 13:00:44.480839 (MainThread): Using postgres connection "master".
2021-10-06 13:00:44.482927 (MainThread): On master: BEGIN
2021-10-06 13:00:44.486785 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:00:44.489472 (MainThread): On master: COMMIT
2021-10-06 13:00:44.491693 (MainThread): Using postgres connection "master".
2021-10-06 13:00:44.493549 (MainThread): On master: COMMIT
2021-10-06 13:00:44.495925 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:00:44.498618 (MainThread): On master: Close
2021-10-06 13:00:44.502553 (MainThread): 13:00:44 | Concurrency: 2 threads (target='dev')
2021-10-06 13:00:44.504909 (MainThread): 13:00:44 | 
2021-10-06 13:00:44.515327 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 13:00:44.522740 (Thread-1): 13:00:44 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 13:00:44.526305 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:00:44.529774 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 13:00:44.549020 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:00:44.556830 (Thread-1): finished collecting timing info
2021-10-06 13:00:44.595111 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:00:44.597554 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 13:00:44.599754 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 13:00:44.608803 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 13:00:44.617704 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:00:44.621068 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 13:00:44.624445 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 13:00:44.635906 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:00:44.644559 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:00:44.647789 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 13:00:44.651234 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:00:44.654862 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:00:44.658114 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    
    <generator object select_or_reject at 0x7fe6ad9d8e40>
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 13:00:44.663042 (Thread-1): Postgres error: syntax error at or near "<"
LINE 6:     <generator object select_or_reject at 0x7fe6ad9d8e40>
            ^

2021-10-06 13:00:44.667053 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 13:00:44.672559 (Thread-1): finished collecting timing info
2021-10-06 13:00:44.675994 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 13:00:44.679650 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "<"
  LINE 6:     <generator object select_or_reject at 0x7fe6ad9d8e40>
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "<"
LINE 6:     <generator object select_or_reject at 0x7fe6ad9d8e40>
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "<"
  LINE 6:     <generator object select_or_reject at 0x7fe6ad9d8e40>
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 13:00:44.686699 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11bd8cf2-d03d-4f64-b185-0b901fd4df75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ad9ba700>]}
2021-10-06 13:00:44.690823 (Thread-1): 13:00:44 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.16s]
2021-10-06 13:00:44.693082 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 13:00:44.700018 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:00:44.704238 (MainThread): Using postgres connection "master".
2021-10-06 13:00:44.708185 (MainThread): On master: BEGIN
2021-10-06 13:00:44.711065 (MainThread): Opening a new connection, currently in state closed
2021-10-06 13:00:44.722325 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:00:44.725427 (MainThread): On master: COMMIT
2021-10-06 13:00:44.727946 (MainThread): Using postgres connection "master".
2021-10-06 13:00:44.731291 (MainThread): On master: COMMIT
2021-10-06 13:00:44.735757 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:00:44.738782 (MainThread): On master: Close
2021-10-06 13:00:44.742426 (MainThread): 13:00:44 | 
2021-10-06 13:00:44.746105 (MainThread): 13:00:44 | Finished running 1 view model in 0.48s.
2021-10-06 13:00:44.750574 (MainThread): Connection 'master' was properly closed.
2021-10-06 13:00:44.757422 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 13:00:44.828398 (MainThread): 
2021-10-06 13:00:44.830764 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 13:00:44.833827 (MainThread): 
2021-10-06 13:00:44.837962 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 13:00:44.840985 (MainThread):   syntax error at or near "<"
2021-10-06 13:00:44.845107 (MainThread):   LINE 6:     <generator object select_or_reject at 0x7fe6ad9d8e40>
2021-10-06 13:00:44.848604 (MainThread):               ^
2021-10-06 13:00:44.852485 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 13:00:44.856476 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 13:00:44.860066 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ad1510d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6adac7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6adac7550>]}
2021-10-06 13:00:44.865923 (MainThread): Flushing usage events
2021-10-06 13:01:05.913189 (MainThread): Running with dbt=0.19.0
2021-10-06 13:01:06.169587 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 13:01:06.179728 (MainThread): Tracking: tracking
2021-10-06 13:01:06.184993 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d294e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d5f55430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d295e100>]}
2021-10-06 13:01:06.242220 (MainThread): Partial parsing not enabled
2021-10-06 13:01:06.251565 (MainThread): Parsing macros/Luhns.sql
2021-10-06 13:01:06.255264 (MainThread): Parsing macros/relations.sql
2021-10-06 13:01:06.259335 (MainThread): Parsing macros/adapters.sql
2021-10-06 13:01:06.281202 (MainThread): Parsing macros/catalog.sql
2021-10-06 13:01:06.286137 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 13:01:06.291090 (MainThread): Parsing macros/core.sql
2021-10-06 13:01:06.298466 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 13:01:06.346301 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 13:01:06.363580 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 13:01:06.378381 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 13:01:06.388232 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 13:01:06.419637 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 13:01:06.425848 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 13:01:06.461728 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 13:01:06.477386 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 13:01:06.500978 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 13:01:06.505446 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 13:01:06.513371 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 13:01:06.521861 (MainThread): Parsing macros/etc/query.sql
2021-10-06 13:01:06.525376 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 13:01:06.529286 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 13:01:06.541308 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 13:01:06.545588 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 13:01:06.549600 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 13:01:06.552746 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 13:01:06.556789 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 13:01:06.562507 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 13:01:06.566318 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 13:01:06.582397 (MainThread): Partial parsing not enabled
2021-10-06 13:01:06.627180 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 13:01:06.655271 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:01:06.679568 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 13:01:06.886579 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 13:01:06.895655 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81b968c9-7207-4363-bace-8e4f1ed0a7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d2813e80>]}
2021-10-06 13:01:06.962347 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 13:01:06.966801 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 13:01:06.971934 (MainThread): 
2021-10-06 13:01:06.977842 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:01:06.986362 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 13:01:07.011822 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 13:01:07.015982 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 13:01:07.020847 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 13:01:07.036502 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 13:01:07.047264 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 13:01:07.058544 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 13:01:07.070814 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:01:07.073324 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 13:01:07.075343 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 13:01:07.084601 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:01:07.087446 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:01:07.090194 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 13:01:07.097324 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 13:01:07.112615 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 13:01:07.115500 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 13:01:07.125802 (MainThread): Using postgres connection "master".
2021-10-06 13:01:07.127992 (MainThread): On master: BEGIN
2021-10-06 13:01:07.129933 (MainThread): Opening a new connection, currently in state init
2021-10-06 13:01:07.137388 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:01:07.140435 (MainThread): Using postgres connection "master".
2021-10-06 13:01:07.144307 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 13:01:07.157985 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 13:01:07.165771 (MainThread): On master: ROLLBACK
2021-10-06 13:01:07.168998 (MainThread): Using postgres connection "master".
2021-10-06 13:01:07.171510 (MainThread): On master: BEGIN
2021-10-06 13:01:07.176190 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:01:07.178725 (MainThread): On master: COMMIT
2021-10-06 13:01:07.181933 (MainThread): Using postgres connection "master".
2021-10-06 13:01:07.184659 (MainThread): On master: COMMIT
2021-10-06 13:01:07.187357 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:01:07.189785 (MainThread): On master: Close
2021-10-06 13:01:07.191968 (MainThread): 13:01:07 | Concurrency: 2 threads (target='dev')
2021-10-06 13:01:07.195335 (MainThread): 13:01:07 | 
2021-10-06 13:01:07.205260 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 13:01:07.211240 (Thread-1): 13:01:07 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 13:01:07.215279 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:01:07.218294 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 13:01:07.239744 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:01:07.248574 (Thread-1): finished collecting timing info
2021-10-06 13:01:07.301932 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:01:07.304538 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 13:01:07.306954 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 13:01:07.314604 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 13:01:07.323111 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:01:07.326145 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 13:01:07.331821 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 13:01:07.353158 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:01:07.362556 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:01:07.365769 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 13:01:07.369884 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:01:07.374959 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:01:07.381391 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 13:01:07.386152 (Thread-1): Postgres error: syntax error at or near "as"
LINE 6:  as LuhnCC, sum(o.totalamount) from orders o
         ^

2021-10-06 13:01:07.390926 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 13:01:07.397290 (Thread-1): finished collecting timing info
2021-10-06 13:01:07.402521 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 13:01:07.407838 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "as"
  LINE 6:  as LuhnCC, sum(o.totalamount) from orders o
           ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "as"
LINE 6:  as LuhnCC, sum(o.totalamount) from orders o
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "as"
  LINE 6:  as LuhnCC, sum(o.totalamount) from orders o
           ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 13:01:07.415126 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b968c9-7207-4363-bace-8e4f1ed0a7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d2719040>]}
2021-10-06 13:01:07.419021 (Thread-1): 13:01:07 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.20s]
2021-10-06 13:01:07.421401 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 13:01:07.428119 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:01:07.431686 (MainThread): Using postgres connection "master".
2021-10-06 13:01:07.436476 (MainThread): On master: BEGIN
2021-10-06 13:01:07.440703 (MainThread): Opening a new connection, currently in state closed
2021-10-06 13:01:07.453131 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:01:07.459865 (MainThread): On master: COMMIT
2021-10-06 13:01:07.462873 (MainThread): Using postgres connection "master".
2021-10-06 13:01:07.466228 (MainThread): On master: COMMIT
2021-10-06 13:01:07.472683 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:01:07.476014 (MainThread): On master: Close
2021-10-06 13:01:07.481605 (MainThread): 13:01:07 | 
2021-10-06 13:01:07.484805 (MainThread): 13:01:07 | Finished running 1 view model in 0.51s.
2021-10-06 13:01:07.488776 (MainThread): Connection 'master' was properly closed.
2021-10-06 13:01:07.495453 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 13:01:07.552428 (MainThread): 
2021-10-06 13:01:07.555312 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 13:01:07.559284 (MainThread): 
2021-10-06 13:01:07.562846 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 13:01:07.568885 (MainThread):   syntax error at or near "as"
2021-10-06 13:01:07.574033 (MainThread):   LINE 6:  as LuhnCC, sum(o.totalamount) from orders o
2021-10-06 13:01:07.579201 (MainThread):            ^
2021-10-06 13:01:07.582790 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 13:01:07.586828 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 13:01:07.591789 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d26f4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d1e815e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d1e81b80>]}
2021-10-06 13:01:07.596607 (MainThread): Flushing usage events
2021-10-06 13:03:50.421586 (MainThread): Running with dbt=0.19.0
2021-10-06 13:03:50.632172 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 13:03:50.649463 (MainThread): Tracking: tracking
2021-10-06 13:03:50.653601 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4cafbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc50102400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4cb0c0d0>]}
2021-10-06 13:03:50.703714 (MainThread): Partial parsing not enabled
2021-10-06 13:03:50.715060 (MainThread): Parsing macros/Luhns.sql
2021-10-06 13:03:50.719620 (MainThread): Parsing macros/relations.sql
2021-10-06 13:03:50.725008 (MainThread): Parsing macros/adapters.sql
2021-10-06 13:03:50.774719 (MainThread): Parsing macros/catalog.sql
2021-10-06 13:03:50.786046 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 13:03:50.791774 (MainThread): Parsing macros/core.sql
2021-10-06 13:03:50.803029 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 13:03:50.856911 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 13:03:50.868781 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 13:03:50.878226 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 13:03:50.885905 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 13:03:50.905669 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 13:03:50.909608 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 13:03:50.946678 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 13:03:50.965233 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 13:03:50.988909 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 13:03:50.992858 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 13:03:51.001824 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 13:03:51.010599 (MainThread): Parsing macros/etc/query.sql
2021-10-06 13:03:51.013998 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 13:03:51.017898 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 13:03:51.028888 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 13:03:51.033062 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 13:03:51.040397 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 13:03:51.045621 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 13:03:51.050000 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 13:03:51.054844 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 13:03:51.058804 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 13:03:51.071449 (MainThread): Partial parsing not enabled
2021-10-06 13:03:51.112040 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 13:03:51.149528 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:03:51.173437 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 13:03:51.417821 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 13:03:51.432695 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca28a29f-4234-43cf-8bc7-b3eaae651404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4c9c0850>]}
2021-10-06 13:03:51.499917 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 13:03:51.503692 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 13:03:51.508799 (MainThread): 
2021-10-06 13:03:51.513631 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:03:51.520840 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 13:03:51.544302 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 13:03:51.548024 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 13:03:51.551077 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 13:03:51.562472 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 13:03:51.573063 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 13:03:51.584492 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 13:03:51.593952 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:03:51.595972 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 13:03:51.597868 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 13:03:51.607422 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:03:51.610036 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:03:51.614434 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 13:03:51.622320 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 13:03:51.638454 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 13:03:51.641664 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 13:03:51.655076 (MainThread): Using postgres connection "master".
2021-10-06 13:03:51.657870 (MainThread): On master: BEGIN
2021-10-06 13:03:51.660263 (MainThread): Opening a new connection, currently in state init
2021-10-06 13:03:51.668635 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:03:51.671050 (MainThread): Using postgres connection "master".
2021-10-06 13:03:51.673261 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 13:03:51.683311 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 13:03:51.688893 (MainThread): On master: ROLLBACK
2021-10-06 13:03:51.692262 (MainThread): Using postgres connection "master".
2021-10-06 13:03:51.694596 (MainThread): On master: BEGIN
2021-10-06 13:03:51.698249 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:03:51.700963 (MainThread): On master: COMMIT
2021-10-06 13:03:51.703633 (MainThread): Using postgres connection "master".
2021-10-06 13:03:51.706688 (MainThread): On master: COMMIT
2021-10-06 13:03:51.709374 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:03:51.712456 (MainThread): On master: Close
2021-10-06 13:03:51.714926 (MainThread): 13:03:51 | Concurrency: 2 threads (target='dev')
2021-10-06 13:03:51.717704 (MainThread): 13:03:51 | 
2021-10-06 13:03:51.728530 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 13:03:51.733580 (Thread-1): 13:03:51 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 13:03:51.736706 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:03:51.741011 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 13:03:51.770400 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:03:51.782350 (Thread-1): finished collecting timing info
2021-10-06 13:03:51.824073 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:03:51.826889 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 13:03:51.829447 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 13:03:51.837652 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 13:03:51.846562 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:03:51.849668 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 13:03:51.852867 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 13:03:51.865830 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:03:51.877888 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:03:51.880961 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 13:03:51.884527 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:03:51.887228 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:03:51.890061 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 13:03:51.892931 (Thread-1): Postgres error: syntax error at or near "as"
LINE 6:  as LuhnCC, sum(o.totalamount) from orders o
         ^

2021-10-06 13:03:51.896351 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 13:03:51.899358 (Thread-1): finished collecting timing info
2021-10-06 13:03:51.903748 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 13:03:51.912642 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "as"
  LINE 6:  as LuhnCC, sum(o.totalamount) from orders o
           ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "as"
LINE 6:  as LuhnCC, sum(o.totalamount) from orders o
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "as"
  LINE 6:  as LuhnCC, sum(o.totalamount) from orders o
           ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 13:03:51.922286 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca28a29f-4234-43cf-8bc7-b3eaae651404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4c9fb910>]}
2021-10-06 13:03:51.930741 (Thread-1): 13:03:51 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.19s]
2021-10-06 13:03:51.936977 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 13:03:51.944603 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:03:51.949067 (MainThread): Using postgres connection "master".
2021-10-06 13:03:51.952009 (MainThread): On master: BEGIN
2021-10-06 13:03:51.955549 (MainThread): Opening a new connection, currently in state closed
2021-10-06 13:03:51.970135 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:03:51.974248 (MainThread): On master: COMMIT
2021-10-06 13:03:51.977629 (MainThread): Using postgres connection "master".
2021-10-06 13:03:51.982012 (MainThread): On master: COMMIT
2021-10-06 13:03:51.987300 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:03:51.991028 (MainThread): On master: Close
2021-10-06 13:03:51.995056 (MainThread): 13:03:51 | 
2021-10-06 13:03:51.998540 (MainThread): 13:03:51 | Finished running 1 view model in 0.48s.
2021-10-06 13:03:52.001695 (MainThread): Connection 'master' was properly closed.
2021-10-06 13:03:52.004770 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 13:03:52.066548 (MainThread): 
2021-10-06 13:03:52.069544 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 13:03:52.073645 (MainThread): 
2021-10-06 13:03:52.080733 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 13:03:52.084373 (MainThread):   syntax error at or near "as"
2021-10-06 13:03:52.088734 (MainThread):   LINE 6:  as LuhnCC, sum(o.totalamount) from orders o
2021-10-06 13:03:52.094418 (MainThread):            ^
2021-10-06 13:03:52.099695 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 13:03:52.103599 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 13:03:52.110800 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4ca0aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4c8c9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4c8a3ee0>]}
2021-10-06 13:03:52.115468 (MainThread): Flushing usage events
2021-10-06 13:05:06.962245 (MainThread): Running with dbt=0.19.0
2021-10-06 13:05:07.194924 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 13:05:07.208695 (MainThread): Tracking: tracking
2021-10-06 13:05:07.216193 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f60ff5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f645fb430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f61006100>]}
2021-10-06 13:05:07.282642 (MainThread): Partial parsing not enabled
2021-10-06 13:05:07.293742 (MainThread): Parsing macros/Luhns.sql
2021-10-06 13:05:07.297879 (MainThread): Parsing macros/relations.sql
2021-10-06 13:05:07.302970 (MainThread): Parsing macros/adapters.sql
2021-10-06 13:05:07.329636 (MainThread): Parsing macros/catalog.sql
2021-10-06 13:05:07.334433 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 13:05:07.346475 (MainThread): Parsing macros/core.sql
2021-10-06 13:05:07.361137 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 13:05:07.417301 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 13:05:07.430025 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 13:05:07.442977 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 13:05:07.458783 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 13:05:07.480701 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 13:05:07.486553 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 13:05:07.524442 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 13:05:07.541284 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 13:05:07.565347 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 13:05:07.570341 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 13:05:07.579283 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 13:05:07.588974 (MainThread): Parsing macros/etc/query.sql
2021-10-06 13:05:07.592472 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 13:05:07.600111 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 13:05:07.613086 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 13:05:07.618062 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 13:05:07.622066 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 13:05:07.625395 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 13:05:07.631567 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 13:05:07.640684 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 13:05:07.644617 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 13:05:07.660006 (MainThread): Partial parsing not enabled
2021-10-06 13:05:07.701761 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 13:05:07.731092 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:05:07.753689 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 13:05:07.934731 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 13:05:07.951677 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc37ca8e-ad33-40b9-aad9-6fd7481a3cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f60eafe20>]}
2021-10-06 13:05:08.018656 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 13:05:08.023186 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 13:05:08.029917 (MainThread): 
2021-10-06 13:05:08.034931 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:05:08.041301 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 13:05:08.070529 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 13:05:08.073224 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 13:05:08.075968 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 13:05:08.090574 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 13:05:08.099752 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 13:05:08.109609 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 13:05:08.117988 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:05:08.120267 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 13:05:08.121755 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 13:05:08.128762 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:05:08.133258 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:05:08.137949 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 13:05:08.145659 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 13:05:08.155467 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 13:05:08.158548 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 13:05:08.170856 (MainThread): Using postgres connection "master".
2021-10-06 13:05:08.173514 (MainThread): On master: BEGIN
2021-10-06 13:05:08.176016 (MainThread): Opening a new connection, currently in state init
2021-10-06 13:05:08.183572 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:05:08.187019 (MainThread): Using postgres connection "master".
2021-10-06 13:05:08.190456 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 13:05:08.199051 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 13:05:08.204605 (MainThread): On master: ROLLBACK
2021-10-06 13:05:08.207363 (MainThread): Using postgres connection "master".
2021-10-06 13:05:08.209284 (MainThread): On master: BEGIN
2021-10-06 13:05:08.212789 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:05:08.216409 (MainThread): On master: COMMIT
2021-10-06 13:05:08.218164 (MainThread): Using postgres connection "master".
2021-10-06 13:05:08.220128 (MainThread): On master: COMMIT
2021-10-06 13:05:08.222510 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:05:08.224619 (MainThread): On master: Close
2021-10-06 13:05:08.226971 (MainThread): 13:05:08 | Concurrency: 2 threads (target='dev')
2021-10-06 13:05:08.229287 (MainThread): 13:05:08 | 
2021-10-06 13:05:08.238263 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 13:05:08.241475 (Thread-1): 13:05:08 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 13:05:08.244352 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:05:08.248502 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 13:05:08.269175 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:05:08.278460 (Thread-1): finished collecting timing info
2021-10-06 13:05:08.317235 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:05:08.320065 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 13:05:08.322593 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 13:05:08.331698 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 13:05:08.339667 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:05:08.342293 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 13:05:08.346199 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 13:05:08.358433 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:05:08.365163 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:05:08.367574 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 13:05:08.372059 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:05:08.375882 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:05:08.380001 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    (creditcard::numeric / 100)::numeric(16, 2)
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 13:05:08.417981 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2021-10-06 13:05:08.436169 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:05:08.439312 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 13:05:08.443665 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 13:05:08.452747 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:05:08.456149 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 13:05:08.460698 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 13:05:08.475915 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 13:05:08.478462 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:05:08.481335 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 13:05:08.488034 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:05:08.503512 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:05:08.507059 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 13:05:08.516448 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 13:05:08.524212 (Thread-1): finished collecting timing info
2021-10-06 13:05:08.527256 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 13:05:08.534029 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc37ca8e-ad33-40b9-aad9-6fd7481a3cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f60559820>]}
2021-10-06 13:05:08.538707 (Thread-1): 13:05:08 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.29s]
2021-10-06 13:05:08.541718 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 13:05:08.547249 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:05:08.551619 (MainThread): Using postgres connection "master".
2021-10-06 13:05:08.556408 (MainThread): On master: BEGIN
2021-10-06 13:05:08.559200 (MainThread): Opening a new connection, currently in state closed
2021-10-06 13:05:08.570016 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:05:08.574075 (MainThread): On master: COMMIT
2021-10-06 13:05:08.576704 (MainThread): Using postgres connection "master".
2021-10-06 13:05:08.580164 (MainThread): On master: COMMIT
2021-10-06 13:05:08.585098 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:05:08.588278 (MainThread): On master: Close
2021-10-06 13:05:08.591901 (MainThread): 13:05:08 | 
2021-10-06 13:05:08.594691 (MainThread): 13:05:08 | Finished running 1 view model in 0.56s.
2021-10-06 13:05:08.599929 (MainThread): Connection 'master' was properly closed.
2021-10-06 13:05:08.604448 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 13:05:08.666645 (MainThread): 
2021-10-06 13:05:08.669463 (MainThread): Completed successfully
2021-10-06 13:05:08.672734 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 13:05:08.676811 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f60eb0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f60dc4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f60505850>]}
2021-10-06 13:05:08.683621 (MainThread): Flushing usage events
2021-10-06 13:07:22.639487 (MainThread): Running with dbt=0.19.0
2021-10-06 13:07:22.857327 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 13:07:22.871612 (MainThread): Tracking: tracking
2021-10-06 13:07:22.875012 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37988cb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f379bed3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37988dd130>]}
2021-10-06 13:07:22.922448 (MainThread): Partial parsing not enabled
2021-10-06 13:07:22.933414 (MainThread): Parsing macros/Luhns.sql
2021-10-06 13:07:22.937072 (MainThread): Parsing macros/relations.sql
2021-10-06 13:07:22.943106 (MainThread): Parsing macros/adapters.sql
2021-10-06 13:07:22.985819 (MainThread): Parsing macros/catalog.sql
2021-10-06 13:07:22.992056 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 13:07:23.001884 (MainThread): Parsing macros/core.sql
2021-10-06 13:07:23.013694 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 13:07:23.058257 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 13:07:23.069873 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 13:07:23.078528 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 13:07:23.086337 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 13:07:23.106151 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 13:07:23.110367 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 13:07:23.144884 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 13:07:23.163636 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 13:07:23.187928 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 13:07:23.192441 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 13:07:23.201229 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 13:07:23.209734 (MainThread): Parsing macros/etc/query.sql
2021-10-06 13:07:23.213338 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 13:07:23.217385 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 13:07:23.229570 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 13:07:23.234835 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 13:07:23.238827 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 13:07:23.242202 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 13:07:23.246291 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 13:07:23.251381 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 13:07:23.255825 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 13:07:23.276898 (MainThread): Partial parsing not enabled
2021-10-06 13:07:23.328476 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 13:07:23.367913 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:23.393364 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 13:07:23.580991 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 13:07:23.586490 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78f38923-15e8-403c-b596-5b48ece45757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3798795e80>]}
2021-10-06 13:07:23.636178 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 13:07:23.641540 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 13:07:23.647586 (MainThread): 
2021-10-06 13:07:23.653965 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:07:23.662326 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 13:07:23.680311 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 13:07:23.682402 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 13:07:23.686228 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 13:07:23.696589 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 13:07:23.708469 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 13:07:23.719524 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 13:07:23.735777 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:07:23.738579 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 13:07:23.740573 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 13:07:23.750432 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:07:23.753300 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:07:23.755438 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 13:07:23.762554 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 13:07:23.776044 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 13:07:23.779411 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 13:07:23.791989 (MainThread): Using postgres connection "master".
2021-10-06 13:07:23.794220 (MainThread): On master: BEGIN
2021-10-06 13:07:23.796185 (MainThread): Opening a new connection, currently in state init
2021-10-06 13:07:23.806005 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:07:23.809286 (MainThread): Using postgres connection "master".
2021-10-06 13:07:23.812179 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 13:07:23.822232 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 13:07:23.827718 (MainThread): On master: ROLLBACK
2021-10-06 13:07:23.830192 (MainThread): Using postgres connection "master".
2021-10-06 13:07:23.832393 (MainThread): On master: BEGIN
2021-10-06 13:07:23.835305 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:07:23.837815 (MainThread): On master: COMMIT
2021-10-06 13:07:23.840080 (MainThread): Using postgres connection "master".
2021-10-06 13:07:23.842084 (MainThread): On master: COMMIT
2021-10-06 13:07:23.844362 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:07:23.846203 (MainThread): On master: Close
2021-10-06 13:07:23.848623 (MainThread): 13:07:23 | Concurrency: 2 threads (target='dev')
2021-10-06 13:07:23.854299 (MainThread): 13:07:23 | 
2021-10-06 13:07:23.863289 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 13:07:23.866390 (Thread-1): 13:07:23 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 13:07:23.870604 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:23.875547 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 13:07:23.898096 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:07:23.910848 (Thread-1): finished collecting timing info
2021-10-06 13:07:23.944668 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:23.947204 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 13:07:23.949918 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 13:07:23.959094 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 13:07:23.967721 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:23.970425 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 13:07:23.975402 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 13:07:23.982723 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:07:23.990252 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:23.993500 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 13:07:23.998036 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:07:24.001519 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:24.005928 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    (creditcard::numeric %% 10)
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 13:07:24.010226 (Thread-1): Postgres error: operator does not exist: numeric %% integer
LINE 5:     (creditcard::numeric %% 10)
                                 ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2021-10-06 13:07:24.013874 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 13:07:24.017124 (Thread-1): finished collecting timing info
2021-10-06 13:07:24.021080 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 13:07:24.025549 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: numeric %% integer
  LINE 5:     (creditcard::numeric %% 10)
                                   ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: operator does not exist: numeric %% integer
LINE 5:     (creditcard::numeric %% 10)
                                 ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: numeric %% integer
  LINE 5:     (creditcard::numeric %% 10)
                                   ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 13:07:24.031691 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78f38923-15e8-403c-b596-5b48ece45757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f379869b580>]}
2021-10-06 13:07:24.035012 (Thread-1): 13:07:24 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.16s]
2021-10-06 13:07:24.037405 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 13:07:24.043642 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:07:24.046994 (MainThread): Using postgres connection "master".
2021-10-06 13:07:24.049216 (MainThread): On master: BEGIN
2021-10-06 13:07:24.053043 (MainThread): Opening a new connection, currently in state closed
2021-10-06 13:07:24.063256 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:07:24.067441 (MainThread): On master: COMMIT
2021-10-06 13:07:24.070612 (MainThread): Using postgres connection "master".
2021-10-06 13:07:24.075187 (MainThread): On master: COMMIT
2021-10-06 13:07:24.078960 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:07:24.081541 (MainThread): On master: Close
2021-10-06 13:07:24.085283 (MainThread): 13:07:24 | 
2021-10-06 13:07:24.088191 (MainThread): 13:07:24 | Finished running 1 view model in 0.43s.
2021-10-06 13:07:24.093525 (MainThread): Connection 'master' was properly closed.
2021-10-06 13:07:24.099564 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 13:07:24.169333 (MainThread): 
2021-10-06 13:07:24.172825 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 13:07:24.176855 (MainThread): 
2021-10-06 13:07:24.180281 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 13:07:24.184535 (MainThread):   operator does not exist: numeric %% integer
2021-10-06 13:07:24.188511 (MainThread):   LINE 5:     (creditcard::numeric %% 10)
2021-10-06 13:07:24.192934 (MainThread):                                    ^
2021-10-06 13:07:24.197582 (MainThread):   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2021-10-06 13:07:24.200669 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 13:07:24.205388 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 13:07:24.209724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3798674cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3797df25b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3797df2040>]}
2021-10-06 13:07:24.214378 (MainThread): Flushing usage events
2021-10-06 13:07:34.197460 (MainThread): Running with dbt=0.19.0
2021-10-06 13:07:34.419778 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 13:07:34.432865 (MainThread): Tracking: tracking
2021-10-06 13:07:34.439642 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc771722910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc774d2a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc771733100>]}
2021-10-06 13:07:34.502126 (MainThread): Partial parsing not enabled
2021-10-06 13:07:34.516214 (MainThread): Parsing macros/Luhns.sql
2021-10-06 13:07:34.520741 (MainThread): Parsing macros/relations.sql
2021-10-06 13:07:34.526486 (MainThread): Parsing macros/adapters.sql
2021-10-06 13:07:34.555722 (MainThread): Parsing macros/catalog.sql
2021-10-06 13:07:34.560883 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 13:07:34.566148 (MainThread): Parsing macros/core.sql
2021-10-06 13:07:34.572997 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 13:07:34.616834 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 13:07:34.627922 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 13:07:34.637186 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 13:07:34.645655 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 13:07:34.666919 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 13:07:34.671483 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 13:07:34.709431 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 13:07:34.727192 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 13:07:34.753480 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 13:07:34.757890 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 13:07:34.767164 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 13:07:34.776855 (MainThread): Parsing macros/etc/query.sql
2021-10-06 13:07:34.780514 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 13:07:34.784920 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 13:07:34.796738 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 13:07:34.801364 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 13:07:34.805977 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 13:07:34.809374 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 13:07:34.813260 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 13:07:34.819076 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 13:07:34.823534 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 13:07:34.838953 (MainThread): Partial parsing not enabled
2021-10-06 13:07:34.882146 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 13:07:34.917969 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:34.943043 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 13:07:35.121586 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 13:07:35.128228 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2d87331-c244-440d-87bb-44959c772924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7715e96d0>]}
2021-10-06 13:07:35.176041 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 13:07:35.179692 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 13:07:35.183219 (MainThread): 
2021-10-06 13:07:35.188138 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:07:35.193585 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 13:07:35.214563 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 13:07:35.217597 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 13:07:35.220429 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 13:07:35.233728 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 13:07:35.248039 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 13:07:35.263759 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 13:07:35.283588 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:07:35.286466 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 13:07:35.288941 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 13:07:35.298331 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:07:35.301085 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 13:07:35.305542 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 13:07:35.312625 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 13:07:35.327206 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 13:07:35.330559 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 13:07:35.350379 (MainThread): Using postgres connection "master".
2021-10-06 13:07:35.352654 (MainThread): On master: BEGIN
2021-10-06 13:07:35.355182 (MainThread): Opening a new connection, currently in state init
2021-10-06 13:07:35.362140 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:07:35.365033 (MainThread): Using postgres connection "master".
2021-10-06 13:07:35.369255 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 13:07:35.379000 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 13:07:35.388038 (MainThread): On master: ROLLBACK
2021-10-06 13:07:35.391094 (MainThread): Using postgres connection "master".
2021-10-06 13:07:35.393959 (MainThread): On master: BEGIN
2021-10-06 13:07:35.399723 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:07:35.403693 (MainThread): On master: COMMIT
2021-10-06 13:07:35.407834 (MainThread): Using postgres connection "master".
2021-10-06 13:07:35.410376 (MainThread): On master: COMMIT
2021-10-06 13:07:35.413991 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:07:35.417650 (MainThread): On master: Close
2021-10-06 13:07:35.421671 (MainThread): 13:07:35 | Concurrency: 2 threads (target='dev')
2021-10-06 13:07:35.427062 (MainThread): 13:07:35 | 
2021-10-06 13:07:35.437193 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 13:07:35.440694 (Thread-1): 13:07:35 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 13:07:35.443033 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:35.446218 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 13:07:35.465412 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:07:35.474617 (Thread-1): finished collecting timing info
2021-10-06 13:07:35.511266 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:35.514249 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 13:07:35.516830 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 13:07:35.523398 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 13:07:35.533617 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:35.548190 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 13:07:35.557637 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 13:07:35.564714 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 13:07:35.572990 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:35.576019 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 13:07:35.578977 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 13:07:35.581991 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:35.585010 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    (creditcard::numeric % 10)
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 13:07:35.602272 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 13:07:35.612636 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:35.614631 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 13:07:35.618828 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 13:07:35.627564 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:35.630078 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 13:07:35.633434 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 13:07:35.650527 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 13:07:35.654449 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:35.657401 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 13:07:35.663896 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:07:35.669299 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 13:07:35.671274 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 13:07:35.675892 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 13:07:35.684912 (Thread-1): finished collecting timing info
2021-10-06 13:07:35.688083 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 13:07:35.694812 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d87331-c244-440d-87bb-44959c772924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc770c6efa0>]}
2021-10-06 13:07:35.700542 (Thread-1): 13:07:35 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.25s]
2021-10-06 13:07:35.702857 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 13:07:35.708970 (MainThread): Acquiring new postgres connection "master".
2021-10-06 13:07:35.712594 (MainThread): Using postgres connection "master".
2021-10-06 13:07:35.716247 (MainThread): On master: BEGIN
2021-10-06 13:07:35.719667 (MainThread): Opening a new connection, currently in state closed
2021-10-06 13:07:35.730384 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 13:07:35.734157 (MainThread): On master: COMMIT
2021-10-06 13:07:35.737827 (MainThread): Using postgres connection "master".
2021-10-06 13:07:35.740743 (MainThread): On master: COMMIT
2021-10-06 13:07:35.744410 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 13:07:35.747917 (MainThread): On master: Close
2021-10-06 13:07:35.751826 (MainThread): 13:07:35 | 
2021-10-06 13:07:35.757646 (MainThread): 13:07:35 | Finished running 1 view model in 0.56s.
2021-10-06 13:07:35.760952 (MainThread): Connection 'master' was properly closed.
2021-10-06 13:07:35.765145 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 13:07:35.825990 (MainThread): 
2021-10-06 13:07:35.828612 (MainThread): Completed successfully
2021-10-06 13:07:35.832730 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 13:07:35.838177 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7714cbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7714f14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7714f1580>]}
2021-10-06 13:07:35.841227 (MainThread): Flushing usage events
2021-10-06 13:10:55.509846 (MainThread): Running with dbt=0.19.0
2021-10-06 13:10:55.719229 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 13:10:55.730621 (MainThread): Tracking: tracking
2021-10-06 13:10:55.736527 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cae26bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb1871400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cae27c0d0>]}
2021-10-06 13:10:55.807311 (MainThread): Partial parsing not enabled
2021-10-06 13:10:55.823291 (MainThread): Parsing macros/Luhns.sql
2021-10-06 13:10:55.832143 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cae2087c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cae28d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cae28dee0>]}
2021-10-06 13:10:55.835194 (MainThread): Flushing usage events
2021-10-06 13:10:56.365794 (MainThread): Encountered an error:
2021-10-06 13:10:56.373595 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  Encountered unknown tag 'numbers'. Jinja was looking for the following tags: 'endmacro'. The innermost block that needs to be closed is 'macro'.
    line 2
      {% numbers = {{ column_name }} %}
2021-10-06 13:10:56.384510 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: Encountered unknown tag 'numbers'. Jinja was looking for the following tags: 'endmacro'. The innermost block that needs to be closed is 'macro'.
  line 2
    {% numbers = {{ column_name }} %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  Encountered unknown tag 'numbers'. Jinja was looking for the following tags: 'endmacro'. The innermost block that needs to be closed is 'macro'.
    line 2
      {% numbers = {{ column_name }} %}

2021-10-06 13:11:23.149547 (MainThread): Running with dbt=0.19.0
2021-10-06 13:11:23.348059 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 13:11:23.358523 (MainThread): Tracking: tracking
2021-10-06 13:11:23.363707 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe605c95bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6041edb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6041edfd0>]}
2021-10-06 13:11:23.412465 (MainThread): Partial parsing not enabled
2021-10-06 13:11:23.423596 (MainThread): Parsing macros/Luhns.sql
2021-10-06 13:11:23.427496 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60418c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe604212340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6042129a0>]}
2021-10-06 13:11:23.429950 (MainThread): Flushing usage events
2021-10-06 13:11:23.958538 (MainThread): Encountered an error:
2021-10-06 13:11:23.965515 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set numbers = {{ column_name }} %}
2021-10-06 13:11:23.980789 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set numbers = {{ column_name }} %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set numbers = {{ column_name }} %}

2021-10-06 13:11:46.443906 (MainThread): Running with dbt=0.19.0
2021-10-06 13:11:46.690039 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 13:11:46.698811 (MainThread): Tracking: tracking
2021-10-06 13:11:46.703069 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fab8e8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2faeeed3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fab8f8070>]}
2021-10-06 13:11:46.754415 (MainThread): Partial parsing not enabled
2021-10-06 13:11:46.770849 (MainThread): Parsing macros/Luhns.sql
2021-10-06 13:11:46.777852 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fab885760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fab90b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fab90bf70>]}
2021-10-06 13:11:46.780751 (MainThread): Flushing usage events
2021-10-06 13:11:47.302466 (MainThread): Encountered an error:
2021-10-06 13:11:47.309495 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set numbers = {{ column_name }} %}
2021-10-06 13:11:47.323493 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set numbers = {{ column_name }} %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set numbers = {{ column_name }} %}

2021-10-06 13:13:00.237727 (MainThread): Running with dbt=0.19.0
2021-10-06 13:13:00.498579 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 13:13:00.509179 (MainThread): Tracking: tracking
2021-10-06 13:13:00.513446 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc25c46910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2924d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc25c58100>]}
2021-10-06 13:13:00.547466 (MainThread): Partial parsing not enabled
2021-10-06 13:13:00.564048 (MainThread): Parsing macros/Luhns.sql
2021-10-06 13:13:00.570514 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc25be57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc25c6b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc25c6bee0>]}
2021-10-06 13:13:00.574146 (MainThread): Flushing usage events
2021-10-06 13:13:01.120794 (MainThread): Encountered an error:
2021-10-06 13:13:01.128885 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set digit = {{ column_name }}::numeric % 10 %}
2021-10-06 13:13:01.144568 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set digit = {{ column_name }}::numeric % 10 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set digit = {{ column_name }}::numeric % 10 %}

2021-10-06 14:12:22.307771 (MainThread): Running with dbt=0.19.0
2021-10-06 14:12:22.541145 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:12:22.555218 (MainThread): Tracking: tracking
2021-10-06 14:12:22.558750 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee9d98fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eed39f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee9da90a0>]}
2021-10-06 14:12:22.617752 (MainThread): Partial parsing not enabled
2021-10-06 14:12:22.634094 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:12:22.639000 (MainThread): Parsing macros/relations.sql
2021-10-06 14:12:22.645314 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:12:22.674996 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:12:22.681265 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:12:22.690984 (MainThread): Parsing macros/core.sql
2021-10-06 14:12:22.702250 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:12:22.750012 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:12:22.761031 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:12:22.770312 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:12:22.777673 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:12:22.798855 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:12:22.802971 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:12:22.837598 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:12:22.853900 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:12:22.877572 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:12:22.882223 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:12:22.890772 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:12:22.901469 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:12:22.906892 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:12:22.912074 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:12:22.923327 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:12:22.928180 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:12:22.932610 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:12:22.935734 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:12:22.939904 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:12:22.945262 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:12:22.949453 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:12:22.965126 (MainThread): Partial parsing not enabled
2021-10-06 14:12:23.009870 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:12:23.039416 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:23.074861 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:12:23.290960 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:12:23.300273 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6282cc0b-0b36-4743-ba0b-5844ba4c38fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee9c53880>]}
2021-10-06 14:12:23.373778 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:12:23.379413 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:12:23.383346 (MainThread): 
2021-10-06 14:12:23.387338 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:12:23.395054 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:12:23.420946 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:12:23.425020 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:12:23.428844 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:12:23.450565 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 14:12:23.457852 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:12:23.469129 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:12:23.484233 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:12:23.487081 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:12:23.489642 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:12:23.497903 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:12:23.502390 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:12:23.506297 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:12:23.516245 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 14:12:23.529873 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:12:23.533235 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:12:23.547138 (MainThread): Using postgres connection "master".
2021-10-06 14:12:23.549500 (MainThread): On master: BEGIN
2021-10-06 14:12:23.552076 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:12:23.562390 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:12:23.566685 (MainThread): Using postgres connection "master".
2021-10-06 14:12:23.571278 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:12:23.583319 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:12:23.591205 (MainThread): On master: ROLLBACK
2021-10-06 14:12:23.594371 (MainThread): Using postgres connection "master".
2021-10-06 14:12:23.596633 (MainThread): On master: BEGIN
2021-10-06 14:12:23.600912 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:12:23.603745 (MainThread): On master: COMMIT
2021-10-06 14:12:23.605843 (MainThread): Using postgres connection "master".
2021-10-06 14:12:23.609641 (MainThread): On master: COMMIT
2021-10-06 14:12:23.613056 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:12:23.615719 (MainThread): On master: Close
2021-10-06 14:12:23.619828 (MainThread): 14:12:23 | Concurrency: 2 threads (target='dev')
2021-10-06 14:12:23.622985 (MainThread): 14:12:23 | 
2021-10-06 14:12:23.633310 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:12:23.641091 (Thread-1): 14:12:23 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:12:23.647456 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:23.651018 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:12:23.675196 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:12:23.687637 (Thread-1): finished collecting timing info
2021-10-06 14:12:23.721470 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:23.724211 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:12:23.726914 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:12:23.738371 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:12:23.753186 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:23.756349 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:12:23.760126 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:12:23.774115 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:12:23.793794 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:23.797359 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:12:23.802413 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:12:23.806864 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:23.811767 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard::numeric /10
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:12:23.837689 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-06 14:12:23.856308 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:23.858963 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 14:12:23.862789 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:12:23.867398 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:23.870083 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 14:12:23.873205 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:12:23.888235 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:12:23.891978 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:23.894867 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:12:23.902047 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:12:23.910223 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:23.913852 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:12:23.923371 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:12:23.929350 (Thread-1): finished collecting timing info
2021-10-06 14:12:23.932075 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:12:23.935494 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6282cc0b-0b36-4743-ba0b-5844ba4c38fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee9d14280>]}
2021-10-06 14:12:23.942222 (Thread-1): 14:12:23 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.29s]
2021-10-06 14:12:23.946302 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:12:23.952681 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:12:23.955269 (MainThread): Using postgres connection "master".
2021-10-06 14:12:23.957966 (MainThread): On master: BEGIN
2021-10-06 14:12:23.960676 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:12:23.969473 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:12:23.973898 (MainThread): On master: COMMIT
2021-10-06 14:12:23.976168 (MainThread): Using postgres connection "master".
2021-10-06 14:12:23.978939 (MainThread): On master: COMMIT
2021-10-06 14:12:23.982678 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:12:23.985207 (MainThread): On master: Close
2021-10-06 14:12:23.989318 (MainThread): 14:12:23 | 
2021-10-06 14:12:23.992076 (MainThread): 14:12:23 | Finished running 1 view model in 0.60s.
2021-10-06 14:12:23.998690 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:12:24.004215 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:12:24.083766 (MainThread): 
2021-10-06 14:12:24.086907 (MainThread): Completed successfully
2021-10-06 14:12:24.090644 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 14:12:24.098045 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee9b3ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee82a57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee82a5850>]}
2021-10-06 14:12:24.105866 (MainThread): Flushing usage events
2021-10-06 14:12:36.624055 (MainThread): Running with dbt=0.19.0
2021-10-06 14:12:36.818448 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:12:36.827885 (MainThread): Tracking: tracking
2021-10-06 14:12:36.831311 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828b51fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828cf4b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828b5301f0>]}
2021-10-06 14:12:36.860121 (MainThread): Partial parsing not enabled
2021-10-06 14:12:36.872795 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:12:36.876957 (MainThread): Parsing macros/relations.sql
2021-10-06 14:12:36.881383 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:12:36.904506 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:12:36.910764 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:12:36.918840 (MainThread): Parsing macros/core.sql
2021-10-06 14:12:36.932619 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:12:36.988996 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:12:37.000183 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:12:37.010377 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:12:37.018750 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:12:37.039614 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:12:37.044425 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:12:37.081989 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:12:37.097943 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:12:37.120669 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:12:37.125207 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:12:37.133813 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:12:37.151459 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:12:37.154932 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:12:37.158557 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:12:37.169998 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:12:37.174184 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:12:37.181985 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:12:37.187694 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:12:37.192005 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:12:37.197191 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:12:37.201469 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:12:37.216891 (MainThread): Partial parsing not enabled
2021-10-06 14:12:37.257827 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:12:37.287217 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:37.310010 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:12:37.522208 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:12:37.539019 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c18b6a-2113-4003-85ba-e5b9f3e11b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828b3dbd30>]}
2021-10-06 14:12:37.598395 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:12:37.602198 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:12:37.608877 (MainThread): 
2021-10-06 14:12:37.615161 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:12:37.621260 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:12:37.653791 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:12:37.657947 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:12:37.660731 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:12:37.671841 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:12:37.678056 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:12:37.690954 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:12:37.699996 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:12:37.702068 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:12:37.704017 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:12:37.711465 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:12:37.714315 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:12:37.716387 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:12:37.721004 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:12:37.736336 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:12:37.739246 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:12:37.750059 (MainThread): Using postgres connection "master".
2021-10-06 14:12:37.752091 (MainThread): On master: BEGIN
2021-10-06 14:12:37.754112 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:12:37.761924 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:12:37.764975 (MainThread): Using postgres connection "master".
2021-10-06 14:12:37.767255 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:12:37.779049 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:12:37.784295 (MainThread): On master: ROLLBACK
2021-10-06 14:12:37.787851 (MainThread): Using postgres connection "master".
2021-10-06 14:12:37.790488 (MainThread): On master: BEGIN
2021-10-06 14:12:37.796311 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:12:37.799752 (MainThread): On master: COMMIT
2021-10-06 14:12:37.803223 (MainThread): Using postgres connection "master".
2021-10-06 14:12:37.805829 (MainThread): On master: COMMIT
2021-10-06 14:12:37.808442 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:12:37.811228 (MainThread): On master: Close
2021-10-06 14:12:37.815373 (MainThread): 14:12:37 | Concurrency: 2 threads (target='dev')
2021-10-06 14:12:37.818396 (MainThread): 14:12:37 | 
2021-10-06 14:12:37.827252 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:12:37.832614 (Thread-1): 14:12:37 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:12:37.837298 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:37.840273 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:12:37.858790 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:12:37.867290 (Thread-1): finished collecting timing info
2021-10-06 14:12:37.901001 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:37.903359 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:12:37.906521 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:12:37.915465 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:12:37.922469 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:37.924983 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:12:37.928299 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:12:37.941062 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:12:37.954243 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:37.956882 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:12:37.962538 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:12:37.965863 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:12:37.970047 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard::numeric // 10
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:12:37.975251 (Thread-1): Postgres error: operator does not exist: numeric // integer
LINE 5:     creditcard::numeric // 10
                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2021-10-06 14:12:37.979322 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 14:12:37.986370 (Thread-1): finished collecting timing info
2021-10-06 14:12:37.989519 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:12:37.992861 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: numeric // integer
  LINE 5:     creditcard::numeric // 10
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: operator does not exist: numeric // integer
LINE 5:     creditcard::numeric // 10
                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: numeric // integer
  LINE 5:     creditcard::numeric // 10
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:12:38.004390 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c18b6a-2113-4003-85ba-e5b9f3e11b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828b40cfd0>]}
2021-10-06 14:12:38.010220 (Thread-1): 14:12:38 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.17s]
2021-10-06 14:12:38.014766 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:12:38.024181 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:12:38.028004 (MainThread): Using postgres connection "master".
2021-10-06 14:12:38.030319 (MainThread): On master: BEGIN
2021-10-06 14:12:38.032735 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:12:38.043750 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:12:38.047517 (MainThread): On master: COMMIT
2021-10-06 14:12:38.051136 (MainThread): Using postgres connection "master".
2021-10-06 14:12:38.055483 (MainThread): On master: COMMIT
2021-10-06 14:12:38.062082 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:12:38.065052 (MainThread): On master: Close
2021-10-06 14:12:38.071081 (MainThread): 14:12:38 | 
2021-10-06 14:12:38.074828 (MainThread): 14:12:38 | Finished running 1 view model in 0.46s.
2021-10-06 14:12:38.088149 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:12:38.092449 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:12:38.135180 (MainThread): 
2021-10-06 14:12:38.139398 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 14:12:38.142712 (MainThread): 
2021-10-06 14:12:38.149278 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 14:12:38.155045 (MainThread):   operator does not exist: numeric // integer
2021-10-06 14:12:38.158152 (MainThread):   LINE 5:     creditcard::numeric // 10
2021-10-06 14:12:38.162323 (MainThread):                                   ^
2021-10-06 14:12:38.166728 (MainThread):   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2021-10-06 14:12:38.170864 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:12:38.174096 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 14:12:38.178926 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8288a065b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828b37d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828b3f3730>]}
2021-10-06 14:12:38.182928 (MainThread): Flushing usage events
2021-10-06 14:15:44.296540 (MainThread): Running with dbt=0.19.0
2021-10-06 14:15:44.609152 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:15:44.622628 (MainThread): Tracking: tracking
2021-10-06 14:15:44.630539 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8df13940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9151a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8df24130>]}
2021-10-06 14:15:44.671974 (MainThread): Partial parsing not enabled
2021-10-06 14:15:44.683876 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:15:44.687674 (MainThread): Parsing macros/relations.sql
2021-10-06 14:15:44.692403 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:15:44.727373 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:15:44.734785 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:15:44.741602 (MainThread): Parsing macros/core.sql
2021-10-06 14:15:44.748349 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:15:44.798574 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:15:44.810044 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:15:44.818586 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:15:44.826052 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:15:44.846228 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:15:44.850846 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:15:44.890213 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:15:44.906752 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:15:44.931789 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:15:44.936959 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:15:44.946228 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:15:44.955325 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:15:44.958742 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:15:44.963879 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:15:44.974956 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:15:44.981950 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:15:44.987753 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:15:44.991092 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:15:44.995029 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:15:45.000592 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:15:45.008233 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:15:45.038714 (MainThread): Partial parsing not enabled
2021-10-06 14:15:45.125880 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:15:45.163951 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:15:45.190993 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:15:45.446557 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:15:45.453897 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3320d4c5-a444-4976-9aab-5e76515fd85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8ddb1190>]}
2021-10-06 14:15:45.520087 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:15:45.524319 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:15:45.528079 (MainThread): 
2021-10-06 14:15:45.531932 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:15:45.540816 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:15:45.564406 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:15:45.567192 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:15:45.571383 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:15:45.589271 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 14:15:45.595219 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:15:45.609947 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:15:45.627353 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:15:45.630728 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:15:45.633189 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:15:45.646961 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:15:45.650608 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:15:45.653515 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:15:45.663719 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 14:15:45.685467 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:15:45.690894 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:15:45.708382 (MainThread): Using postgres connection "master".
2021-10-06 14:15:45.711084 (MainThread): On master: BEGIN
2021-10-06 14:15:45.713572 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:15:45.726776 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:15:45.729765 (MainThread): Using postgres connection "master".
2021-10-06 14:15:45.732826 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:15:45.746115 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:15:45.752567 (MainThread): On master: ROLLBACK
2021-10-06 14:15:45.757189 (MainThread): Using postgres connection "master".
2021-10-06 14:15:45.760073 (MainThread): On master: BEGIN
2021-10-06 14:15:45.763994 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:15:45.767504 (MainThread): On master: COMMIT
2021-10-06 14:15:45.772113 (MainThread): Using postgres connection "master".
2021-10-06 14:15:45.775063 (MainThread): On master: COMMIT
2021-10-06 14:15:45.778384 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:15:45.782374 (MainThread): On master: Close
2021-10-06 14:15:45.786267 (MainThread): 14:15:45 | Concurrency: 2 threads (target='dev')
2021-10-06 14:15:45.791346 (MainThread): 14:15:45 | 
2021-10-06 14:15:45.801275 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:15:45.806844 (Thread-1): 14:15:45 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:15:45.812863 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:15:45.816837 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:15:45.839787 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:15:45.848568 (Thread-1): finished collecting timing info
2021-10-06 14:15:45.886424 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:15:45.889906 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:15:45.893321 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:15:45.906086 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:15:45.913797 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:15:45.916176 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:15:45.920012 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:15:45.927300 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:15:45.937983 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:15:45.941152 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:15:45.945015 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:15:45.948228 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:15:45.952181 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard::numeric // 10.0
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:15:45.958560 (Thread-1): Postgres error: operator does not exist: numeric // numeric
LINE 5:     creditcard::numeric // 10.0
                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2021-10-06 14:15:45.962707 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 14:15:45.969953 (Thread-1): finished collecting timing info
2021-10-06 14:15:45.975902 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:15:45.978848 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: numeric // numeric
  LINE 5:     creditcard::numeric // 10.0
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: operator does not exist: numeric // numeric
LINE 5:     creditcard::numeric // 10.0
                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: numeric // numeric
  LINE 5:     creditcard::numeric // 10.0
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:15:45.986241 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3320d4c5-a444-4976-9aab-5e76515fd85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8de09580>]}
2021-10-06 14:15:45.990959 (Thread-1): 14:15:45 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.18s]
2021-10-06 14:15:45.993346 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:15:45.998619 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:15:46.002202 (MainThread): Using postgres connection "master".
2021-10-06 14:15:46.005185 (MainThread): On master: BEGIN
2021-10-06 14:15:46.008020 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:15:46.014437 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:15:46.017394 (MainThread): On master: COMMIT
2021-10-06 14:15:46.020397 (MainThread): Using postgres connection "master".
2021-10-06 14:15:46.024016 (MainThread): On master: COMMIT
2021-10-06 14:15:46.026500 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:15:46.028746 (MainThread): On master: Close
2021-10-06 14:15:46.031906 (MainThread): 14:15:46 | 
2021-10-06 14:15:46.034159 (MainThread): 14:15:46 | Finished running 1 view model in 0.50s.
2021-10-06 14:15:46.037660 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:15:46.042193 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:15:46.088368 (MainThread): 
2021-10-06 14:15:46.092519 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 14:15:46.096092 (MainThread): 
2021-10-06 14:15:46.099786 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 14:15:46.103082 (MainThread):   operator does not exist: numeric // numeric
2021-10-06 14:15:46.109981 (MainThread):   LINE 5:     creditcard::numeric // 10.0
2021-10-06 14:15:46.114799 (MainThread):                                   ^
2021-10-06 14:15:46.118929 (MainThread):   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2021-10-06 14:15:46.124478 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:15:46.130331 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 14:15:46.133866 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8ddcf070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8ddf8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8ddf82e0>]}
2021-10-06 14:15:46.139133 (MainThread): Flushing usage events
2021-10-06 14:16:39.245914 (MainThread): Running with dbt=0.19.0
2021-10-06 14:16:39.495023 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:16:39.510343 (MainThread): Tracking: tracking
2021-10-06 14:16:39.516508 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2837ae19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f283958d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2837af3190>]}
2021-10-06 14:16:39.597137 (MainThread): Partial parsing not enabled
2021-10-06 14:16:39.607881 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:16:39.612303 (MainThread): Parsing macros/relations.sql
2021-10-06 14:16:39.618234 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:16:39.645141 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:16:39.650630 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:16:39.655329 (MainThread): Parsing macros/core.sql
2021-10-06 14:16:39.661664 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:16:39.707537 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:16:39.719807 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:16:39.728407 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:16:39.735750 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:16:39.756354 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:16:39.762015 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:16:39.794009 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:16:39.809937 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:16:39.832082 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:16:39.836142 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:16:39.844211 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:16:39.852954 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:16:39.856739 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:16:39.861217 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:16:39.872204 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:16:39.876968 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:16:39.882035 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:16:39.885555 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:16:39.889614 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:16:39.895109 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:16:39.899698 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:16:39.913838 (MainThread): Partial parsing not enabled
2021-10-06 14:16:39.953721 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:16:39.982723 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:16:40.010745 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:16:40.235342 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:16:40.245383 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1a3a18d-9e7f-438e-aad0-6f0b42725dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f283799ed60>]}
2021-10-06 14:16:40.307020 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:16:40.310923 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:16:40.315165 (MainThread): 
2021-10-06 14:16:40.318896 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:16:40.326191 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:16:40.348383 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:16:40.351979 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:16:40.354940 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:16:40.364380 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:16:40.371367 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:16:40.383117 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:16:40.391408 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:16:40.393684 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:16:40.395863 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:16:40.402608 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:16:40.405188 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:16:40.407387 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:16:40.413744 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:16:40.426319 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:16:40.430059 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:16:40.446541 (MainThread): Using postgres connection "master".
2021-10-06 14:16:40.448906 (MainThread): On master: BEGIN
2021-10-06 14:16:40.450934 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:16:40.459944 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:16:40.462717 (MainThread): Using postgres connection "master".
2021-10-06 14:16:40.466617 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:16:40.475142 (MainThread): SQL status: SELECT 2 in 0.00 seconds
2021-10-06 14:16:40.481450 (MainThread): On master: ROLLBACK
2021-10-06 14:16:40.484270 (MainThread): Using postgres connection "master".
2021-10-06 14:16:40.487275 (MainThread): On master: BEGIN
2021-10-06 14:16:40.491660 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:16:40.495964 (MainThread): On master: COMMIT
2021-10-06 14:16:40.500565 (MainThread): Using postgres connection "master".
2021-10-06 14:16:40.503304 (MainThread): On master: COMMIT
2021-10-06 14:16:40.507310 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:16:40.510253 (MainThread): On master: Close
2021-10-06 14:16:40.514124 (MainThread): 14:16:40 | Concurrency: 2 threads (target='dev')
2021-10-06 14:16:40.516886 (MainThread): 14:16:40 | 
2021-10-06 14:16:40.532047 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:16:40.545290 (Thread-1): 14:16:40 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:16:40.551844 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:16:40.555705 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:16:40.573184 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:16:40.582893 (Thread-1): finished collecting timing info
2021-10-06 14:16:40.624595 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:16:40.627127 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:16:40.630586 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:16:40.642879 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:16:40.648222 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:16:40.650135 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:16:40.653299 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:16:40.660369 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:16:40.667932 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:16:40.671543 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:16:40.674221 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:16:40.676805 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:16:40.679899 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard::numeric / 10::numeric
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:16:40.701344 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-06 14:16:40.722079 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:16:40.726121 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 14:16:40.733804 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:16:40.741019 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:16:40.743924 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 14:16:40.747118 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:16:40.758068 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:16:40.761218 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:16:40.764113 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:16:40.773702 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-06 14:16:40.780874 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:16:40.783421 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:16:40.789386 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:16:40.794599 (Thread-1): finished collecting timing info
2021-10-06 14:16:40.797096 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:16:40.799906 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a3a18d-9e7f-438e-aad0-6f0b42725dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2837940400>]}
2021-10-06 14:16:40.803311 (Thread-1): 14:16:40 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.25s]
2021-10-06 14:16:40.806802 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:16:40.812072 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:16:40.815241 (MainThread): Using postgres connection "master".
2021-10-06 14:16:40.817083 (MainThread): On master: BEGIN
2021-10-06 14:16:40.819150 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:16:40.826964 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:16:40.830043 (MainThread): On master: COMMIT
2021-10-06 14:16:40.833300 (MainThread): Using postgres connection "master".
2021-10-06 14:16:40.836183 (MainThread): On master: COMMIT
2021-10-06 14:16:40.839967 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:16:40.842363 (MainThread): On master: Close
2021-10-06 14:16:40.845698 (MainThread): 14:16:40 | 
2021-10-06 14:16:40.848223 (MainThread): 14:16:40 | Finished running 1 view model in 0.53s.
2021-10-06 14:16:40.851602 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:16:40.856358 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:16:40.905066 (MainThread): 
2021-10-06 14:16:40.908087 (MainThread): Completed successfully
2021-10-06 14:16:40.911637 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 14:16:40.919618 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2837a22f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2837909d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2834ffc820>]}
2021-10-06 14:16:40.924224 (MainThread): Flushing usage events
2021-10-06 14:17:23.453529 (MainThread): Running with dbt=0.19.0
2021-10-06 14:17:23.734288 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:17:23.747902 (MainThread): Tracking: tracking
2021-10-06 14:17:23.753649 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb57f0d7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5826df430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb57f0e8100>]}
2021-10-06 14:17:23.806974 (MainThread): Partial parsing not enabled
2021-10-06 14:17:23.820028 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:17:23.827904 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb57f0767f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb57f0fc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb57f0fceb0>]}
2021-10-06 14:17:23.831580 (MainThread): Flushing usage events
2021-10-06 14:17:25.382496 (MainThread): Encountered an error:
2021-10-06 14:17:25.388742 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set cn = {{ column_name }}::numeric / 10::numeric %}
2021-10-06 14:17:25.410090 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set cn = {{ column_name }}::numeric / 10::numeric %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set cn = {{ column_name }}::numeric / 10::numeric %}

2021-10-06 14:21:01.899107 (MainThread): Running with dbt=0.19.0
2021-10-06 14:21:02.169371 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:21:02.184475 (MainThread): Tracking: tracking
2021-10-06 14:21:02.191696 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450ca9c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450e5472b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450caae190>]}
2021-10-06 14:21:02.247241 (MainThread): Partial parsing not enabled
2021-10-06 14:21:02.261816 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:21:02.265948 (MainThread): Parsing macros/relations.sql
2021-10-06 14:21:02.270649 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:21:02.295861 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:21:02.300995 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:21:02.307399 (MainThread): Parsing macros/core.sql
2021-10-06 14:21:02.315033 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:21:02.369915 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:21:02.382785 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:21:02.392088 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:21:02.401254 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:21:02.425458 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:21:02.430868 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:21:02.466391 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:21:02.485147 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:21:02.509902 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:21:02.514324 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:21:02.522471 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:21:02.530964 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:21:02.534701 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:21:02.538857 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:21:02.551927 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:21:02.556398 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:21:02.560992 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:21:02.564237 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:21:02.568174 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:21:02.576000 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:21:02.582680 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:21:02.612116 (MainThread): Partial parsing not enabled
2021-10-06 14:21:02.674898 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:21:02.711804 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:02.740026 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:21:02.964116 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:21:02.975419 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efb4c0b9-cba0-4786-8d2b-64e85381285e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450c963100>]}
2021-10-06 14:21:03.043269 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:21:03.048174 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:21:03.051953 (MainThread): 
2021-10-06 14:21:03.056300 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:21:03.068404 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:21:03.092606 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:21:03.096120 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:21:03.098772 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:21:03.129107 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.03 seconds
2021-10-06 14:21:03.139136 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:21:03.153128 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:21:03.162010 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:21:03.164210 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:21:03.166365 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:21:03.174897 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:21:03.180676 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:21:03.184918 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:21:03.198953 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 14:21:03.223030 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:21:03.227455 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:21:03.247941 (MainThread): Using postgres connection "master".
2021-10-06 14:21:03.252589 (MainThread): On master: BEGIN
2021-10-06 14:21:03.254730 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:21:03.263387 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:21:03.267025 (MainThread): Using postgres connection "master".
2021-10-06 14:21:03.270922 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:21:03.283340 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:21:03.291880 (MainThread): On master: ROLLBACK
2021-10-06 14:21:03.294942 (MainThread): Using postgres connection "master".
2021-10-06 14:21:03.296997 (MainThread): On master: BEGIN
2021-10-06 14:21:03.299980 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:21:03.303822 (MainThread): On master: COMMIT
2021-10-06 14:21:03.306853 (MainThread): Using postgres connection "master".
2021-10-06 14:21:03.310670 (MainThread): On master: COMMIT
2021-10-06 14:21:03.313411 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:21:03.315509 (MainThread): On master: Close
2021-10-06 14:21:03.320738 (MainThread): 14:21:03 | Concurrency: 2 threads (target='dev')
2021-10-06 14:21:03.323265 (MainThread): 14:21:03 | 
2021-10-06 14:21:03.332125 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:21:03.338331 (Thread-1): 14:21:03 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:21:03.341262 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:03.344495 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:21:03.363838 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:21:03.376315 (Thread-1): finished collecting timing info
2021-10-06 14:21:03.413925 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:03.416476 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:21:03.419747 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:21:03.433291 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:21:03.450870 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:03.454744 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:21:03.463437 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:21:03.478390 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:21:03.492725 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:03.496976 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:21:03.501031 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:21:03.506483 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:03.511077 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard::numeric // 10::numeric
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:21:03.521698 (Thread-1): Postgres error: operator does not exist: numeric // numeric
LINE 5:     creditcard::numeric // 10::numeric
                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2021-10-06 14:21:03.525499 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 14:21:03.529852 (Thread-1): finished collecting timing info
2021-10-06 14:21:03.533962 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:21:03.538851 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: numeric // numeric
  LINE 5:     creditcard::numeric // 10::numeric
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: operator does not exist: numeric // numeric
LINE 5:     creditcard::numeric // 10::numeric
                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: numeric // numeric
  LINE 5:     creditcard::numeric // 10::numeric
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:21:03.546245 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb4c0b9-cba0-4786-8d2b-64e85381285e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4507fe7cd0>]}
2021-10-06 14:21:03.550276 (Thread-1): 14:21:03 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.21s]
2021-10-06 14:21:03.552196 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:21:03.557184 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:21:03.559928 (MainThread): Using postgres connection "master".
2021-10-06 14:21:03.563126 (MainThread): On master: BEGIN
2021-10-06 14:21:03.564951 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:21:03.574338 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:21:03.577659 (MainThread): On master: COMMIT
2021-10-06 14:21:03.581012 (MainThread): Using postgres connection "master".
2021-10-06 14:21:03.588472 (MainThread): On master: COMMIT
2021-10-06 14:21:03.592017 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:21:03.595508 (MainThread): On master: Close
2021-10-06 14:21:03.599451 (MainThread): 14:21:03 | 
2021-10-06 14:21:03.603157 (MainThread): 14:21:03 | Finished running 1 view model in 0.54s.
2021-10-06 14:21:03.607929 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:21:03.615262 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:21:03.669577 (MainThread): 
2021-10-06 14:21:03.672148 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 14:21:03.675234 (MainThread): 
2021-10-06 14:21:03.678865 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 14:21:03.683498 (MainThread):   operator does not exist: numeric // numeric
2021-10-06 14:21:03.688502 (MainThread):   LINE 5:     creditcard::numeric // 10::numeric
2021-10-06 14:21:03.691697 (MainThread):                                   ^
2021-10-06 14:21:03.694660 (MainThread):   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2021-10-06 14:21:03.697441 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:21:03.700836 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 14:21:03.707190 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450c843d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450c97d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450c97d430>]}
2021-10-06 14:21:03.710241 (MainThread): Flushing usage events
2021-10-06 14:21:13.249666 (MainThread): Running with dbt=0.19.0
2021-10-06 14:21:13.465002 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:21:13.477121 (MainThread): Tracking: tracking
2021-10-06 14:21:13.482715 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed89151970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8abfc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed89162160>]}
2021-10-06 14:21:13.560425 (MainThread): Partial parsing not enabled
2021-10-06 14:21:13.570763 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:21:13.575402 (MainThread): Parsing macros/relations.sql
2021-10-06 14:21:13.582594 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:21:13.610768 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:21:13.617457 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:21:13.623004 (MainThread): Parsing macros/core.sql
2021-10-06 14:21:13.630441 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:21:13.683567 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:21:13.696880 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:21:13.705888 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:21:13.721586 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:21:13.743616 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:21:13.747748 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:21:13.782322 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:21:13.801295 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:21:13.826235 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:21:13.832572 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:21:13.841606 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:21:13.851333 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:21:13.855207 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:21:13.860098 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:21:13.874012 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:21:13.878822 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:21:13.883234 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:21:13.886701 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:21:13.890415 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:21:13.895817 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:21:13.900536 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:21:13.917685 (MainThread): Partial parsing not enabled
2021-10-06 14:21:13.961285 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:21:13.994321 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:14.034288 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:21:14.288708 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:21:14.305759 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '032fee14-3e11-45fe-ab01-3de3a59b7e5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed890342b0>]}
2021-10-06 14:21:14.372877 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:21:14.380661 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:21:14.386263 (MainThread): 
2021-10-06 14:21:14.391361 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:21:14.400793 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:21:14.432632 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:21:14.438070 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:21:14.445992 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:21:14.464943 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 14:21:14.483111 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:21:14.502116 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:21:14.522161 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:21:14.525499 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:21:14.529939 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:21:14.556753 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2021-10-06 14:21:14.562473 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:21:14.569857 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:21:14.579029 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 14:21:14.597614 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:21:14.603078 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:21:14.631760 (MainThread): Using postgres connection "master".
2021-10-06 14:21:14.634718 (MainThread): On master: BEGIN
2021-10-06 14:21:14.638134 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:21:14.652873 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:21:14.657533 (MainThread): Using postgres connection "master".
2021-10-06 14:21:14.663743 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:21:14.684674 (MainThread): SQL status: SELECT 2 in 0.02 seconds
2021-10-06 14:21:14.696365 (MainThread): On master: ROLLBACK
2021-10-06 14:21:14.700600 (MainThread): Using postgres connection "master".
2021-10-06 14:21:14.705846 (MainThread): On master: BEGIN
2021-10-06 14:21:14.712545 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:21:14.721011 (MainThread): On master: COMMIT
2021-10-06 14:21:14.727661 (MainThread): Using postgres connection "master".
2021-10-06 14:21:14.733444 (MainThread): On master: COMMIT
2021-10-06 14:21:14.738453 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:21:14.742193 (MainThread): On master: Close
2021-10-06 14:21:14.748907 (MainThread): 14:21:14 | Concurrency: 2 threads (target='dev')
2021-10-06 14:21:14.758609 (MainThread): 14:21:14 | 
2021-10-06 14:21:14.787460 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:21:14.792041 (Thread-1): 14:21:14 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:21:14.796069 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:14.800361 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:21:14.835182 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:21:14.845133 (Thread-1): finished collecting timing info
2021-10-06 14:21:14.896150 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:14.898659 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:21:14.901022 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:21:14.912515 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:21:14.919825 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:14.923910 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:21:14.928468 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:21:14.942536 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:21:14.958990 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:14.961743 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:21:14.964376 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:21:14.968935 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:14.974437 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard::numeric / 10::numeric
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:21:15.010170 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2021-10-06 14:21:15.039075 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:15.042896 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 14:21:15.048263 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:21:15.058289 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:15.061551 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 14:21:15.064938 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:21:15.095196 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:21:15.098447 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:15.101447 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:21:15.109388 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-06 14:21:15.116737 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:21:15.119844 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:21:15.126860 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:21:15.135117 (Thread-1): finished collecting timing info
2021-10-06 14:21:15.145993 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:21:15.153450 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '032fee14-3e11-45fe-ab01-3de3a59b7e5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8865edc0>]}
2021-10-06 14:21:15.157933 (Thread-1): 14:21:15 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.36s]
2021-10-06 14:21:15.162354 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:21:15.168588 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:21:15.172739 (MainThread): Using postgres connection "master".
2021-10-06 14:21:15.175895 (MainThread): On master: BEGIN
2021-10-06 14:21:15.179780 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:21:15.188743 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:21:15.192027 (MainThread): On master: COMMIT
2021-10-06 14:21:15.195079 (MainThread): Using postgres connection "master".
2021-10-06 14:21:15.198504 (MainThread): On master: COMMIT
2021-10-06 14:21:15.201360 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:21:15.203984 (MainThread): On master: Close
2021-10-06 14:21:15.207487 (MainThread): 14:21:15 | 
2021-10-06 14:21:15.211885 (MainThread): 14:21:15 | Finished running 1 view model in 0.82s.
2021-10-06 14:21:15.216069 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:21:15.227585 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:21:15.290558 (MainThread): 
2021-10-06 14:21:15.293712 (MainThread): Completed successfully
2021-10-06 14:21:15.299275 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 14:21:15.308186 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed89040700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8866f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8866f370>]}
2021-10-06 14:21:15.319657 (MainThread): Flushing usage events
2021-10-06 14:24:43.187956 (MainThread): Running with dbt=0.19.0
2021-10-06 14:24:43.435247 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:24:43.450071 (MainThread): Tracking: tracking
2021-10-06 14:24:43.462493 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d46ff940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d7d07460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d4710130>]}
2021-10-06 14:24:43.537901 (MainThread): Partial parsing not enabled
2021-10-06 14:24:43.554348 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:24:43.561145 (MainThread): Parsing macros/relations.sql
2021-10-06 14:24:43.569307 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:24:43.603018 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:24:43.611914 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:24:43.622018 (MainThread): Parsing macros/core.sql
2021-10-06 14:24:43.629765 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:24:43.705973 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:24:43.725304 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:24:43.738273 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:24:43.747644 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:24:43.775088 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:24:43.780330 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:24:43.826330 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:24:43.855383 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:24:43.888019 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:24:43.892721 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:24:43.903490 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:24:43.920872 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:24:43.926167 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:24:43.932370 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:24:43.949864 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:24:43.958123 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:24:43.965329 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:24:43.973715 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:24:43.981430 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:24:43.987707 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:24:43.992964 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:24:44.013383 (MainThread): Partial parsing not enabled
2021-10-06 14:24:44.073293 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:24:44.116406 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:24:44.151837 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:24:44.394179 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:24:44.401073 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59230feb-6b19-4709-b0d8-92ea65878f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d45a03d0>]}
2021-10-06 14:24:44.474465 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:24:44.480793 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:24:44.486052 (MainThread): 
2021-10-06 14:24:44.489257 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:24:44.496425 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:24:44.523281 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:24:44.525968 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:24:44.529756 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:24:44.549256 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 14:24:44.557504 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:24:44.573495 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:24:44.590163 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:24:44.593799 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:24:44.596797 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:24:44.607293 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:24:44.611331 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:24:44.616387 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:24:44.624483 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:24:44.638777 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:24:44.642115 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:24:44.660318 (MainThread): Using postgres connection "master".
2021-10-06 14:24:44.663258 (MainThread): On master: BEGIN
2021-10-06 14:24:44.666858 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:24:44.678910 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:24:44.682349 (MainThread): Using postgres connection "master".
2021-10-06 14:24:44.686637 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:24:44.697040 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:24:44.704322 (MainThread): On master: ROLLBACK
2021-10-06 14:24:44.707163 (MainThread): Using postgres connection "master".
2021-10-06 14:24:44.709494 (MainThread): On master: BEGIN
2021-10-06 14:24:44.713430 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:24:44.717941 (MainThread): On master: COMMIT
2021-10-06 14:24:44.722826 (MainThread): Using postgres connection "master".
2021-10-06 14:24:44.725128 (MainThread): On master: COMMIT
2021-10-06 14:24:44.728164 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:24:44.730257 (MainThread): On master: Close
2021-10-06 14:24:44.734038 (MainThread): 14:24:44 | Concurrency: 2 threads (target='dev')
2021-10-06 14:24:44.737126 (MainThread): 14:24:44 | 
2021-10-06 14:24:44.751318 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:24:44.758001 (Thread-1): 14:24:44 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:24:44.761257 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:24:44.765560 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:24:44.787389 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:24:44.796280 (Thread-1): finished collecting timing info
2021-10-06 14:24:44.830212 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:24:44.833037 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:24:44.835127 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:24:44.842410 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:24:44.847133 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:24:44.849332 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:24:44.852866 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:24:44.859633 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:24:44.868788 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:24:44.871698 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:24:44.875594 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:24:44.878486 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:24:44.883137 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    cn = creditcard::numeric / 10::numeric
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:24:44.889012 (Thread-1): Postgres error: column "cn" does not exist
LINE 5:     cn = creditcard::numeric / 10::numeric
            ^

2021-10-06 14:24:44.892395 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 14:24:44.896072 (Thread-1): finished collecting timing info
2021-10-06 14:24:44.900011 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:24:44.904171 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  column "cn" does not exist
  LINE 5:     cn = creditcard::numeric / 10::numeric
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "cn" does not exist
LINE 5:     cn = creditcard::numeric / 10::numeric
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  column "cn" does not exist
  LINE 5:     cn = creditcard::numeric / 10::numeric
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:24:44.911402 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59230feb-6b19-4709-b0d8-92ea65878f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d44d7bb0>]}
2021-10-06 14:24:44.917240 (Thread-1): 14:24:44 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.15s]
2021-10-06 14:24:44.920379 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:24:44.926393 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:24:44.928926 (MainThread): Using postgres connection "master".
2021-10-06 14:24:44.931111 (MainThread): On master: BEGIN
2021-10-06 14:24:44.933192 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:24:44.942007 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:24:44.944950 (MainThread): On master: COMMIT
2021-10-06 14:24:44.947571 (MainThread): Using postgres connection "master".
2021-10-06 14:24:44.950767 (MainThread): On master: COMMIT
2021-10-06 14:24:44.954071 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:24:44.957820 (MainThread): On master: Close
2021-10-06 14:24:44.960386 (MainThread): 14:24:44 | 
2021-10-06 14:24:44.963196 (MainThread): 14:24:44 | Finished running 1 view model in 0.47s.
2021-10-06 14:24:44.967140 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:24:44.972107 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:24:45.047312 (MainThread): 
2021-10-06 14:24:45.052482 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 14:24:45.057276 (MainThread): 
2021-10-06 14:24:45.063071 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 14:24:45.071280 (MainThread):   column "cn" does not exist
2021-10-06 14:24:45.076646 (MainThread):   LINE 5:     cn = creditcard::numeric / 10::numeric
2021-10-06 14:24:45.079984 (MainThread):               ^
2021-10-06 14:24:45.084384 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:24:45.088117 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 14:24:45.093197 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d45bca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d3c2f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d3c2f490>]}
2021-10-06 14:24:45.098141 (MainThread): Flushing usage events
2021-10-06 14:29:21.552491 (MainThread): Running with dbt=0.19.0
2021-10-06 14:29:21.793474 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:29:21.809483 (MainThread): Tracking: tracking
2021-10-06 14:29:21.819068 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61553a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd618b42460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61554c130>]}
2021-10-06 14:29:21.869843 (MainThread): Partial parsing not enabled
2021-10-06 14:29:21.881777 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:29:21.885170 (MainThread): Parsing macros/relations.sql
2021-10-06 14:29:21.891649 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:29:21.921243 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:29:21.931295 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:29:21.940305 (MainThread): Parsing macros/core.sql
2021-10-06 14:29:21.947290 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:29:21.989545 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:29:22.001258 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:29:22.010948 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:29:22.021865 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:29:22.050217 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:29:22.056724 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:29:22.092924 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:29:22.108593 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:29:22.132128 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:29:22.136720 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:29:22.146418 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:29:22.163808 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:29:22.177443 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:29:22.181833 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:29:22.192760 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:29:22.197649 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:29:22.203543 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:29:22.208453 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:29:22.215529 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:29:22.225258 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:29:22.230013 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:29:22.245612 (MainThread): Partial parsing not enabled
2021-10-06 14:29:22.302818 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:29:22.335654 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:22.361371 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:29:22.562776 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:29:22.580500 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f458eaa8-a526-417a-ad50-8ae703a5f52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd615401e80>]}
2021-10-06 14:29:22.633864 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:29:22.637230 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:29:22.641811 (MainThread): 
2021-10-06 14:29:22.647600 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:29:22.656712 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:29:22.684714 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:29:22.687389 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:29:22.689874 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:29:22.699688 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:29:22.706022 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:29:22.715402 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:29:22.727190 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:29:22.729480 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:29:22.731770 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:29:22.741754 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:29:22.745117 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:29:22.748193 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:29:22.757528 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:29:22.775485 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:29:22.778722 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:29:22.794016 (MainThread): Using postgres connection "master".
2021-10-06 14:29:22.797760 (MainThread): On master: BEGIN
2021-10-06 14:29:22.800072 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:29:22.808601 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:29:22.812139 (MainThread): Using postgres connection "master".
2021-10-06 14:29:22.815235 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:29:22.826893 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:29:22.834368 (MainThread): On master: ROLLBACK
2021-10-06 14:29:22.837529 (MainThread): Using postgres connection "master".
2021-10-06 14:29:22.839945 (MainThread): On master: BEGIN
2021-10-06 14:29:22.843792 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:29:22.847391 (MainThread): On master: COMMIT
2021-10-06 14:29:22.849219 (MainThread): Using postgres connection "master".
2021-10-06 14:29:22.852373 (MainThread): On master: COMMIT
2021-10-06 14:29:22.857059 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:29:22.860067 (MainThread): On master: Close
2021-10-06 14:29:22.863926 (MainThread): 14:29:22 | Concurrency: 2 threads (target='dev')
2021-10-06 14:29:22.867677 (MainThread): 14:29:22 | 
2021-10-06 14:29:22.877065 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:29:22.880905 (Thread-1): 14:29:22 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:29:22.883518 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:22.886679 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:29:22.907053 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:29:22.916117 (Thread-1): finished collecting timing info
2021-10-06 14:29:22.947891 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:22.950037 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:29:22.952373 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:29:22.960499 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:29:22.965273 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:22.967553 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:29:22.970084 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:29:22.977214 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:29:22.986522 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:22.988867 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:29:22.993431 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:29:22.996699 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:22.999354 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    cn = creditcard::int / 10::int
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:29:23.004713 (Thread-1): Postgres error: column "cn" does not exist
LINE 5:     cn = creditcard::int / 10::int
            ^

2021-10-06 14:29:23.007283 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 14:29:23.010810 (Thread-1): finished collecting timing info
2021-10-06 14:29:23.015802 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:29:23.018664 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  column "cn" does not exist
  LINE 5:     cn = creditcard::int / 10::int
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "cn" does not exist
LINE 5:     cn = creditcard::int / 10::int
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  column "cn" does not exist
  LINE 5:     cn = creditcard::int / 10::int
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:29:23.023893 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f458eaa8-a526-417a-ad50-8ae703a5f52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd615308400>]}
2021-10-06 14:29:23.027455 (Thread-1): 14:29:23 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.14s]
2021-10-06 14:29:23.030943 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:29:23.037056 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:29:23.039260 (MainThread): Using postgres connection "master".
2021-10-06 14:29:23.041297 (MainThread): On master: BEGIN
2021-10-06 14:29:23.043804 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:29:23.053331 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:29:23.057887 (MainThread): On master: COMMIT
2021-10-06 14:29:23.060965 (MainThread): Using postgres connection "master".
2021-10-06 14:29:23.066411 (MainThread): On master: COMMIT
2021-10-06 14:29:23.069776 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:29:23.075959 (MainThread): On master: Close
2021-10-06 14:29:23.079319 (MainThread): 14:29:23 | 
2021-10-06 14:29:23.083358 (MainThread): 14:29:23 | Finished running 1 view model in 0.43s.
2021-10-06 14:29:23.086892 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:29:23.092936 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:29:23.158898 (MainThread): 
2021-10-06 14:29:23.162349 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 14:29:23.166272 (MainThread): 
2021-10-06 14:29:23.170459 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 14:29:23.174808 (MainThread):   column "cn" does not exist
2021-10-06 14:29:23.181851 (MainThread):   LINE 5:     cn = creditcard::int / 10::int
2021-10-06 14:29:23.189123 (MainThread):               ^
2021-10-06 14:29:23.194552 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:29:23.209629 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 14:29:23.217214 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6152e2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd614a7b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd614a7b070>]}
2021-10-06 14:29:23.224222 (MainThread): Flushing usage events
2021-10-06 14:29:34.370933 (MainThread): Running with dbt=0.19.0
2021-10-06 14:29:34.578873 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:29:34.591675 (MainThread): Tracking: tracking
2021-10-06 14:29:34.595020 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ae13a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96afb672b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ae14b190>]}
2021-10-06 14:29:34.628518 (MainThread): Partial parsing not enabled
2021-10-06 14:29:34.642646 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:29:34.655310 (MainThread): Parsing macros/relations.sql
2021-10-06 14:29:34.670245 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:29:34.704506 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:29:34.715665 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:29:34.727926 (MainThread): Parsing macros/core.sql
2021-10-06 14:29:34.735628 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:29:34.781126 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:29:34.799950 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:29:34.808633 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:29:34.817301 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:29:34.838419 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:29:34.842899 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:29:34.875852 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:29:34.891480 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:29:34.913862 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:29:34.918564 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:29:34.927753 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:29:34.943533 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:29:34.948317 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:29:34.952612 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:29:34.964530 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:29:34.968851 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:29:34.973232 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:29:34.976895 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:29:34.980734 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:29:34.985594 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:29:34.990052 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:29:35.002834 (MainThread): Partial parsing not enabled
2021-10-06 14:29:35.045443 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:29:35.082592 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:35.110071 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:29:35.297601 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:29:35.309005 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0178bb11-fc62-4c02-a5d4-36add1976a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96adff76d0>]}
2021-10-06 14:29:35.375333 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:29:35.381949 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:29:35.387366 (MainThread): 
2021-10-06 14:29:35.391205 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:29:35.402129 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:29:35.420602 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:29:35.423999 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:29:35.427098 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:29:35.441564 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:29:35.450774 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:29:35.459679 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:29:35.470983 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:29:35.473872 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:29:35.476546 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:29:35.489607 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:29:35.492557 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:29:35.495666 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:29:35.501987 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:29:35.514216 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:29:35.517199 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:29:35.535518 (MainThread): Using postgres connection "master".
2021-10-06 14:29:35.538231 (MainThread): On master: BEGIN
2021-10-06 14:29:35.540720 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:29:35.549445 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:29:35.551848 (MainThread): Using postgres connection "master".
2021-10-06 14:29:35.554858 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:29:35.568991 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:29:35.580291 (MainThread): On master: ROLLBACK
2021-10-06 14:29:35.583869 (MainThread): Using postgres connection "master".
2021-10-06 14:29:35.586837 (MainThread): On master: BEGIN
2021-10-06 14:29:35.592902 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:29:35.597321 (MainThread): On master: COMMIT
2021-10-06 14:29:35.601104 (MainThread): Using postgres connection "master".
2021-10-06 14:29:35.604659 (MainThread): On master: COMMIT
2021-10-06 14:29:35.610300 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:29:35.613824 (MainThread): On master: Close
2021-10-06 14:29:35.619902 (MainThread): 14:29:35 | Concurrency: 2 threads (target='dev')
2021-10-06 14:29:35.623232 (MainThread): 14:29:35 | 
2021-10-06 14:29:35.636347 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:29:35.643655 (Thread-1): 14:29:35 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:29:35.649567 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:35.656078 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:29:35.695301 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:29:35.707396 (Thread-1): finished collecting timing info
2021-10-06 14:29:35.758494 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:35.760710 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:29:35.762502 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:29:35.775046 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:29:35.785852 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:35.791481 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:29:35.797009 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:29:35.814438 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:29:35.826044 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:35.828892 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:29:35.832433 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:29:35.835919 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:35.838807 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard::int / 10::int
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:29:35.858136 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 14:29:35.870881 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:35.873594 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 14:29:35.877162 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:29:35.882467 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:35.885105 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 14:29:35.888041 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:29:35.897930 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:29:35.900546 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:35.902515 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:29:35.906851 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:29:35.912821 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:35.914704 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:29:35.918998 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:29:35.923742 (Thread-1): finished collecting timing info
2021-10-06 14:29:35.925803 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:29:35.928392 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0178bb11-fc62-4c02-a5d4-36add1976a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96adf12730>]}
2021-10-06 14:29:35.932083 (Thread-1): 14:29:35 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.28s]
2021-10-06 14:29:35.934811 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:29:35.941140 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:29:35.944355 (MainThread): Using postgres connection "master".
2021-10-06 14:29:35.946527 (MainThread): On master: BEGIN
2021-10-06 14:29:35.948905 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:29:35.955636 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:29:35.959396 (MainThread): On master: COMMIT
2021-10-06 14:29:35.962349 (MainThread): Using postgres connection "master".
2021-10-06 14:29:35.965795 (MainThread): On master: COMMIT
2021-10-06 14:29:35.968825 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:29:35.971781 (MainThread): On master: Close
2021-10-06 14:29:35.975850 (MainThread): 14:29:35 | 
2021-10-06 14:29:35.978322 (MainThread): 14:29:35 | Finished running 1 view model in 0.58s.
2021-10-06 14:29:35.981435 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:29:35.985916 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:29:36.035981 (MainThread): 
2021-10-06 14:29:36.039345 (MainThread): Completed successfully
2021-10-06 14:29:36.042939 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 14:29:36.047420 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96adfe4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96adfd6460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ac65be50>]}
2021-10-06 14:29:36.050694 (MainThread): Flushing usage events
2021-10-06 14:29:50.478720 (MainThread): Running with dbt=0.19.0
2021-10-06 14:29:50.720796 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:29:50.730717 (MainThread): Tracking: tracking
2021-10-06 14:29:50.736290 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e77d72910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7b379430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e77d83100>]}
2021-10-06 14:29:50.787418 (MainThread): Partial parsing not enabled
2021-10-06 14:29:50.799433 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:29:50.802781 (MainThread): Parsing macros/relations.sql
2021-10-06 14:29:50.807069 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:29:50.828570 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:29:50.833974 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:29:50.842761 (MainThread): Parsing macros/core.sql
2021-10-06 14:29:50.852585 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:29:50.918206 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:29:50.938962 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:29:50.949945 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:29:50.957069 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:29:50.977733 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:29:50.982389 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:29:51.023335 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:29:51.048450 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:29:51.074659 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:29:51.079212 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:29:51.088606 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:29:51.098643 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:29:51.102427 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:29:51.106187 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:29:51.120404 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:29:51.126121 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:29:51.130606 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:29:51.134576 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:29:51.138780 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:29:51.144516 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:29:51.148885 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:29:51.165009 (MainThread): Partial parsing not enabled
2021-10-06 14:29:51.210210 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:29:51.243308 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:51.275221 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:29:51.493563 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:29:51.504611 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0aba7c46-1ec0-4377-bfcb-5a0fdbc4ced9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e77c37940>]}
2021-10-06 14:29:51.559902 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:29:51.565456 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:29:51.570160 (MainThread): 
2021-10-06 14:29:51.574118 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:29:51.581142 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:29:51.602325 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:29:51.605718 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:29:51.608505 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:29:51.622222 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:29:51.633791 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:29:51.643243 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:29:51.651608 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:29:51.654120 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:29:51.656242 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:29:51.666094 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:29:51.671433 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:29:51.675537 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:29:51.680429 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:29:51.699665 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:29:51.703129 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:29:51.718504 (MainThread): Using postgres connection "master".
2021-10-06 14:29:51.721799 (MainThread): On master: BEGIN
2021-10-06 14:29:51.724625 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:29:51.732840 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:29:51.735360 (MainThread): Using postgres connection "master".
2021-10-06 14:29:51.738481 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:29:51.747975 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:29:51.754246 (MainThread): On master: ROLLBACK
2021-10-06 14:29:51.757209 (MainThread): Using postgres connection "master".
2021-10-06 14:29:51.759958 (MainThread): On master: BEGIN
2021-10-06 14:29:51.764403 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:29:51.768434 (MainThread): On master: COMMIT
2021-10-06 14:29:51.772590 (MainThread): Using postgres connection "master".
2021-10-06 14:29:51.775012 (MainThread): On master: COMMIT
2021-10-06 14:29:51.777493 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:29:51.779465 (MainThread): On master: Close
2021-10-06 14:29:51.783493 (MainThread): 14:29:51 | Concurrency: 2 threads (target='dev')
2021-10-06 14:29:51.786982 (MainThread): 14:29:51 | 
2021-10-06 14:29:51.796367 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:29:51.799228 (Thread-1): 14:29:51 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:29:51.801966 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:51.804672 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:29:51.827077 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:29:51.838563 (Thread-1): finished collecting timing info
2021-10-06 14:29:51.874524 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:51.877329 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:29:51.879781 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:29:51.890226 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:29:51.898711 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:51.901620 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:29:51.906434 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:29:51.916219 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:29:51.928981 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:51.931434 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:29:51.934566 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:29:51.939262 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:29:51.944602 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard::int // 10::int
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:29:51.948884 (Thread-1): Postgres error: operator does not exist: integer // integer
LINE 5:     creditcard::int // 10::int
                            ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2021-10-06 14:29:51.957105 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 14:29:51.964190 (Thread-1): finished collecting timing info
2021-10-06 14:29:51.968099 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:29:51.975402 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: integer // integer
  LINE 5:     creditcard::int // 10::int
                              ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: operator does not exist: integer // integer
LINE 5:     creditcard::int // 10::int
                            ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: integer // integer
  LINE 5:     creditcard::int // 10::int
                              ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:29:51.983356 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aba7c46-1ec0-4377-bfcb-5a0fdbc4ced9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e77b4b220>]}
2021-10-06 14:29:51.990270 (Thread-1): 14:29:51 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.18s]
2021-10-06 14:29:51.994025 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:29:52.001250 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:29:52.004028 (MainThread): Using postgres connection "master".
2021-10-06 14:29:52.007428 (MainThread): On master: BEGIN
2021-10-06 14:29:52.012593 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:29:52.025541 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:29:52.029203 (MainThread): On master: COMMIT
2021-10-06 14:29:52.033494 (MainThread): Using postgres connection "master".
2021-10-06 14:29:52.037796 (MainThread): On master: COMMIT
2021-10-06 14:29:52.040899 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:29:52.043066 (MainThread): On master: Close
2021-10-06 14:29:52.046591 (MainThread): 14:29:52 | 
2021-10-06 14:29:52.049133 (MainThread): 14:29:52 | Finished running 1 view model in 0.47s.
2021-10-06 14:29:52.053418 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:29:52.057218 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:29:52.120453 (MainThread): 
2021-10-06 14:29:52.123866 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 14:29:52.128617 (MainThread): 
2021-10-06 14:29:52.134461 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 14:29:52.139402 (MainThread):   operator does not exist: integer // integer
2021-10-06 14:29:52.143908 (MainThread):   LINE 5:     creditcard::int // 10::int
2021-10-06 14:29:52.147380 (MainThread):                               ^
2021-10-06 14:29:52.151404 (MainThread):   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2021-10-06 14:29:52.157858 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:29:52.162529 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 14:29:52.166633 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e77c31880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e77b413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7729f310>]}
2021-10-06 14:29:52.171669 (MainThread): Flushing usage events
2021-10-06 14:31:26.662359 (MainThread): Running with dbt=0.19.0
2021-10-06 14:31:26.909375 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:31:26.923990 (MainThread): Tracking: tracking
2021-10-06 14:31:26.934679 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb689b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb83472b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb68ac190>]}
2021-10-06 14:31:27.018184 (MainThread): Partial parsing not enabled
2021-10-06 14:31:27.029540 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:31:27.033850 (MainThread): Parsing macros/relations.sql
2021-10-06 14:31:27.039464 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:31:27.064405 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:31:27.070800 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:31:27.077437 (MainThread): Parsing macros/core.sql
2021-10-06 14:31:27.084744 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:31:27.132718 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:31:27.145293 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:31:27.155529 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:31:27.163006 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:31:27.182459 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:31:27.186850 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:31:27.219089 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:31:27.235006 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:31:27.259029 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:31:27.263663 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:31:27.279214 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:31:27.289182 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:31:27.292388 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:31:27.297451 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:31:27.309112 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:31:27.313616 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:31:27.318256 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:31:27.321459 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:31:27.325341 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:31:27.331525 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:31:27.335805 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:31:27.350701 (MainThread): Partial parsing not enabled
2021-10-06 14:31:27.391881 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:31:27.422774 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:31:27.447965 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:31:27.642387 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:31:27.659475 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd100ba01-5461-4dfd-a32f-a86f315b55e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb6764f70>]}
2021-10-06 14:31:27.716401 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:31:27.721361 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:31:27.725533 (MainThread): 
2021-10-06 14:31:27.730009 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:31:27.737202 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:31:27.753028 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:31:27.756259 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:31:27.759379 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:31:27.771447 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:31:27.777255 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:31:27.786495 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:31:27.798877 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:31:27.801594 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:31:27.805776 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 14:31:27.819656 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:31:27.828134 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:31:27.835142 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:31:27.844891 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:31:27.875368 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:31:27.879508 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:31:27.893136 (MainThread): Using postgres connection "master".
2021-10-06 14:31:27.895704 (MainThread): On master: BEGIN
2021-10-06 14:31:27.898308 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:31:27.912926 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:31:27.916708 (MainThread): Using postgres connection "master".
2021-10-06 14:31:27.921216 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:31:27.932462 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:31:27.946260 (MainThread): On master: ROLLBACK
2021-10-06 14:31:27.949232 (MainThread): Using postgres connection "master".
2021-10-06 14:31:27.951662 (MainThread): On master: BEGIN
2021-10-06 14:31:27.954255 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:31:27.956909 (MainThread): On master: COMMIT
2021-10-06 14:31:27.959428 (MainThread): Using postgres connection "master".
2021-10-06 14:31:27.962378 (MainThread): On master: COMMIT
2021-10-06 14:31:27.964663 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:31:27.966702 (MainThread): On master: Close
2021-10-06 14:31:27.970828 (MainThread): 14:31:27 | Concurrency: 2 threads (target='dev')
2021-10-06 14:31:27.974823 (MainThread): 14:31:27 | 
2021-10-06 14:31:27.983202 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:31:27.989924 (Thread-1): 14:31:27 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:31:27.993878 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:31:27.997860 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:31:28.022007 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:31:28.030652 (Thread-1): finished collecting timing info
2021-10-06 14:31:28.061314 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:31:28.063732 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:31:28.066848 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:31:28.075656 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:31:28.080139 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:31:28.082223 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:31:28.085555 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:31:28.099610 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:31:28.108968 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:31:28.112050 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:31:28.116291 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:31:28.118899 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:31:28.123445 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    2
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:31:28.141321 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-06 14:31:28.153842 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:31:28.156403 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 14:31:28.159449 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:31:28.167600 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:31:28.169396 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 14:31:28.172316 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:31:28.181715 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:31:28.183857 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:31:28.185941 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:31:28.189184 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:31:28.194728 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:31:28.196660 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:31:28.202334 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:31:28.207538 (Thread-1): finished collecting timing info
2021-10-06 14:31:28.209746 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:31:28.213541 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd100ba01-5461-4dfd-a32f-a86f315b55e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb55f2cd0>]}
2021-10-06 14:31:28.218009 (Thread-1): 14:31:28 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.22s]
2021-10-06 14:31:28.220868 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:31:28.228789 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:31:28.232237 (MainThread): Using postgres connection "master".
2021-10-06 14:31:28.236032 (MainThread): On master: BEGIN
2021-10-06 14:31:28.238229 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:31:28.244677 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:31:28.247624 (MainThread): On master: COMMIT
2021-10-06 14:31:28.250556 (MainThread): Using postgres connection "master".
2021-10-06 14:31:28.253604 (MainThread): On master: COMMIT
2021-10-06 14:31:28.256311 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:31:28.258432 (MainThread): On master: Close
2021-10-06 14:31:28.261708 (MainThread): 14:31:28 | 
2021-10-06 14:31:28.264146 (MainThread): 14:31:28 | Finished running 1 view model in 0.53s.
2021-10-06 14:31:28.267005 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:31:28.270814 (MainThread): Connection 'list_dellstore' was properly closed.
2021-10-06 14:31:28.274537 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:31:28.335788 (MainThread): 
2021-10-06 14:31:28.340371 (MainThread): Completed successfully
2021-10-06 14:31:28.345569 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 14:31:28.353495 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb6641d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb671b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb66d5a00>]}
2021-10-06 14:31:28.359750 (MainThread): Flushing usage events
2021-10-06 14:32:04.255671 (MainThread): Running with dbt=0.19.0
2021-10-06 14:32:04.456847 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:32:04.468184 (MainThread): Tracking: tracking
2021-10-06 14:32:04.474143 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8fd6dca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ff186370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8fd6ed1f0>]}
2021-10-06 14:32:04.528523 (MainThread): Partial parsing not enabled
2021-10-06 14:32:04.544486 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:32:04.548834 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8fd679e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8fd6ffbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8fd6ffbb0>]}
2021-10-06 14:32:04.552749 (MainThread): Flushing usage events
2021-10-06 14:32:05.070062 (MainThread): Encountered an error:
2021-10-06 14:32:05.077136 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token 'end of print statement', got ':'
    line 2
      {{ cc::integer // 10 }}
2021-10-06 14:32:05.088684 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of print statement', got ':'
  line 2
    {{ cc::integer // 10 }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token 'end of print statement', got ':'
    line 2
      {{ cc::integer // 10 }}

2021-10-06 14:32:50.525310 (MainThread): Running with dbt=0.19.0
2021-10-06 14:32:50.715594 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:32:50.723888 (MainThread): Tracking: tracking
2021-10-06 14:32:50.729742 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a6f7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2dcfe430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a707100>]}
2021-10-06 14:32:50.782548 (MainThread): Partial parsing not enabled
2021-10-06 14:32:50.794227 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:32:50.800467 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a6957f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a71b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a71bee0>]}
2021-10-06 14:32:50.803799 (MainThread): Flushing usage events
2021-10-06 14:32:51.357637 (MainThread): Encountered an error:
2021-10-06 14:32:51.364112 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token 'end of print statement', got ':'
    line 2
      {{ cc::numeric // 10 }}
2021-10-06 14:32:51.378068 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of print statement', got ':'
  line 2
    {{ cc::numeric // 10 }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token 'end of print statement', got ':'
    line 2
      {{ cc::numeric // 10 }}

2021-10-06 14:33:13.068344 (MainThread): Running with dbt=0.19.0
2021-10-06 14:33:13.338334 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:33:13.348646 (MainThread): Tracking: tracking
2021-10-06 14:33:13.351931 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e58a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0ffb52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e59b190>]}
2021-10-06 14:33:13.386304 (MainThread): Partial parsing not enabled
2021-10-06 14:33:13.396521 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:33:13.399989 (MainThread): Parsing macros/relations.sql
2021-10-06 14:33:13.404489 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:33:13.440816 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:33:13.445953 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:33:13.450907 (MainThread): Parsing macros/core.sql
2021-10-06 14:33:13.458041 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:33:13.509196 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:33:13.523887 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:33:13.537418 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:33:13.546515 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:33:13.568661 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:33:13.578898 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:33:13.615712 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:33:13.635491 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:33:13.661430 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:33:13.666673 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:33:13.678506 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:33:13.692957 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:33:13.697913 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:33:13.702888 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:33:13.716291 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:33:13.722741 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:33:13.728667 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:33:13.733764 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:33:13.739170 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:33:13.745934 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:33:13.750397 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:33:13.769570 (MainThread): Partial parsing not enabled
2021-10-06 14:33:13.815853 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:33:13.850069 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:13.879323 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:33:14.102061 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:33:14.111749 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee986c00-220d-48a8-9d69-4d0d365a47ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e444f40>]}
2021-10-06 14:33:14.181977 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:33:14.187797 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:33:14.192883 (MainThread): 
2021-10-06 14:33:14.200373 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:33:14.206178 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:33:14.226739 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:33:14.229663 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:33:14.232764 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:33:14.246366 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:33:14.253511 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:33:14.263394 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:33:14.278943 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:33:14.282059 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:33:14.284879 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 14:33:14.297245 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:33:14.300229 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:33:14.305884 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:33:14.321971 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 14:33:14.341198 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:33:14.344830 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:33:14.355425 (MainThread): Using postgres connection "master".
2021-10-06 14:33:14.357513 (MainThread): On master: BEGIN
2021-10-06 14:33:14.359421 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:33:14.370798 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:33:14.374250 (MainThread): Using postgres connection "master".
2021-10-06 14:33:14.378093 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:33:14.392967 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:33:14.400733 (MainThread): On master: ROLLBACK
2021-10-06 14:33:14.404006 (MainThread): Using postgres connection "master".
2021-10-06 14:33:14.406214 (MainThread): On master: BEGIN
2021-10-06 14:33:14.409828 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:33:14.412485 (MainThread): On master: COMMIT
2021-10-06 14:33:14.414554 (MainThread): Using postgres connection "master".
2021-10-06 14:33:14.417211 (MainThread): On master: COMMIT
2021-10-06 14:33:14.420251 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:33:14.422776 (MainThread): On master: Close
2021-10-06 14:33:14.427010 (MainThread): 14:33:14 | Concurrency: 2 threads (target='dev')
2021-10-06 14:33:14.431698 (MainThread): 14:33:14 | 
2021-10-06 14:33:14.443715 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:33:14.448577 (Thread-1): 14:33:14 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:33:14.453890 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:14.457459 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:33:14.480082 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:33:14.490537 (Thread-1): finished collecting timing info
2021-10-06 14:33:14.539606 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:14.542198 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:33:14.545149 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:33:14.555740 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:33:14.562553 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:14.566487 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:33:14.570276 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:33:14.587416 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:33:14.610989 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:14.615545 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:33:14.624931 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:33:14.628774 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:14.632938 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard ::numeric // 10
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:33:14.638437 (Thread-1): Postgres error: operator does not exist: numeric // integer
LINE 5:     creditcard ::numeric // 10
                                 ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

2021-10-06 14:33:14.644402 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 14:33:14.648979 (Thread-1): finished collecting timing info
2021-10-06 14:33:14.653768 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:33:14.657949 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: numeric // integer
  LINE 5:     creditcard ::numeric // 10
                                   ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: operator does not exist: numeric // integer
LINE 5:     creditcard ::numeric // 10
                                 ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  operator does not exist: numeric // integer
  LINE 5:     creditcard ::numeric // 10
                                   ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:33:14.670253 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee986c00-220d-48a8-9d69-4d0d365a47ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0d2dffd0>]}
2021-10-06 14:33:14.677984 (Thread-1): 14:33:14 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.22s]
2021-10-06 14:33:14.685079 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:33:14.691895 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:33:14.695886 (MainThread): Using postgres connection "master".
2021-10-06 14:33:14.700134 (MainThread): On master: BEGIN
2021-10-06 14:33:14.705287 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:33:14.721842 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-06 14:33:14.730019 (MainThread): On master: COMMIT
2021-10-06 14:33:14.739998 (MainThread): Using postgres connection "master".
2021-10-06 14:33:14.743773 (MainThread): On master: COMMIT
2021-10-06 14:33:14.751768 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:33:14.757375 (MainThread): On master: Close
2021-10-06 14:33:14.763999 (MainThread): 14:33:14 | 
2021-10-06 14:33:14.769316 (MainThread): 14:33:14 | Finished running 1 view model in 0.56s.
2021-10-06 14:33:14.808006 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:33:14.818698 (MainThread): Connection 'list_dellstore' was properly closed.
2021-10-06 14:33:14.821811 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:33:14.933966 (MainThread): 
2021-10-06 14:33:14.939187 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 14:33:14.948676 (MainThread): 
2021-10-06 14:33:14.956797 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 14:33:14.961937 (MainThread):   operator does not exist: numeric // integer
2021-10-06 14:33:14.965469 (MainThread):   LINE 5:     creditcard ::numeric // 10
2021-10-06 14:33:14.972322 (MainThread):                                    ^
2021-10-06 14:33:14.980219 (MainThread):   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
2021-10-06 14:33:14.986913 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:33:14.992167 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 14:33:14.999671 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e330d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e4083a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e46c340>]}
2021-10-06 14:33:15.006908 (MainThread): Flushing usage events
2021-10-06 14:33:27.318237 (MainThread): Running with dbt=0.19.0
2021-10-06 14:33:27.576341 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:33:27.584805 (MainThread): Tracking: tracking
2021-10-06 14:33:27.588373 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177cfe8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17805ee430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177cff8100>]}
2021-10-06 14:33:27.622753 (MainThread): Partial parsing not enabled
2021-10-06 14:33:27.636748 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:33:27.644397 (MainThread): Parsing macros/relations.sql
2021-10-06 14:33:27.658001 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:33:27.696539 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:33:27.704679 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:33:27.713335 (MainThread): Parsing macros/core.sql
2021-10-06 14:33:27.721444 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:33:27.770341 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:33:27.783548 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:33:27.792814 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:33:27.800886 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:33:27.822394 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:33:27.826933 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:33:27.859173 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:33:27.875142 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:33:27.899833 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:33:27.904472 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:33:27.912744 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:33:27.921484 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:33:27.925031 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:33:27.929202 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:33:27.940304 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:33:27.944834 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:33:27.949318 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:33:27.953421 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:33:27.957400 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:33:27.962313 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:33:27.966355 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:33:27.980596 (MainThread): Partial parsing not enabled
2021-10-06 14:33:28.024090 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:33:28.060283 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:28.082863 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:33:28.297888 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:33:28.313295 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4bd7665-66de-47e7-a9cf-d3a401fa93ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177ceac5e0>]}
2021-10-06 14:33:28.361790 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:33:28.366212 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:33:28.370022 (MainThread): 
2021-10-06 14:33:28.374669 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:33:28.381843 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:33:28.402478 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:33:28.406642 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:33:28.410676 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:33:28.419890 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:33:28.427411 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:33:28.444154 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:33:28.460719 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:33:28.463784 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:33:28.466775 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:33:28.475166 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:33:28.478393 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:33:28.481168 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:33:28.490663 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:33:28.514459 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:33:28.517483 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:33:28.533138 (MainThread): Using postgres connection "master".
2021-10-06 14:33:28.535768 (MainThread): On master: BEGIN
2021-10-06 14:33:28.538421 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:33:28.547173 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:33:28.552411 (MainThread): Using postgres connection "master".
2021-10-06 14:33:28.556996 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:33:28.567703 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:33:28.574736 (MainThread): On master: ROLLBACK
2021-10-06 14:33:28.577807 (MainThread): Using postgres connection "master".
2021-10-06 14:33:28.581198 (MainThread): On master: BEGIN
2021-10-06 14:33:28.584752 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:33:28.587954 (MainThread): On master: COMMIT
2021-10-06 14:33:28.592728 (MainThread): Using postgres connection "master".
2021-10-06 14:33:28.596016 (MainThread): On master: COMMIT
2021-10-06 14:33:28.601798 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:33:28.605235 (MainThread): On master: Close
2021-10-06 14:33:28.608966 (MainThread): 14:33:28 | Concurrency: 2 threads (target='dev')
2021-10-06 14:33:28.613760 (MainThread): 14:33:28 | 
2021-10-06 14:33:28.623701 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:33:28.629288 (Thread-1): 14:33:28 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:33:28.633710 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:28.637725 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:33:28.665850 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:33:28.673899 (Thread-1): finished collecting timing info
2021-10-06 14:33:28.705080 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:28.707411 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:33:28.710249 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:33:28.717303 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:33:28.722431 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:28.724923 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:33:28.727864 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:33:28.735466 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:33:28.742504 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:28.744575 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:33:28.747905 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:33:28.750475 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:28.755028 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard ::numeric / 10
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:33:28.768845 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 14:33:28.786445 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:28.791166 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 14:33:28.796844 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:33:28.804264 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:28.806738 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 14:33:28.810385 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:33:28.823558 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:33:28.826601 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:28.828710 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:33:28.832443 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:33:28.838465 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:28.842838 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:33:28.847559 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:33:28.854945 (Thread-1): finished collecting timing info
2021-10-06 14:33:28.857566 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:33:28.860110 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4bd7665-66de-47e7-a9cf-d3a401fa93ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177c4cd820>]}
2021-10-06 14:33:28.863585 (Thread-1): 14:33:28 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.23s]
2021-10-06 14:33:28.867150 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:33:28.874392 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:33:28.876835 (MainThread): Using postgres connection "master".
2021-10-06 14:33:28.880007 (MainThread): On master: BEGIN
2021-10-06 14:33:28.883563 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:33:28.893374 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:33:28.897305 (MainThread): On master: COMMIT
2021-10-06 14:33:28.900849 (MainThread): Using postgres connection "master".
2021-10-06 14:33:28.904252 (MainThread): On master: COMMIT
2021-10-06 14:33:28.907993 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:33:28.915526 (MainThread): On master: Close
2021-10-06 14:33:28.918211 (MainThread): 14:33:28 | 
2021-10-06 14:33:28.920528 (MainThread): 14:33:28 | Finished running 1 view model in 0.54s.
2021-10-06 14:33:28.926541 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:33:28.932063 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:33:28.995637 (MainThread): 
2021-10-06 14:33:28.999636 (MainThread): Completed successfully
2021-10-06 14:33:29.010609 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 14:33:29.016585 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177ce1bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177cdb64c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177c5066d0>]}
2021-10-06 14:33:29.021919 (MainThread): Flushing usage events
2021-10-06 14:33:39.506185 (MainThread): Running with dbt=0.19.0
2021-10-06 14:33:39.731716 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:33:39.739162 (MainThread): Tracking: tracking
2021-10-06 14:33:39.745351 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1a209fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1d80f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1a219070>]}
2021-10-06 14:33:39.819231 (MainThread): Partial parsing not enabled
2021-10-06 14:33:39.832945 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:33:39.837350 (MainThread): Parsing macros/relations.sql
2021-10-06 14:33:39.843107 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:33:39.879805 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:33:39.890220 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:33:39.897822 (MainThread): Parsing macros/core.sql
2021-10-06 14:33:39.904383 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:33:39.948921 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:33:39.959794 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:33:39.969803 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:33:39.978809 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:33:40.000704 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:33:40.005252 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:33:40.044454 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:33:40.063926 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:33:40.088101 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:33:40.092738 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:33:40.101936 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:33:40.112311 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:33:40.115967 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:33:40.120167 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:33:40.138058 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:33:40.142942 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:33:40.147320 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:33:40.150775 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:33:40.155282 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:33:40.160125 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:33:40.168220 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:33:40.183739 (MainThread): Partial parsing not enabled
2021-10-06 14:33:40.224536 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:33:40.252958 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:40.287714 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:33:40.503985 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:33:40.509692 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35af7087-e022-45a4-b56b-51093d05755b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1a109400>]}
2021-10-06 14:33:40.558650 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:33:40.562125 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:33:40.566411 (MainThread): 
2021-10-06 14:33:40.571364 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:33:40.577411 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:33:40.595078 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:33:40.597392 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:33:40.599361 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:33:40.609181 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:33:40.613699 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:33:40.625398 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:33:40.637611 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:33:40.640027 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:33:40.644473 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:33:40.659554 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-10-06 14:33:40.662870 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:33:40.668378 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:33:40.680904 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:33:40.699785 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:33:40.703226 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:33:40.724670 (MainThread): Using postgres connection "master".
2021-10-06 14:33:40.727117 (MainThread): On master: BEGIN
2021-10-06 14:33:40.729125 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:33:40.740424 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:33:40.743959 (MainThread): Using postgres connection "master".
2021-10-06 14:33:40.747018 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:33:40.759640 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:33:40.770275 (MainThread): On master: ROLLBACK
2021-10-06 14:33:40.773969 (MainThread): Using postgres connection "master".
2021-10-06 14:33:40.776431 (MainThread): On master: BEGIN
2021-10-06 14:33:40.780657 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:33:40.784586 (MainThread): On master: COMMIT
2021-10-06 14:33:40.789444 (MainThread): Using postgres connection "master".
2021-10-06 14:33:40.792887 (MainThread): On master: COMMIT
2021-10-06 14:33:40.796236 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:33:40.798663 (MainThread): On master: Close
2021-10-06 14:33:40.802244 (MainThread): 14:33:40 | Concurrency: 2 threads (target='dev')
2021-10-06 14:33:40.807560 (MainThread): 14:33:40 | 
2021-10-06 14:33:40.817121 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:33:40.823796 (Thread-1): 14:33:40 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:33:40.827991 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:40.830666 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:33:40.848414 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:33:40.856474 (Thread-1): finished collecting timing info
2021-10-06 14:33:40.889451 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:40.892935 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:33:40.895753 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:33:40.905706 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:33:40.913388 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:40.916039 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:33:40.919443 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:33:40.929840 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:33:40.939483 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:40.942452 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:33:40.946732 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:33:40.950556 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:40.955016 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard ::numeric % 10
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:33:40.968410 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 14:33:40.978703 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:40.981041 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 14:33:40.983887 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:33:40.988865 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:40.991272 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 14:33:40.994277 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:33:41.004202 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:33:41.006206 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:41.008238 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:33:41.019804 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-06 14:33:41.027339 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:41.032191 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:33:41.039871 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:33:41.048575 (Thread-1): finished collecting timing info
2021-10-06 14:33:41.052791 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:33:41.058910 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35af7087-e022-45a4-b56b-51093d05755b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f187154c0>]}
2021-10-06 14:33:41.065779 (Thread-1): 14:33:41 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.23s]
2021-10-06 14:33:41.069166 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:33:41.081712 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:33:41.085911 (MainThread): Using postgres connection "master".
2021-10-06 14:33:41.090277 (MainThread): On master: BEGIN
2021-10-06 14:33:41.095199 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:33:41.109802 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:33:41.114276 (MainThread): On master: COMMIT
2021-10-06 14:33:41.118239 (MainThread): Using postgres connection "master".
2021-10-06 14:33:41.120722 (MainThread): On master: COMMIT
2021-10-06 14:33:41.125417 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:33:41.128016 (MainThread): On master: Close
2021-10-06 14:33:41.132194 (MainThread): 14:33:41 | 
2021-10-06 14:33:41.135184 (MainThread): 14:33:41 | Finished running 1 view model in 0.56s.
2021-10-06 14:33:41.138529 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:33:41.141717 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:33:41.200590 (MainThread): 
2021-10-06 14:33:41.204317 (MainThread): Completed successfully
2021-10-06 14:33:41.207651 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 14:33:41.211855 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1a0f7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1872a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1872a520>]}
2021-10-06 14:33:41.216076 (MainThread): Flushing usage events
2021-10-06 14:33:58.082948 (MainThread): Running with dbt=0.19.0
2021-10-06 14:33:58.286047 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:33:58.299933 (MainThread): Tracking: tracking
2021-10-06 14:33:58.305382 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f6de3a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f888e370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f6df41f0>]}
2021-10-06 14:33:58.366264 (MainThread): Partial parsing not enabled
2021-10-06 14:33:58.382162 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:33:58.387140 (MainThread): Parsing macros/relations.sql
2021-10-06 14:33:58.396933 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:33:58.446581 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:33:58.455937 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:33:58.463336 (MainThread): Parsing macros/core.sql
2021-10-06 14:33:58.470541 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:33:58.521708 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:33:58.534456 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:33:58.545316 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:33:58.557268 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:33:58.580400 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:33:58.585266 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:33:58.625889 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:33:58.647175 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:33:58.672470 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:33:58.676506 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:33:58.685041 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:33:58.695992 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:33:58.703691 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:33:58.709873 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:33:58.720998 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:33:58.725975 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:33:58.730333 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:33:58.733392 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:33:58.737613 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:33:58.747127 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:33:58.752966 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:33:58.771527 (MainThread): Partial parsing not enabled
2021-10-06 14:33:58.820529 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:33:58.853421 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:58.879358 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:33:59.091707 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:33:59.109210 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '045cc68a-3a93-48b5-ae02-f0a4c4cc42ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f6ca0280>]}
2021-10-06 14:33:59.170999 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:33:59.175642 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:33:59.183147 (MainThread): 
2021-10-06 14:33:59.188607 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:33:59.194192 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:33:59.219308 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:33:59.223468 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:33:59.225934 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:33:59.236103 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:33:59.241471 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:33:59.254089 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:33:59.266616 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:33:59.268884 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:33:59.270947 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:33:59.279604 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:33:59.282561 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:33:59.286303 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:33:59.291833 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:33:59.307510 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:33:59.311609 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:33:59.325821 (MainThread): Using postgres connection "master".
2021-10-06 14:33:59.328577 (MainThread): On master: BEGIN
2021-10-06 14:33:59.331682 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:33:59.341960 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:33:59.345754 (MainThread): Using postgres connection "master".
2021-10-06 14:33:59.349070 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:33:59.363026 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:33:59.370342 (MainThread): On master: ROLLBACK
2021-10-06 14:33:59.373519 (MainThread): Using postgres connection "master".
2021-10-06 14:33:59.376235 (MainThread): On master: BEGIN
2021-10-06 14:33:59.381310 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:33:59.383859 (MainThread): On master: COMMIT
2021-10-06 14:33:59.387624 (MainThread): Using postgres connection "master".
2021-10-06 14:33:59.390688 (MainThread): On master: COMMIT
2021-10-06 14:33:59.393944 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:33:59.396539 (MainThread): On master: Close
2021-10-06 14:33:59.400521 (MainThread): 14:33:59 | Concurrency: 2 threads (target='dev')
2021-10-06 14:33:59.403994 (MainThread): 14:33:59 | 
2021-10-06 14:33:59.419228 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:33:59.424852 (Thread-1): 14:33:59 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:33:59.427489 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:59.430698 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:33:59.451423 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:33:59.461178 (Thread-1): finished collecting timing info
2021-10-06 14:33:59.494347 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:59.497065 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:33:59.499214 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:33:59.512281 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:33:59.517929 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:59.520247 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:33:59.524297 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:33:59.538004 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:33:59.544108 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:59.546296 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:33:59.549361 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:33:59.553055 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:33:59.555963 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    digit = creditcard ::numeric % 10
 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:33:59.563565 (Thread-1): Postgres error: column "digit" does not exist
LINE 5:     digit = creditcard ::numeric % 10
            ^

2021-10-06 14:33:59.566945 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 14:33:59.582923 (Thread-1): finished collecting timing info
2021-10-06 14:33:59.586473 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:33:59.593475 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  column "digit" does not exist
  LINE 5:     digit = creditcard ::numeric % 10
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "digit" does not exist
LINE 5:     digit = creditcard ::numeric % 10
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  column "digit" does not exist
  LINE 5:     digit = creditcard ::numeric % 10
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:33:59.601522 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '045cc68a-3a93-48b5-ae02-f0a4c4cc42ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f6c41dc0>]}
2021-10-06 14:33:59.607422 (Thread-1): 14:33:59 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.17s]
2021-10-06 14:33:59.611303 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:33:59.622297 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:33:59.626511 (MainThread): Using postgres connection "master".
2021-10-06 14:33:59.629348 (MainThread): On master: BEGIN
2021-10-06 14:33:59.632096 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:33:59.644967 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:33:59.651012 (MainThread): On master: COMMIT
2021-10-06 14:33:59.654868 (MainThread): Using postgres connection "master".
2021-10-06 14:33:59.658909 (MainThread): On master: COMMIT
2021-10-06 14:33:59.665212 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:33:59.674446 (MainThread): On master: Close
2021-10-06 14:33:59.681680 (MainThread): 14:33:59 | 
2021-10-06 14:33:59.685464 (MainThread): 14:33:59 | Finished running 1 view model in 0.49s.
2021-10-06 14:33:59.690688 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:33:59.696076 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:33:59.763362 (MainThread): 
2021-10-06 14:33:59.765959 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 14:33:59.769283 (MainThread): 
2021-10-06 14:33:59.774508 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 14:33:59.778058 (MainThread):   column "digit" does not exist
2021-10-06 14:33:59.781770 (MainThread):   LINE 5:     digit = creditcard ::numeric % 10
2021-10-06 14:33:59.786866 (MainThread):               ^
2021-10-06 14:33:59.791581 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 14:33:59.801344 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 14:33:59.808287 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f6d71b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f6ce3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63f6ce3df0>]}
2021-10-06 14:33:59.812348 (MainThread): Flushing usage events
2021-10-06 14:34:36.370323 (MainThread): Running with dbt=0.19.0
2021-10-06 14:34:36.601302 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:34:36.614294 (MainThread): Tracking: tracking
2021-10-06 14:34:36.624645 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177b886940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177ee8c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177b896130>]}
2021-10-06 14:34:36.696032 (MainThread): Partial parsing not enabled
2021-10-06 14:34:36.710066 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:34:36.716421 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177b8237f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177b8a9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177b8a9dc0>]}
2021-10-06 14:34:36.719384 (MainThread): Flushing usage events
2021-10-06 14:34:37.266365 (MainThread): Encountered an error:
2021-10-06 14:34:37.273131 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set digit = {{ cc }} ::numeric % 10 %}
2021-10-06 14:34:37.286646 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set digit = {{ cc }} ::numeric % 10 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set digit = {{ cc }} ::numeric % 10 %}

2021-10-06 14:35:17.348023 (MainThread): Running with dbt=0.19.0
2021-10-06 14:35:17.668687 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:35:17.685528 (MainThread): Tracking: tracking
2021-10-06 14:35:17.692966 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8252644910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8255c4c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8252656100>]}
2021-10-06 14:35:17.744485 (MainThread): Partial parsing not enabled
2021-10-06 14:35:17.754167 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:35:17.764681 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82525e57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82526696d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8252669ee0>]}
2021-10-06 14:35:17.767436 (MainThread): Flushing usage events
2021-10-06 14:35:18.295782 (MainThread): Encountered an error:
2021-10-06 14:35:18.303305 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% if {{ cc }} ::numeric % 10 > 3 %}
2021-10-06 14:35:18.318804 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% if {{ cc }} ::numeric % 10 > 3 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% if {{ cc }} ::numeric % 10 > 3 %}

2021-10-06 14:41:55.707520 (MainThread): Running with dbt=0.19.0
2021-10-06 14:41:56.044542 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:41:56.057637 (MainThread): Tracking: tracking
2021-10-06 14:41:56.062343 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ddd2c79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dded732b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ddd2d8190>]}
2021-10-06 14:41:56.142253 (MainThread): Partial parsing not enabled
2021-10-06 14:41:56.154172 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:41:56.158510 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ddd2667c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ddd2ecb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ddd2ecb20>]}
2021-10-06 14:41:56.161919 (MainThread): Flushing usage events
2021-10-06 14:41:56.692524 (MainThread): Encountered an error:
2021-10-06 14:41:56.697651 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% if {{ cc }}::numeric % 10 > 3 %}
2021-10-06 14:41:56.713633 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% if {{ cc }}::numeric % 10 > 3 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% if {{ cc }}::numeric % 10 > 3 %}

2021-10-06 14:42:22.215638 (MainThread): Running with dbt=0.19.0
2021-10-06 14:42:22.482651 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:42:22.496723 (MainThread): Tracking: tracking
2021-10-06 14:42:22.505177 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f393209ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3933b47370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39320ae1f0>]}
2021-10-06 14:42:22.573701 (MainThread): Partial parsing not enabled
2021-10-06 14:42:22.589424 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:42:22.592794 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f393203be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39320c1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39320c1bb0>]}
2021-10-06 14:42:22.595915 (MainThread): Flushing usage events
2021-10-06 14:42:23.112885 (MainThread): Encountered an error:
2021-10-06 14:42:23.124674 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% if {{ cc }}::numeric % 10 > 3 %}
2021-10-06 14:42:23.139259 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% if {{ cc }}::numeric % 10 > 3 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% if {{ cc }}::numeric % 10 > 3 %}

2021-10-06 14:52:43.469197 (MainThread): Running with dbt=0.19.0
2021-10-06 14:52:43.726990 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 14:52:43.740440 (MainThread): Tracking: tracking
2021-10-06 14:52:43.746317 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1a0c8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1d6ce3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1a0d90a0>]}
2021-10-06 14:52:43.778134 (MainThread): Partial parsing not enabled
2021-10-06 14:52:43.787769 (MainThread): Parsing macros/Luhns.sql
2021-10-06 14:52:43.792300 (MainThread): Parsing macros/relations.sql
2021-10-06 14:52:43.799266 (MainThread): Parsing macros/adapters.sql
2021-10-06 14:52:43.837938 (MainThread): Parsing macros/catalog.sql
2021-10-06 14:52:43.845714 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 14:52:43.853776 (MainThread): Parsing macros/core.sql
2021-10-06 14:52:43.863914 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 14:52:43.911117 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 14:52:43.924240 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 14:52:43.935537 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 14:52:43.949600 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 14:52:43.974593 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 14:52:43.981313 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 14:52:44.021040 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 14:52:44.044456 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 14:52:44.072490 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 14:52:44.078503 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 14:52:44.088759 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 14:52:44.099862 (MainThread): Parsing macros/etc/query.sql
2021-10-06 14:52:44.103954 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 14:52:44.108237 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 14:52:44.121677 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 14:52:44.127455 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 14:52:44.132510 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 14:52:44.136499 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 14:52:44.142070 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 14:52:44.150350 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 14:52:44.155517 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 14:52:44.174085 (MainThread): Partial parsing not enabled
2021-10-06 14:52:44.227315 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 14:52:44.270529 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:52:44.305772 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 14:52:44.511624 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 14:52:44.521977 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbe5d2a7-5c90-4545-adae-b7bd608b7a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c19f90d90>]}
2021-10-06 14:52:44.608100 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 14:52:44.611339 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 14:52:44.615750 (MainThread): 
2021-10-06 14:52:44.619544 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:52:44.626356 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 14:52:44.647170 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 14:52:44.650376 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 14:52:44.652248 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 14:52:44.662140 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 14:52:44.672208 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 14:52:44.686528 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 14:52:44.703439 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:52:44.706137 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 14:52:44.708156 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 14:52:44.720971 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:52:44.724021 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 14:52:44.727090 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 14:52:44.736002 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 14:52:44.752516 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 14:52:44.755492 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 14:52:44.768014 (MainThread): Using postgres connection "master".
2021-10-06 14:52:44.770444 (MainThread): On master: BEGIN
2021-10-06 14:52:44.773075 (MainThread): Opening a new connection, currently in state init
2021-10-06 14:52:44.782633 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:52:44.786158 (MainThread): Using postgres connection "master".
2021-10-06 14:52:44.790313 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 14:52:44.799974 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 14:52:44.809050 (MainThread): On master: ROLLBACK
2021-10-06 14:52:44.813353 (MainThread): Using postgres connection "master".
2021-10-06 14:52:44.816262 (MainThread): On master: BEGIN
2021-10-06 14:52:44.818883 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:52:44.821611 (MainThread): On master: COMMIT
2021-10-06 14:52:44.826450 (MainThread): Using postgres connection "master".
2021-10-06 14:52:44.830537 (MainThread): On master: COMMIT
2021-10-06 14:52:44.834179 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:52:44.836270 (MainThread): On master: Close
2021-10-06 14:52:44.840043 (MainThread): 14:52:44 | Concurrency: 2 threads (target='dev')
2021-10-06 14:52:44.842403 (MainThread): 14:52:44 | 
2021-10-06 14:52:44.850705 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 14:52:44.856489 (Thread-1): 14:52:44 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 14:52:44.859934 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:52:44.864425 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 14:52:44.889319 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:52:44.901429 (Thread-1): finished collecting timing info
2021-10-06 14:52:44.939016 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:52:44.941230 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 14:52:44.943062 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 14:52:44.949847 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 14:52:44.954321 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:52:44.956508 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:52:44.959114 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:52:44.966326 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 14:52:44.975044 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:52:44.978179 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 14:52:44.980991 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 14:52:44.983786 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:52:44.986044 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select o.orderdate, 
    creditcard::numeric % 10 as LuhnCC, sum(o.totalamount) from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 14:52:45.011505 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-06 14:52:45.027228 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:52:45.030493 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 14:52:45.037053 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:52:45.045087 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:52:45.047455 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 14:52:45.051836 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 14:52:45.067614 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:52:45.070518 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:52:45.073055 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 14:52:45.078306 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:52:45.092386 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 14:52:45.095444 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 14:52:45.101873 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 14:52:45.108694 (Thread-1): finished collecting timing info
2021-10-06 14:52:45.111546 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 14:52:45.115060 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbe5d2a7-5c90-4545-adae-b7bd608b7a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c19fc9d90>]}
2021-10-06 14:52:45.120005 (Thread-1): 14:52:45 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.26s]
2021-10-06 14:52:45.123331 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 14:52:45.129319 (MainThread): Acquiring new postgres connection "master".
2021-10-06 14:52:45.132876 (MainThread): Using postgres connection "master".
2021-10-06 14:52:45.135590 (MainThread): On master: BEGIN
2021-10-06 14:52:45.138472 (MainThread): Opening a new connection, currently in state closed
2021-10-06 14:52:45.149935 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 14:52:45.154148 (MainThread): On master: COMMIT
2021-10-06 14:52:45.156804 (MainThread): Using postgres connection "master".
2021-10-06 14:52:45.159885 (MainThread): On master: COMMIT
2021-10-06 14:52:45.163334 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 14:52:45.166960 (MainThread): On master: Close
2021-10-06 14:52:45.170514 (MainThread): 14:52:45 | 
2021-10-06 14:52:45.174422 (MainThread): 14:52:45 | Finished running 1 view model in 0.55s.
2021-10-06 14:52:45.178327 (MainThread): Connection 'master' was properly closed.
2021-10-06 14:52:45.183302 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 14:52:45.231519 (MainThread): 
2021-10-06 14:52:45.233601 (MainThread): Completed successfully
2021-10-06 14:52:45.236415 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 14:52:45.240313 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c19fd5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c19ef3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c19e954c0>]}
2021-10-06 14:52:45.245338 (MainThread): Flushing usage events
2021-10-06 16:04:21.012908 (MainThread): Running with dbt=0.19.0
2021-10-06 16:04:21.256288 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:04:21.267787 (MainThread): Tracking: tracking
2021-10-06 16:04:21.273945 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb415463a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb416f0f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb415474220>]}
2021-10-06 16:04:21.329177 (MainThread): Partial parsing not enabled
2021-10-06 16:04:21.342901 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:04:21.346546 (MainThread): Parsing macros/relations.sql
2021-10-06 16:04:21.350976 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:04:21.374153 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:04:21.387328 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:04:21.396711 (MainThread): Parsing macros/core.sql
2021-10-06 16:04:21.409829 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:04:21.472428 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:04:21.488309 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:04:21.504292 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:04:21.515674 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:04:21.542952 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:04:21.553832 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:04:21.595035 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:04:21.611472 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:04:21.634915 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:04:21.639557 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:04:21.650197 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:04:21.659081 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:04:21.662777 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:04:21.667171 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:04:21.680626 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:04:21.690229 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:04:21.698399 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:04:21.701674 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:04:21.706759 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:04:21.712472 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:04:21.717395 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:04:21.733226 (MainThread): Partial parsing not enabled
2021-10-06 16:04:21.789719 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:04:21.818815 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:04:21.849559 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:04:22.053795 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:04:22.060981 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7260d7c-90fc-49c2-ab84-20dfc36391e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb415324850>]}
2021-10-06 16:04:22.125528 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:04:22.129477 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 16:04:22.132528 (MainThread): 
2021-10-06 16:04:22.135885 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:04:22.145393 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:04:22.163625 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:04:22.167346 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:04:22.169386 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:04:22.184429 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 16:04:22.188977 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:04:22.198451 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:04:22.206695 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:04:22.208738 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:04:22.212134 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:04:22.221697 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:04:22.224786 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:04:22.228259 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:04:22.245781 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 16:04:22.256914 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:04:22.259959 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:04:22.271071 (MainThread): Using postgres connection "master".
2021-10-06 16:04:22.273480 (MainThread): On master: BEGIN
2021-10-06 16:04:22.276516 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:04:22.284721 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:04:22.287858 (MainThread): Using postgres connection "master".
2021-10-06 16:04:22.290817 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:04:22.314978 (MainThread): SQL status: SELECT 2 in 0.02 seconds
2021-10-06 16:04:22.321710 (MainThread): On master: ROLLBACK
2021-10-06 16:04:22.324960 (MainThread): Using postgres connection "master".
2021-10-06 16:04:22.327204 (MainThread): On master: BEGIN
2021-10-06 16:04:22.332230 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:04:22.335509 (MainThread): On master: COMMIT
2021-10-06 16:04:22.337980 (MainThread): Using postgres connection "master".
2021-10-06 16:04:22.342254 (MainThread): On master: COMMIT
2021-10-06 16:04:22.345727 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:04:22.348320 (MainThread): On master: Close
2021-10-06 16:04:22.351923 (MainThread): 16:04:22 | Concurrency: 2 threads (target='dev')
2021-10-06 16:04:22.355470 (MainThread): 16:04:22 | 
2021-10-06 16:04:22.365699 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:04:22.369201 (Thread-1): 16:04:22 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:04:22.373748 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:04:22.377469 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:04:22.396429 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:04:22.409684 (Thread-1): finished collecting timing info
2021-10-06 16:04:22.439884 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:04:22.443129 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:04:22.446448 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:04:22.456567 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:04:22.462154 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:04:22.464614 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:04:22.467158 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:04:22.481193 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:04:22.495416 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:04:22.498874 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:04:22.501331 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:04:22.504782 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:04:22.508394 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
    creditcard::numeric % 10
 
    as LuhnCC, 
    sum(o.totalamount) as Lost_Sum
from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:04:22.535464 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-06 16:04:22.554414 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:04:22.557721 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 16:04:22.562057 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:04:22.574395 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:04:22.577512 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 16:04:22.582750 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:04:22.600247 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 16:04:22.604453 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:04:22.610583 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 16:04:22.621345 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-06 16:04:22.632127 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:04:22.634774 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:04:22.643528 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:04:22.649672 (Thread-1): finished collecting timing info
2021-10-06 16:04:22.652792 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:04:22.656754 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7260d7c-90fc-49c2-ab84-20dfc36391e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb41542ee80>]}
2021-10-06 16:04:22.662460 (Thread-1): 16:04:22 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.28s]
2021-10-06 16:04:22.666692 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:04:22.673534 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:04:22.679447 (MainThread): Using postgres connection "master".
2021-10-06 16:04:22.682513 (MainThread): On master: BEGIN
2021-10-06 16:04:22.685761 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:04:22.696551 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:04:22.700359 (MainThread): On master: COMMIT
2021-10-06 16:04:22.704166 (MainThread): Using postgres connection "master".
2021-10-06 16:04:22.707318 (MainThread): On master: COMMIT
2021-10-06 16:04:22.710902 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:04:22.713843 (MainThread): On master: Close
2021-10-06 16:04:22.717506 (MainThread): 16:04:22 | 
2021-10-06 16:04:22.720592 (MainThread): 16:04:22 | Finished running 1 view model in 0.58s.
2021-10-06 16:04:22.725472 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:04:22.729404 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:04:22.792687 (MainThread): 
2021-10-06 16:04:22.795869 (MainThread): Completed successfully
2021-10-06 16:04:22.802475 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 16:04:22.807440 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb415321520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb414182910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4141823d0>]}
2021-10-06 16:04:22.812367 (MainThread): Flushing usage events
2021-10-06 16:10:05.158071 (MainThread): Running with dbt=0.19.0
2021-10-06 16:10:05.407069 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:10:05.420157 (MainThread): Tracking: tracking
2021-10-06 16:10:05.426418 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d70a69a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d8b522b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d70b7190>]}
2021-10-06 16:10:05.479353 (MainThread): Partial parsing not enabled
2021-10-06 16:10:05.492670 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:10:05.504867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d70457c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d70cbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d70cbb20>]}
2021-10-06 16:10:05.509606 (MainThread): Flushing usage events
2021-10-06 16:10:06.072802 (MainThread): Encountered an error:
2021-10-06 16:10:06.082436 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  unexpected '%'
    line 14
      {% if s%%10 = 0 %}
2021-10-06 16:10:06.092763 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 14, in template
jinja2.exceptions.TemplateSyntaxError: unexpected '%'
  line 14
    {% if s%%10 = 0 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  unexpected '%'
    line 14
      {% if s%%10 = 0 %}

2021-10-06 16:10:24.344397 (MainThread): Running with dbt=0.19.0
2021-10-06 16:10:24.551343 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:10:24.561725 (MainThread): Tracking: tracking
2021-10-06 16:10:24.565055 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b0f4ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b29f6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b0f5d1f0>]}
2021-10-06 16:10:24.598046 (MainThread): Partial parsing not enabled
2021-10-06 16:10:24.610832 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:10:24.621649 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b0eebe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b0f71be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b0f71bb0>]}
2021-10-06 16:10:24.624934 (MainThread): Flushing usage events
2021-10-06 16:10:25.203228 (MainThread): Encountered an error:
2021-10-06 16:10:25.212285 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token 'end of statement block', got '='
    line 14
      {% if s%10 = 0 %}
2021-10-06 16:10:25.232401 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 14, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of statement block', got '='
  line 14
    {% if s%10 = 0 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token 'end of statement block', got '='
    line 14
      {% if s%10 = 0 %}

2021-10-06 16:10:41.886740 (MainThread): Running with dbt=0.19.0
2021-10-06 16:10:42.159440 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:10:42.176194 (MainThread): Tracking: tracking
2021-10-06 16:10:42.182849 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0761970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e218d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0773160>]}
2021-10-06 16:10:42.251464 (MainThread): Partial parsing not enabled
2021-10-06 16:10:42.263341 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:10:42.268733 (MainThread): Parsing macros/relations.sql
2021-10-06 16:10:42.280032 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:10:42.309853 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:10:42.315381 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:10:42.321670 (MainThread): Parsing macros/core.sql
2021-10-06 16:10:42.329079 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:10:42.381899 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:10:42.397202 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:10:42.406229 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:10:42.414623 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:10:42.435351 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:10:42.439872 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:10:42.472690 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:10:42.487964 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:10:42.510424 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:10:42.515147 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:10:42.524065 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:10:42.532952 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:10:42.536564 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:10:42.540791 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:10:42.554525 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:10:42.559066 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:10:42.563148 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:10:42.566440 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:10:42.570178 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:10:42.575519 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:10:42.579962 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:10:42.593492 (MainThread): Partial parsing not enabled
2021-10-06 16:10:42.633272 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:10:42.663693 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:10:42.674661 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e06c5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e0588eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4e05828b0>]}
2021-10-06 16:10:42.677142 (MainThread): Flushing usage events
2021-10-06 16:10:43.181735 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:10:43.185218 (MainThread): Encountered an error:
2021-10-06 16:10:43.188474 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-06 16:10:43.216874 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 24, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-06 16:12:15.230451 (MainThread): Running with dbt=0.19.0
2021-10-06 16:12:15.488032 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:12:15.502135 (MainThread): Tracking: tracking
2021-10-06 16:12:15.505690 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83d567bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83d8c823d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83d568c0a0>]}
2021-10-06 16:12:15.556826 (MainThread): Partial parsing not enabled
2021-10-06 16:12:15.569431 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:12:15.574014 (MainThread): Parsing macros/relations.sql
2021-10-06 16:12:15.578352 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:12:15.601933 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:12:15.611124 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:12:15.618919 (MainThread): Parsing macros/core.sql
2021-10-06 16:12:15.630030 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:12:15.678088 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:12:15.698809 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:12:15.710150 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:12:15.722659 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:12:15.751767 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:12:15.756888 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:12:15.836489 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:12:15.859533 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:12:15.895374 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:12:15.906790 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:12:15.919758 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:12:15.933053 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:12:15.937611 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:12:15.942691 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:12:15.957107 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:12:15.967251 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:12:15.972638 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:12:15.976741 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:12:15.981492 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:12:15.989671 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:12:15.994622 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:12:16.016048 (MainThread): Partial parsing not enabled
2021-10-06 16:12:16.073320 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:12:16.111301 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:12:16.125761 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83d55da790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83d54a9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83d549c850>]}
2021-10-06 16:12:16.128839 (MainThread): Flushing usage events
2021-10-06 16:12:16.677917 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:12:16.683508 (MainThread): Encountered an error:
2021-10-06 16:12:16.688619 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-06 16:12:16.702163 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 24, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-06 16:13:35.318517 (MainThread): Running with dbt=0.19.0
2021-10-06 16:13:35.552789 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:13:35.562300 (MainThread): Tracking: tracking
2021-10-06 16:13:35.565949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce5020910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce8627430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce5031100>]}
2021-10-06 16:13:35.598665 (MainThread): Partial parsing not enabled
2021-10-06 16:13:35.608028 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:13:35.622266 (MainThread): Parsing macros/relations.sql
2021-10-06 16:13:35.631640 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:13:35.660996 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:13:35.671999 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:13:35.681643 (MainThread): Parsing macros/core.sql
2021-10-06 16:13:35.689014 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:13:35.731943 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:13:35.743080 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:13:35.753104 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:13:35.760534 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:13:35.780501 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:13:35.785548 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:13:35.819560 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:13:35.837126 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:13:35.861585 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:13:35.867900 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:13:35.880840 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:13:35.897141 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:13:35.900880 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:13:35.904969 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:13:35.917908 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:13:35.923050 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:13:35.927509 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:13:35.931107 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:13:35.935321 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:13:35.940498 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:13:35.944588 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:13:35.960660 (MainThread): Partial parsing not enabled
2021-10-06 16:13:36.009301 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:13:36.039644 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:13:36.051414 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce4ff1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce4e51d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce4e42850>]}
2021-10-06 16:13:36.054096 (MainThread): Flushing usage events
2021-10-06 16:13:36.609890 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:13:36.618528 (MainThread): Encountered an error:
2021-10-06 16:13:36.623087 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-06 16:13:36.640937 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 24, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-06 16:14:03.256625 (MainThread): Running with dbt=0.19.0
2021-10-06 16:14:03.657703 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:14:03.672760 (MainThread): Tracking: tracking
2021-10-06 16:14:03.682243 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19c173910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19f779430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19c183100>]}
2021-10-06 16:14:03.761586 (MainThread): Partial parsing not enabled
2021-10-06 16:14:03.778765 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:14:03.797549 (MainThread): Parsing macros/relations.sql
2021-10-06 16:14:03.813088 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:14:03.861442 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:14:03.870241 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:14:03.879496 (MainThread): Parsing macros/core.sql
2021-10-06 16:14:03.893393 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:14:04.000409 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:14:04.029330 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:14:04.053915 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:14:04.069054 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:14:04.123117 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:14:04.135326 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:14:04.198638 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:14:04.222734 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:14:04.266606 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:14:04.277822 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:14:04.297468 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:14:04.320263 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:14:04.324350 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:14:04.330590 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:14:04.352259 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:14:04.360836 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:14:04.366221 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:14:04.370326 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:14:04.374972 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:14:04.382862 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:14:04.389523 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:14:04.416402 (MainThread): Partial parsing not enabled
2021-10-06 16:14:04.506934 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:14:04.543368 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:14:04.559239 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19c0d6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19bf9ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19bf94730>]}
2021-10-06 16:14:04.562387 (MainThread): Flushing usage events
2021-10-06 16:14:05.106034 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:14:05.111564 (MainThread): Encountered an error:
2021-10-06 16:14:05.116137 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-06 16:14:05.132546 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 26, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-06 16:15:44.088953 (MainThread): Running with dbt=0.19.0
2021-10-06 16:15:44.297848 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:15:44.314252 (MainThread): Tracking: tracking
2021-10-06 16:15:44.323109 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d145a5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d17bac430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d145b7100>]}
2021-10-06 16:15:44.381349 (MainThread): Partial parsing not enabled
2021-10-06 16:15:44.397519 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:15:44.410726 (MainThread): Parsing macros/relations.sql
2021-10-06 16:15:44.420224 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:15:44.450082 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:15:44.457549 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:15:44.466535 (MainThread): Parsing macros/core.sql
2021-10-06 16:15:44.477670 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:15:44.536376 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:15:44.549947 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:15:44.560649 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:15:44.568720 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:15:44.589046 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:15:44.593454 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:15:44.626296 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:15:44.643635 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:15:44.666164 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:15:44.670446 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:15:44.678541 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:15:44.689068 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:15:44.692592 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:15:44.697311 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:15:44.710121 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:15:44.716489 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:15:44.724079 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:15:44.729639 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:15:44.737640 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:15:44.748179 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:15:44.755383 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:15:44.781040 (MainThread): Partial parsing not enabled
2021-10-06 16:15:44.857636 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:15:44.915880 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:15:44.927362 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d1455a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d143cdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d143c4400>]}
2021-10-06 16:15:44.929941 (MainThread): Flushing usage events
2021-10-06 16:15:45.463895 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:15:45.471011 (MainThread): Encountered an error:
2021-10-06 16:15:45.476610 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-06 16:15:45.491229 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 26, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-06 16:16:23.983194 (MainThread): Running with dbt=0.19.0
2021-10-06 16:16:24.304866 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:16:24.315122 (MainThread): Tracking: tracking
2021-10-06 16:16:24.320111 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0cc7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a42cd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0cd70d0>]}
2021-10-06 16:16:24.353129 (MainThread): Partial parsing not enabled
2021-10-06 16:16:24.363846 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:16:24.373750 (MainThread): Parsing macros/relations.sql
2021-10-06 16:16:24.378556 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:16:24.402384 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:16:24.407826 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:16:24.420803 (MainThread): Parsing macros/core.sql
2021-10-06 16:16:24.429716 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:16:24.482600 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:16:24.493504 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:16:24.503109 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:16:24.510655 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:16:24.531499 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:16:24.536261 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:16:24.569763 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:16:24.587190 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:16:24.611265 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:16:24.615809 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:16:24.625784 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:16:24.634932 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:16:24.638617 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:16:24.642988 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:16:24.656767 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:16:24.665483 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:16:24.670171 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:16:24.673353 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:16:24.678632 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:16:24.683803 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:16:24.687963 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:16:24.703440 (MainThread): Partial parsing not enabled
2021-10-06 16:16:24.753614 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:16:24.781367 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:16:24.791376 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0c296a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0af3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0ae53d0>]}
2021-10-06 16:16:24.793401 (MainThread): Flushing usage events
2021-10-06 16:16:25.294917 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:16:25.301892 (MainThread): Encountered an error:
2021-10-06 16:16:25.307335 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-06 16:16:25.325315 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 26, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-06 16:17:10.885013 (MainThread): Running with dbt=0.19.0
2021-10-06 16:17:11.142247 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:17:11.156447 (MainThread): Tracking: tracking
2021-10-06 16:17:11.165208 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f4b899940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f4ee9f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f4b8a9130>]}
2021-10-06 16:17:11.235149 (MainThread): Partial parsing not enabled
2021-10-06 16:17:11.250358 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:17:11.256435 (MainThread): Parsing macros/relations.sql
2021-10-06 16:17:11.261672 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:17:11.290622 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:17:11.297015 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:17:11.302570 (MainThread): Parsing macros/core.sql
2021-10-06 16:17:11.313663 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:17:11.366634 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:17:11.377933 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:17:11.388921 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:17:11.398357 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:17:11.423017 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:17:11.428082 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:17:11.468955 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:17:11.488275 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:17:11.524986 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:17:11.529666 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:17:11.542295 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:17:11.560225 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:17:11.571217 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:17:11.582359 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:17:11.597941 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:17:11.615356 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:17:11.635436 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:17:11.640508 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:17:11.647130 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:17:11.655380 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:17:11.663268 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:17:11.697348 (MainThread): Partial parsing not enabled
2021-10-06 16:17:11.757960 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:17:11.791328 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:17:11.805136 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f4b7fb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f4b6bfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f4b6b9760>]}
2021-10-06 16:17:11.807635 (MainThread): Flushing usage events
2021-10-06 16:17:12.394692 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:17:12.405391 (MainThread): Encountered an error:
2021-10-06 16:17:12.413193 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'digit' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-06 16:17:12.447957 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'digit' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'digit' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-06 16:17:36.680984 (MainThread): Running with dbt=0.19.0
2021-10-06 16:17:36.964709 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:17:36.979415 (MainThread): Tracking: tracking
2021-10-06 16:17:36.984375 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff654fc29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff656a6d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff654fd4190>]}
2021-10-06 16:17:37.019600 (MainThread): Partial parsing not enabled
2021-10-06 16:17:37.033238 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:17:37.046174 (MainThread): Parsing macros/relations.sql
2021-10-06 16:17:37.056031 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:17:37.091559 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:17:37.098106 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:17:37.105424 (MainThread): Parsing macros/core.sql
2021-10-06 16:17:37.114212 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:17:37.162291 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:17:37.179826 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:17:37.191993 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:17:37.199379 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:17:37.223122 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:17:37.228445 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:17:37.260564 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:17:37.277866 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:17:37.301678 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:17:37.305836 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:17:37.314883 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:17:37.324519 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:17:37.328379 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:17:37.332890 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:17:37.344426 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:17:37.351280 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:17:37.361681 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:17:37.365424 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:17:37.370048 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:17:37.375889 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:17:37.380380 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:17:37.396748 (MainThread): Partial parsing not enabled
2021-10-06 16:17:37.438142 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:17:37.469637 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:17:37.480865 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff654f8ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff654deaee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff654de1490>]}
2021-10-06 16:17:37.484385 (MainThread): Flushing usage events
2021-10-06 16:17:38.005778 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:17:38.014146 (MainThread): Encountered an error:
2021-10-06 16:17:38.020167 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'digit' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-06 16:17:38.044266 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'digit' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'digit' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-06 16:18:54.907693 (MainThread): Running with dbt=0.19.0
2021-10-06 16:18:55.215279 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:18:55.225700 (MainThread): Tracking: tracking
2021-10-06 16:18:55.229387 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7e20a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8180f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7e219130>]}
2021-10-06 16:18:55.259438 (MainThread): Partial parsing not enabled
2021-10-06 16:18:55.274364 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:18:55.282455 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7e1a67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7e22cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7e22cdc0>]}
2021-10-06 16:18:55.286271 (MainThread): Flushing usage events
2021-10-06 16:18:55.876623 (MainThread): Encountered an error:
2021-10-06 16:18:55.885685 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {%- set cc = {{credcard}}::numeric %}
2021-10-06 16:18:55.902811 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {%- set cc = {{credcard}}::numeric %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {%- set cc = {{credcard}}::numeric %}

2021-10-06 16:19:18.909310 (MainThread): Running with dbt=0.19.0
2021-10-06 16:19:19.222870 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:19:19.234058 (MainThread): Tracking: tracking
2021-10-06 16:19:19.240364 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090cc9c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09102a3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090ccad130>]}
2021-10-06 16:19:19.290897 (MainThread): Partial parsing not enabled
2021-10-06 16:19:19.303849 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:19:19.311790 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090cc3a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090ccc0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090ccc0dc0>]}
2021-10-06 16:19:19.315797 (MainThread): Flushing usage events
2021-10-06 16:19:19.896480 (MainThread): Encountered an error:
2021-10-06 16:19:19.910134 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  Encountered unknown tag 'cc'. Jinja was looking for the following tags: 'endmacro'. The innermost block that needs to be closed is 'macro'.
    line 2
      {%- cc = {{credcard}}::numeric %}
2021-10-06 16:19:19.928261 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: Encountered unknown tag 'cc'. Jinja was looking for the following tags: 'endmacro'. The innermost block that needs to be closed is 'macro'.
  line 2
    {%- cc = {{credcard}}::numeric %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  Encountered unknown tag 'cc'. Jinja was looking for the following tags: 'endmacro'. The innermost block that needs to be closed is 'macro'.
    line 2
      {%- cc = {{credcard}}::numeric %}

2021-10-06 16:20:38.194704 (MainThread): Running with dbt=0.19.0
2021-10-06 16:20:38.430841 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:20:38.440663 (MainThread): Tracking: tracking
2021-10-06 16:20:38.443734 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3d704fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb40d0a3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3d715070>]}
2021-10-06 16:20:38.473984 (MainThread): Partial parsing not enabled
2021-10-06 16:20:38.485583 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:20:38.492116 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3d6a1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3d722640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3d722f70>]}
2021-10-06 16:20:38.495678 (MainThread): Flushing usage events
2021-10-06 16:20:39.051656 (MainThread): Encountered an error:
2021-10-06 16:20:39.058397 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {%- set cc = {{credcard}}::numeric %}
2021-10-06 16:20:39.071267 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {%- set cc = {{credcard}}::numeric %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {%- set cc = {{credcard}}::numeric %}

2021-10-06 16:21:48.193763 (MainThread): Running with dbt=0.19.0
2021-10-06 16:21:48.464002 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:21:48.475215 (MainThread): Tracking: tracking
2021-10-06 16:21:48.481153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960d46fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896434d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960d570a0>]}
2021-10-06 16:21:48.528812 (MainThread): Partial parsing not enabled
2021-10-06 16:21:48.544567 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:21:48.553773 (MainThread): Parsing macros/relations.sql
2021-10-06 16:21:48.564647 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:21:48.596813 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:21:48.601934 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:21:48.608373 (MainThread): Parsing macros/core.sql
2021-10-06 16:21:48.626029 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:21:48.710913 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:21:48.733535 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:21:48.756260 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:21:48.774972 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:21:48.805844 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:21:48.816069 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:21:48.854431 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:21:48.876127 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:21:48.907322 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:21:48.912875 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:21:48.924160 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:21:48.934316 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:21:48.938158 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:21:48.942401 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:21:48.953387 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:21:48.957963 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:21:48.962094 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:21:48.965140 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:21:48.969259 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:21:48.974876 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:21:48.979053 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:21:48.992144 (MainThread): Partial parsing not enabled
2021-10-06 16:21:49.031077 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:21:49.060543 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:21:49.086138 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:21:49.280921 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:21:49.298298 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fcdf2b0-72ce-4eee-9688-2deab6434b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960c0e790>]}
2021-10-06 16:21:49.357385 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:21:49.360982 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 16:21:49.364395 (MainThread): 
2021-10-06 16:21:49.368790 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:21:49.375470 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:21:49.393135 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:21:49.395649 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:21:49.398027 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:21:49.421448 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 16:21:49.427983 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:21:49.436154 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:21:49.448029 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:21:49.450775 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:21:49.453196 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 16:21:49.467806 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:21:49.471033 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:21:49.474690 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:21:49.489110 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 16:21:49.508562 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:21:49.512119 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:21:49.534948 (MainThread): Using postgres connection "master".
2021-10-06 16:21:49.537229 (MainThread): On master: BEGIN
2021-10-06 16:21:49.539476 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:21:49.549224 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:21:49.553353 (MainThread): Using postgres connection "master".
2021-10-06 16:21:49.557355 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:21:49.573736 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:21:49.581933 (MainThread): On master: ROLLBACK
2021-10-06 16:21:49.584781 (MainThread): Using postgres connection "master".
2021-10-06 16:21:49.587597 (MainThread): On master: BEGIN
2021-10-06 16:21:49.592355 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:21:49.595297 (MainThread): On master: COMMIT
2021-10-06 16:21:49.600040 (MainThread): Using postgres connection "master".
2021-10-06 16:21:49.602742 (MainThread): On master: COMMIT
2021-10-06 16:21:49.606181 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:21:49.609271 (MainThread): On master: Close
2021-10-06 16:21:49.614176 (MainThread): 16:21:49 | Concurrency: 2 threads (target='dev')
2021-10-06 16:21:49.616758 (MainThread): 16:21:49 | 
2021-10-06 16:21:49.628239 (Thread-1): Began running node model.my_new_project.firstnames
2021-10-06 16:21:49.634128 (Thread-1): 16:21:49 | 1 of 2 START table model public.firstnames........................... [RUN]
2021-10-06 16:21:49.628695 (Thread-2): Began running node model.my_new_project.lostamounts
2021-10-06 16:21:49.644218 (Thread-2): 16:21:49 | 2 of 2 START view model public.lostamounts........................... [RUN]
2021-10-06 16:21:49.649062 (Thread-2): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:21:49.660401 (Thread-2): Compiling model.my_new_project.lostamounts
2021-10-06 16:21:49.640149 (Thread-1): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:21:49.689318 (Thread-1): Compiling model.my_new_project.firstnames
2021-10-06 16:21:49.710224 (Thread-2): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:21:49.714123 (Thread-1): Writing injected SQL for node "model.my_new_project.firstnames"
2021-10-06 16:21:49.725224 (Thread-2): finished collecting timing info
2021-10-06 16:21:49.738962 (Thread-1): finished collecting timing info
2021-10-06 16:21:49.791744 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:21:49.794937 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:21:49.796252 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_tmp" cascade
2021-10-06 16:21:49.798678 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:21:49.801043 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:21:49.803293 (Thread-2): Opening a new connection, currently in state closed
2021-10-06 16:21:49.814505 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 16:21:49.819802 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:21:49.815675 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:21:49.826940 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:21:49.822192 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 16:21:49.829206 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:21:49.832445 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 16:21:49.834290 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:21:49.851160 (Thread-2): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:21:49.842693 (Thread-1): Writing runtime SQL for node "model.my_new_project.firstnames"
2021-10-06 16:21:49.859313 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:21:49.862562 (Thread-2): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:21:49.863349 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:21:49.868156 (Thread-1): On model.my_new_project.firstnames: BEGIN
2021-10-06 16:21:49.866513 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:21:49.871531 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:21:49.875331 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:21:49.880730 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:21:49.884561 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
    
    
    
    
    
    
    
    
    
    
    
     
    as LuhnCC, 
    sum(o.totalamount) as Lost_Sum
from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:21:49.888321 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */


  create  table "dellstore"."public"."firstnames__dbt_tmp"
  as (
    -- 1) TASK
-- Requirements:
-- create a table with following columns:
-- first name of the actor/actress
-- number of movies where such first name has been an actor
-- sum of the price of the movies where such first name has been an actor

-- Use dbt - models, sources, snapshotting
-- try inserting a new row into the products table + running the snapshot again

-- table


-- select
select first_name as id, count(distinct title) title_count, sum(price) price_sum from "dellstore"."public"."products" p
join (
	select distinct concat(split_part(actor, ' ', 1),'%') first_name from "dellstore"."public"."products"
) b
on p.actor like b.first_name
group by 1
order by 1


-- changes I tried with results in snapshot:

-- insert into products
-- values (0, 2, 'NO SUCH MOVIE', 'AAPO EESTLANE', 100.00, 0, 6633)
-- -- new row was added to snapshot

-- update products
-- set price = 1.22
-- where prod_id = 392
-- -- price_sum changed in snapshot

-- delete from products
-- where prod_id = 392
-- -- title_count (also price_sum) changed in snapshot
  );
2021-10-06 16:21:49.892483 (Thread-2): Postgres error: syntax error at or near "as"
LINE 19:     as LuhnCC, 
             ^

2021-10-06 16:21:49.900988 (Thread-2): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:21:49.906458 (Thread-2): finished collecting timing info
2021-10-06 16:21:49.915119 (Thread-2): On model.my_new_project.lostamounts: Close
2021-10-06 16:21:49.919413 (Thread-2): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "as"
  LINE 19:     as LuhnCC, 
               ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "as"
LINE 19:     as LuhnCC, 
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "as"
  LINE 19:     as LuhnCC, 
               ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:21:49.928915 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcdf2b0-72ce-4eee-9688-2deab6434b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960c3dee0>]}
2021-10-06 16:21:49.933230 (Thread-2): 16:21:49 | 2 of 2 ERROR creating view model public.lostamounts.................. [ERROR in 0.28s]
2021-10-06 16:21:49.937951 (Thread-2): Finished running node model.my_new_project.lostamounts
2021-10-06 16:21:50.233917 (Thread-1): SQL status: SELECT 201 in 0.34 seconds
2021-10-06 16:21:50.247890 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:21:50.250670 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames" rename to "firstnames__dbt_backup"
2021-10-06 16:21:50.256058 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:21:50.263445 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:21:50.266396 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames__dbt_tmp" rename to "firstnames"
2021-10-06 16:21:50.269969 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:21:50.286395 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 16:21:50.289414 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:21:50.292689 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 16:21:50.299977 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:21:50.309838 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:21:50.313462 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 16:21:50.340986 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-10-06 16:21:50.347114 (Thread-1): finished collecting timing info
2021-10-06 16:21:50.350213 (Thread-1): On model.my_new_project.firstnames: Close
2021-10-06 16:21:50.354338 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcdf2b0-72ce-4eee-9688-2deab6434b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960c34be0>]}
2021-10-06 16:21:50.358838 (Thread-1): 16:21:50 | 1 of 2 OK created table model public.firstnames...................... [SELECT 201 in 0.71s]
2021-10-06 16:21:50.361509 (Thread-1): Finished running node model.my_new_project.firstnames
2021-10-06 16:21:50.370041 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:21:50.375504 (MainThread): Using postgres connection "master".
2021-10-06 16:21:50.381411 (MainThread): On master: BEGIN
2021-10-06 16:21:50.384539 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:21:50.396441 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:21:50.400315 (MainThread): On master: COMMIT
2021-10-06 16:21:50.403552 (MainThread): Using postgres connection "master".
2021-10-06 16:21:50.407655 (MainThread): On master: COMMIT
2021-10-06 16:21:50.412200 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:21:50.417580 (MainThread): On master: Close
2021-10-06 16:21:50.421855 (MainThread): 16:21:50 | 
2021-10-06 16:21:50.426155 (MainThread): 16:21:50 | Finished running 1 view model, 1 table model in 1.05s.
2021-10-06 16:21:50.433952 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:21:50.439120 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:21:50.443361 (MainThread): Connection 'model.my_new_project.firstnames' was properly closed.
2021-10-06 16:21:50.539620 (MainThread): 
2021-10-06 16:21:50.546433 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:21:50.561898 (MainThread): 
2021-10-06 16:21:50.573199 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:21:50.579363 (MainThread):   syntax error at or near "as"
2021-10-06 16:21:50.586628 (MainThread):   LINE 19:     as LuhnCC, 
2021-10-06 16:21:50.592969 (MainThread):                ^
2021-10-06 16:21:50.597228 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:21:50.606989 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-10-06 16:21:50.615292 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960c280a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960aeceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89602900d0>]}
2021-10-06 16:21:50.624039 (MainThread): Flushing usage events
2021-10-06 16:22:38.033281 (MainThread): Running with dbt=0.19.0
2021-10-06 16:22:38.266119 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:22:38.280462 (MainThread): Tracking: tracking
2021-10-06 16:22:38.286191 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4598f23a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459a9cd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4598f34220>]}
2021-10-06 16:22:38.338990 (MainThread): Partial parsing not enabled
2021-10-06 16:22:38.349424 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:22:38.353336 (MainThread): Parsing macros/relations.sql
2021-10-06 16:22:38.357356 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:22:38.381019 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:22:38.385752 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:22:38.390755 (MainThread): Parsing macros/core.sql
2021-10-06 16:22:38.403879 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:22:38.465428 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:22:38.488909 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:22:38.505906 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:22:38.518832 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:22:38.551046 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:22:38.562003 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:22:38.611799 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:22:38.634635 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:22:38.698649 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:22:38.705927 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:22:38.718753 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:22:38.733654 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:22:38.742798 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:22:38.753789 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:22:38.772268 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:22:38.779408 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:22:38.785261 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:22:38.789969 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:22:38.796609 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:22:38.804358 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:22:38.810370 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:22:38.832776 (MainThread): Partial parsing not enabled
2021-10-06 16:22:38.893955 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:22:38.946796 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:22:38.983404 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:22:39.176577 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:22:39.190657 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9b3bb59-9efd-47e7-8e6c-7f2fc4df85ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4598e357f0>]}
2021-10-06 16:22:39.235894 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:22:39.240117 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 16:22:39.245205 (MainThread): 
2021-10-06 16:22:39.253209 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:22:39.260686 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:22:39.282875 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:22:39.285380 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:22:39.287287 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:22:39.295724 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 16:22:39.300361 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:22:39.308550 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:22:39.318401 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:22:39.320781 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:22:39.322765 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:22:39.330534 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:22:39.333156 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:22:39.335947 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:22:39.342885 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:22:39.360287 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:22:39.362691 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:22:39.375189 (MainThread): Using postgres connection "master".
2021-10-06 16:22:39.378364 (MainThread): On master: BEGIN
2021-10-06 16:22:39.380912 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:22:39.389413 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:22:39.393210 (MainThread): Using postgres connection "master".
2021-10-06 16:22:39.398012 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:22:39.411107 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:22:39.420273 (MainThread): On master: ROLLBACK
2021-10-06 16:22:39.423862 (MainThread): Using postgres connection "master".
2021-10-06 16:22:39.426532 (MainThread): On master: BEGIN
2021-10-06 16:22:39.430862 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:22:39.434287 (MainThread): On master: COMMIT
2021-10-06 16:22:39.438377 (MainThread): Using postgres connection "master".
2021-10-06 16:22:39.442116 (MainThread): On master: COMMIT
2021-10-06 16:22:39.446270 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:22:39.448810 (MainThread): On master: Close
2021-10-06 16:22:39.452450 (MainThread): 16:22:39 | Concurrency: 2 threads (target='dev')
2021-10-06 16:22:39.456962 (MainThread): 16:22:39 | 
2021-10-06 16:22:39.472762 (Thread-1): Began running node model.my_new_project.firstnames
2021-10-06 16:22:39.476783 (Thread-1): 16:22:39 | 1 of 2 START table model public.firstnames........................... [RUN]
2021-10-06 16:22:39.473383 (Thread-2): Began running node model.my_new_project.lostamounts
2021-10-06 16:22:39.500042 (Thread-1): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:22:39.505568 (Thread-1): Compiling model.my_new_project.firstnames
2021-10-06 16:22:39.503195 (Thread-2): 16:22:39 | 2 of 2 START view model public.lostamounts........................... [RUN]
2021-10-06 16:22:39.532551 (Thread-2): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:22:39.543578 (Thread-2): Compiling model.my_new_project.lostamounts
2021-10-06 16:22:39.542253 (Thread-1): Writing injected SQL for node "model.my_new_project.firstnames"
2021-10-06 16:22:39.557268 (Thread-2): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:22:39.574384 (Thread-1): finished collecting timing info
2021-10-06 16:22:39.576012 (Thread-2): finished collecting timing info
2021-10-06 16:22:39.680121 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:22:39.715102 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:22:39.702769 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_tmp" cascade
2021-10-06 16:22:39.717788 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:22:39.721417 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:22:39.733235 (Thread-2): Opening a new connection, currently in state init
2021-10-06 16:22:39.751747 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-10-06 16:22:39.756599 (Thread-2): SQL status: DROP VIEW in 0.02 seconds
2021-10-06 16:22:39.774967 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:22:39.784338 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:22:39.788634 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 16:22:39.793457 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:22:39.801650 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 16:22:39.807618 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:22:39.823638 (Thread-1): Writing runtime SQL for node "model.my_new_project.firstnames"
2021-10-06 16:22:39.832336 (Thread-2): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:22:39.846811 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:22:39.848380 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:22:39.853466 (Thread-2): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:22:39.850342 (Thread-1): On model.my_new_project.firstnames: BEGIN
2021-10-06 16:22:39.855990 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:22:39.859857 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:22:39.862890 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:22:39.866816 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:22:39.870329 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
     
    as LuhnCC, 
    sum(o.totalamount) as Lost_Sum
from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:22:39.873161 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */


  create  table "dellstore"."public"."firstnames__dbt_tmp"
  as (
    -- 1) TASK
-- Requirements:
-- create a table with following columns:
-- first name of the actor/actress
-- number of movies where such first name has been an actor
-- sum of the price of the movies where such first name has been an actor

-- Use dbt - models, sources, snapshotting
-- try inserting a new row into the products table + running the snapshot again

-- table


-- select
select first_name as id, count(distinct title) title_count, sum(price) price_sum from "dellstore"."public"."products" p
join (
	select distinct concat(split_part(actor, ' ', 1),'%') first_name from "dellstore"."public"."products"
) b
on p.actor like b.first_name
group by 1
order by 1


-- changes I tried with results in snapshot:

-- insert into products
-- values (0, 2, 'NO SUCH MOVIE', 'AAPO EESTLANE', 100.00, 0, 6633)
-- -- new row was added to snapshot

-- update products
-- set price = 1.22
-- where prod_id = 392
-- -- price_sum changed in snapshot

-- delete from products
-- where prod_id = 392
-- -- title_count (also price_sum) changed in snapshot
  );
2021-10-06 16:22:39.876666 (Thread-2): Postgres error: syntax error at or near "="
LINE 9:         i = i+1
                  ^

2021-10-06 16:22:39.893054 (Thread-2): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:22:39.896595 (Thread-2): finished collecting timing info
2021-10-06 16:22:39.899351 (Thread-2): On model.my_new_project.lostamounts: Close
2021-10-06 16:22:39.904672 (Thread-2): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "="
  LINE 9:         i = i+1
                    ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "="
LINE 9:         i = i+1
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "="
  LINE 9:         i = i+1
                    ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:22:39.913031 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9b3bb59-9efd-47e7-8e6c-7f2fc4df85ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4598416340>]}
2021-10-06 16:22:39.919095 (Thread-2): 16:22:39 | 2 of 2 ERROR creating view model public.lostamounts.................. [ERROR in 0.38s]
2021-10-06 16:22:39.924842 (Thread-2): Finished running node model.my_new_project.lostamounts
2021-10-06 16:22:40.110473 (Thread-1): SQL status: SELECT 201 in 0.23 seconds
2021-10-06 16:22:40.129901 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:22:40.133317 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames" rename to "firstnames__dbt_backup"
2021-10-06 16:22:40.139823 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:22:40.154708 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:22:40.159436 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames__dbt_tmp" rename to "firstnames"
2021-10-06 16:22:40.165699 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:22:40.182569 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 16:22:40.185616 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:22:40.187594 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 16:22:40.191441 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:22:40.197598 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:22:40.200386 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 16:22:40.208822 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 16:22:40.219060 (Thread-1): finished collecting timing info
2021-10-06 16:22:40.222430 (Thread-1): On model.my_new_project.firstnames: Close
2021-10-06 16:22:40.225287 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9b3bb59-9efd-47e7-8e6c-7f2fc4df85ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4598409910>]}
2021-10-06 16:22:40.234671 (Thread-1): 16:22:40 | 1 of 2 OK created table model public.firstnames...................... [SELECT 201 in 0.73s]
2021-10-06 16:22:40.237493 (Thread-1): Finished running node model.my_new_project.firstnames
2021-10-06 16:22:40.244584 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:22:40.247626 (MainThread): Using postgres connection "master".
2021-10-06 16:22:40.249621 (MainThread): On master: BEGIN
2021-10-06 16:22:40.251951 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:22:40.261855 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:22:40.265185 (MainThread): On master: COMMIT
2021-10-06 16:22:40.268970 (MainThread): Using postgres connection "master".
2021-10-06 16:22:40.272329 (MainThread): On master: COMMIT
2021-10-06 16:22:40.275511 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:22:40.278836 (MainThread): On master: Close
2021-10-06 16:22:40.282719 (MainThread): 16:22:40 | 
2021-10-06 16:22:40.285936 (MainThread): 16:22:40 | Finished running 1 view model, 1 table model in 1.03s.
2021-10-06 16:22:40.290346 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:22:40.295449 (MainThread): Connection 'model.my_new_project.firstnames' was properly closed.
2021-10-06 16:22:40.298715 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:22:40.362248 (MainThread): 
2021-10-06 16:22:40.365226 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:22:40.369361 (MainThread): 
2021-10-06 16:22:40.374644 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:22:40.380342 (MainThread):   syntax error at or near "="
2021-10-06 16:22:40.384880 (MainThread):   LINE 9:         i = i+1
2021-10-06 16:22:40.391174 (MainThread):                     ^
2021-10-06 16:22:40.398434 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:22:40.401730 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-10-06 16:22:40.405662 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459841ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4598d4ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45984272e0>]}
2021-10-06 16:22:40.412433 (MainThread): Flushing usage events
2021-10-06 16:23:11.389701 (MainThread): Running with dbt=0.19.0
2021-10-06 16:23:11.618430 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:23:11.629484 (MainThread): Tracking: tracking
2021-10-06 16:23:11.639938 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d1d8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23607df3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d1ea070>]}
2021-10-06 16:23:11.707865 (MainThread): Partial parsing not enabled
2021-10-06 16:23:11.720715 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:23:11.725394 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d176760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d1fc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d1fcf70>]}
2021-10-06 16:23:11.728759 (MainThread): Flushing usage events
2021-10-06 16:23:12.227288 (MainThread): Encountered an error:
2021-10-06 16:23:12.234570 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  Encountered unknown tag 'return'. Jinja was looking for the following tags: 'endmacro'. The innermost block that needs to be closed is 'macro'.
    line 5
      {% return(i) %}
2021-10-06 16:23:12.253000 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 5, in template
jinja2.exceptions.TemplateSyntaxError: Encountered unknown tag 'return'. Jinja was looking for the following tags: 'endmacro'. The innermost block that needs to be closed is 'macro'.
  line 5
    {% return(i) %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  Encountered unknown tag 'return'. Jinja was looking for the following tags: 'endmacro'. The innermost block that needs to be closed is 'macro'.
    line 5
      {% return(i) %}

2021-10-06 16:23:33.128118 (MainThread): Running with dbt=0.19.0
2021-10-06 16:23:33.422800 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:23:33.433752 (MainThread): Tracking: tracking
2021-10-06 16:23:33.437820 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb735efbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7395023d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb735f0d0a0>]}
2021-10-06 16:23:33.538214 (MainThread): Partial parsing not enabled
2021-10-06 16:23:33.549619 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:23:33.558221 (MainThread): Parsing macros/relations.sql
2021-10-06 16:23:33.578866 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:23:33.609338 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:23:33.622969 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:23:33.631421 (MainThread): Parsing macros/core.sql
2021-10-06 16:23:33.639342 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:23:33.693671 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:23:33.707677 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:23:33.718170 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:23:33.728726 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:23:33.754189 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:23:33.758757 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:23:33.794984 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:23:33.816810 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:23:33.847987 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:23:33.855358 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:23:33.877735 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:23:33.888853 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:23:33.899176 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:23:33.903651 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:23:33.915334 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:23:33.922563 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:23:33.935283 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:23:33.944204 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:23:33.951823 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:23:33.959890 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:23:33.965218 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:23:33.991758 (MainThread): Partial parsing not enabled
2021-10-06 16:23:34.048482 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:34.089913 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:34.112165 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:23:34.311895 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:23:34.322401 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '872f038a-f836-43f9-bed4-0302f004cb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb735dfc0d0>]}
2021-10-06 16:23:34.384570 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:23:34.388424 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 16:23:34.393140 (MainThread): 
2021-10-06 16:23:34.397225 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:23:34.404099 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:23:34.428286 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:23:34.431501 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:23:34.433419 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:23:34.446156 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 16:23:34.450700 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:23:34.460831 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:23:34.476124 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:23:34.478719 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:23:34.481364 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:23:34.490762 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:23:34.494405 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:23:34.499056 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:23:34.505378 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:23:34.525062 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:23:34.528695 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:23:34.541730 (MainThread): Using postgres connection "master".
2021-10-06 16:23:34.544368 (MainThread): On master: BEGIN
2021-10-06 16:23:34.546436 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:23:34.553724 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:23:34.557646 (MainThread): Using postgres connection "master".
2021-10-06 16:23:34.562246 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:23:34.579229 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:23:34.585238 (MainThread): On master: ROLLBACK
2021-10-06 16:23:34.587737 (MainThread): Using postgres connection "master".
2021-10-06 16:23:34.590201 (MainThread): On master: BEGIN
2021-10-06 16:23:34.595388 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:23:34.598944 (MainThread): On master: COMMIT
2021-10-06 16:23:34.603368 (MainThread): Using postgres connection "master".
2021-10-06 16:23:34.605849 (MainThread): On master: COMMIT
2021-10-06 16:23:34.609275 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:23:34.613542 (MainThread): On master: Close
2021-10-06 16:23:34.617745 (MainThread): 16:23:34 | Concurrency: 2 threads (target='dev')
2021-10-06 16:23:34.620550 (MainThread): 16:23:34 | 
2021-10-06 16:23:34.629648 (Thread-1): Began running node model.my_new_project.firstnames
2021-10-06 16:23:34.633632 (Thread-1): 16:23:34 | 1 of 2 START table model public.firstnames........................... [RUN]
2021-10-06 16:23:34.630179 (Thread-2): Began running node model.my_new_project.lostamounts
2021-10-06 16:23:34.640733 (Thread-2): 16:23:34 | 2 of 2 START view model public.lostamounts........................... [RUN]
2021-10-06 16:23:34.636292 (Thread-1): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:34.648212 (Thread-1): Compiling model.my_new_project.firstnames
2021-10-06 16:23:34.644975 (Thread-2): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:34.678553 (Thread-2): Compiling model.my_new_project.lostamounts
2021-10-06 16:23:34.689486 (Thread-1): Writing injected SQL for node "model.my_new_project.firstnames"
2021-10-06 16:23:34.700640 (Thread-2): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:23:34.710786 (Thread-1): finished collecting timing info
2021-10-06 16:23:34.734176 (Thread-2): finished collecting timing info
2021-10-06 16:23:34.765469 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:34.777386 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:34.777902 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_tmp" cascade
2021-10-06 16:23:34.783236 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:23:34.780688 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:23:34.790296 (Thread-2): Opening a new connection, currently in state init
2021-10-06 16:23:34.790937 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 16:23:34.799590 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:34.802984 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 16:23:34.804546 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:23:34.806910 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 16:23:34.814670 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:34.836527 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:23:34.829545 (Thread-1): Writing runtime SQL for node "model.my_new_project.firstnames"
2021-10-06 16:23:34.840885 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:23:34.858676 (Thread-2): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:23:34.861362 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:34.881959 (Thread-1): On model.my_new_project.firstnames: BEGIN
2021-10-06 16:23:34.885765 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:23:34.889846 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:34.894550 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */


  create  table "dellstore"."public"."firstnames__dbt_tmp"
  as (
    -- 1) TASK
-- Requirements:
-- create a table with following columns:
-- first name of the actor/actress
-- number of movies where such first name has been an actor
-- sum of the price of the movies where such first name has been an actor

-- Use dbt - models, sources, snapshotting
-- try inserting a new row into the products table + running the snapshot again

-- table


-- select
select first_name as id, count(distinct title) title_count, sum(price) price_sum from "dellstore"."public"."products" p
join (
	select distinct concat(split_part(actor, ' ', 1),'%') first_name from "dellstore"."public"."products"
) b
on p.actor like b.first_name
group by 1
order by 1


-- changes I tried with results in snapshot:

-- insert into products
-- values (0, 2, 'NO SUCH MOVIE', 'AAPO EESTLANE', 100.00, 0, 6633)
-- -- new row was added to snapshot

-- update products
-- set price = 1.22
-- where prod_id = 392
-- -- price_sum changed in snapshot

-- delete from products
-- where prod_id = 392
-- -- title_count (also price_sum) changed in snapshot
  );
2021-10-06 16:23:34.887331 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:34.903475 (Thread-2): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:23:34.911259 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:23:34.925589 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:34.930546 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    return(i)
 
    as LuhnCC, 
    sum(o.totalamount) as Lost_Sum
from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:23:34.936845 (Thread-2): Postgres error: syntax error at or near "="
LINE 9:         i = i+1
                  ^

2021-10-06 16:23:34.944437 (Thread-2): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:23:34.949456 (Thread-2): finished collecting timing info
2021-10-06 16:23:34.952416 (Thread-2): On model.my_new_project.lostamounts: Close
2021-10-06 16:23:34.955129 (Thread-2): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "="
  LINE 9:         i = i+1
                    ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "="
LINE 9:         i = i+1
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "="
  LINE 9:         i = i+1
                    ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:23:34.984101 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '872f038a-f836-43f9-bed4-0302f004cb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb735d28b80>]}
2021-10-06 16:23:34.987702 (Thread-2): 16:23:34 | 2 of 2 ERROR creating view model public.lostamounts.................. [ERROR in 0.34s]
2021-10-06 16:23:34.990309 (Thread-2): Finished running node model.my_new_project.lostamounts
2021-10-06 16:23:35.161728 (Thread-1): SQL status: SELECT 201 in 0.26 seconds
2021-10-06 16:23:35.172311 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:35.174570 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames" rename to "firstnames__dbt_backup"
2021-10-06 16:23:35.178025 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:23:35.183799 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:35.185843 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames__dbt_tmp" rename to "firstnames"
2021-10-06 16:23:35.190317 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:23:35.200399 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 16:23:35.202867 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:35.205563 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-06 16:23:35.208898 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:23:35.214781 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:35.216925 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-06 16:23:35.223890 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 16:23:35.228903 (Thread-1): finished collecting timing info
2021-10-06 16:23:35.231735 (Thread-1): On model.my_new_project.firstnames: Close
2021-10-06 16:23:35.235853 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '872f038a-f836-43f9-bed4-0302f004cb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb735dc1a90>]}
2021-10-06 16:23:35.240122 (Thread-1): 16:23:35 | 1 of 2 OK created table model public.firstnames...................... [SELECT 201 in 0.60s]
2021-10-06 16:23:35.242871 (Thread-1): Finished running node model.my_new_project.firstnames
2021-10-06 16:23:35.251282 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:23:35.254362 (MainThread): Using postgres connection "master".
2021-10-06 16:23:35.256711 (MainThread): On master: BEGIN
2021-10-06 16:23:35.259271 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:23:35.268484 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:23:35.271126 (MainThread): On master: COMMIT
2021-10-06 16:23:35.274967 (MainThread): Using postgres connection "master".
2021-10-06 16:23:35.277505 (MainThread): On master: COMMIT
2021-10-06 16:23:35.280754 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:23:35.283376 (MainThread): On master: Close
2021-10-06 16:23:35.285749 (MainThread): 16:23:35 | 
2021-10-06 16:23:35.289108 (MainThread): 16:23:35 | Finished running 1 view model, 1 table model in 0.89s.
2021-10-06 16:23:35.293283 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:23:35.299421 (MainThread): Connection 'model.my_new_project.firstnames' was properly closed.
2021-10-06 16:23:35.302828 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:23:35.368421 (MainThread): 
2021-10-06 16:23:35.372192 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:23:35.376899 (MainThread): 
2021-10-06 16:23:35.383494 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:23:35.387477 (MainThread):   syntax error at or near "="
2021-10-06 16:23:35.391275 (MainThread):   LINE 9:         i = i+1
2021-10-06 16:23:35.395032 (MainThread):                     ^
2021-10-06 16:23:35.404029 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:23:35.407630 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-10-06 16:23:35.413592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7343f9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb735ccfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb735ccff10>]}
2021-10-06 16:23:35.423413 (MainThread): Flushing usage events
2021-10-06 16:23:53.031330 (MainThread): Running with dbt=0.19.0
2021-10-06 16:23:53.248509 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:23:53.262693 (MainThread): Tracking: tracking
2021-10-06 16:23:53.271553 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee1f15c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee551b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee1f250d0>]}
2021-10-06 16:23:53.345690 (MainThread): Partial parsing not enabled
2021-10-06 16:23:53.351834 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:23:53.355227 (MainThread): Parsing macros/relations.sql
2021-10-06 16:23:53.359282 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:23:53.382904 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:23:53.387357 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:23:53.392613 (MainThread): Parsing macros/core.sql
2021-10-06 16:23:53.398548 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:23:53.441843 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:23:53.452557 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:23:53.461815 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:23:53.468810 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:23:53.495641 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:23:53.504427 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:23:53.538569 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:23:53.556403 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:23:53.582859 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:23:53.587401 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:23:53.596723 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:23:53.605195 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:23:53.608916 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:23:53.613334 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:23:53.624305 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:23:53.628540 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:23:53.632808 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:23:53.636291 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:23:53.640587 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:23:53.645718 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:23:53.652453 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:23:53.665098 (MainThread): Partial parsing not enabled
2021-10-06 16:23:53.706494 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:23:53.735589 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:53.763467 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:23:53.994399 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:23:54.013847 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66363ec9-e686-4973-a364-53a3b54f559e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee1e169a0>]}
2021-10-06 16:23:54.081658 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:23:54.085063 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 16:23:54.088116 (MainThread): 
2021-10-06 16:23:54.091344 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:23:54.098586 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:23:54.116324 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:23:54.118748 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:23:54.121003 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:23:54.134239 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 16:23:54.139938 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:23:54.149319 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:23:54.165002 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:23:54.167170 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:23:54.169030 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:23:54.175654 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:23:54.178568 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:23:54.181360 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:23:54.187142 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:23:54.199123 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:23:54.202065 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:23:54.213786 (MainThread): Using postgres connection "master".
2021-10-06 16:23:54.215891 (MainThread): On master: BEGIN
2021-10-06 16:23:54.218171 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:23:54.225742 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:23:54.228443 (MainThread): Using postgres connection "master".
2021-10-06 16:23:54.230451 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:23:54.238290 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:23:54.245719 (MainThread): On master: ROLLBACK
2021-10-06 16:23:54.248492 (MainThread): Using postgres connection "master".
2021-10-06 16:23:54.250277 (MainThread): On master: BEGIN
2021-10-06 16:23:54.253724 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:23:54.257130 (MainThread): On master: COMMIT
2021-10-06 16:23:54.259512 (MainThread): Using postgres connection "master".
2021-10-06 16:23:54.264707 (MainThread): On master: COMMIT
2021-10-06 16:23:54.269597 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:23:54.272600 (MainThread): On master: Close
2021-10-06 16:23:54.277204 (MainThread): 16:23:54 | Concurrency: 2 threads (target='dev')
2021-10-06 16:23:54.279677 (MainThread): 16:23:54 | 
2021-10-06 16:23:54.290635 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:23:54.295800 (Thread-1): 16:23:54 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:23:54.299179 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:54.303064 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:23:54.322977 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:23:54.332021 (Thread-1): finished collecting timing info
2021-10-06 16:23:54.366572 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:54.369654 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:23:54.371908 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:23:54.382415 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:23:54.389834 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:54.392937 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:23:54.397287 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:23:54.409055 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:23:54.417260 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:54.420245 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:23:54.423143 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:23:54.426391 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:23:54.429613 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    
        i = i+1
    return(i)
 
    as LuhnCC, 
    sum(o.totalamount) as Lost_Sum
from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:23:54.434659 (Thread-1): Postgres error: syntax error at or near "="
LINE 9:         i = i+1
                  ^

2021-10-06 16:23:54.439847 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:23:54.444656 (Thread-1): finished collecting timing info
2021-10-06 16:23:54.451317 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:23:54.456404 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "="
  LINE 9:         i = i+1
                    ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "="
LINE 9:         i = i+1
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "="
  LINE 9:         i = i+1
                    ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:23:54.465214 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66363ec9-e686-4973-a364-53a3b54f559e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee1ddbc40>]}
2021-10-06 16:23:54.471686 (Thread-1): 16:23:54 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.17s]
2021-10-06 16:23:54.475685 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:23:54.482352 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:23:54.485431 (MainThread): Using postgres connection "master".
2021-10-06 16:23:54.488526 (MainThread): On master: BEGIN
2021-10-06 16:23:54.495020 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:23:54.526122 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-10-06 16:23:54.536123 (MainThread): On master: COMMIT
2021-10-06 16:23:54.543567 (MainThread): Using postgres connection "master".
2021-10-06 16:23:54.551396 (MainThread): On master: COMMIT
2021-10-06 16:23:54.555835 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:23:54.559712 (MainThread): On master: Close
2021-10-06 16:23:54.564469 (MainThread): 16:23:54 | 
2021-10-06 16:23:54.571266 (MainThread): 16:23:54 | Finished running 1 view model in 0.47s.
2021-10-06 16:23:54.577408 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:23:54.586243 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:23:54.676248 (MainThread): 
2021-10-06 16:23:54.680294 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:23:54.683785 (MainThread): 
2021-10-06 16:23:54.689957 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:23:54.696295 (MainThread):   syntax error at or near "="
2021-10-06 16:23:54.704688 (MainThread):   LINE 9:         i = i+1
2021-10-06 16:23:54.712488 (MainThread):                     ^
2021-10-06 16:23:54.719958 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:23:54.725332 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 16:23:54.729071 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee1cbcee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee1ce14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee1d58c40>]}
2021-10-06 16:23:54.737579 (MainThread): Flushing usage events
2021-10-06 16:24:37.561952 (MainThread): Running with dbt=0.19.0
2021-10-06 16:24:37.882176 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:24:37.894490 (MainThread): Tracking: tracking
2021-10-06 16:24:37.898073 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4e783910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a51d8a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4e795100>]}
2021-10-06 16:24:37.943799 (MainThread): Partial parsing not enabled
2021-10-06 16:24:37.962181 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:24:37.966207 (MainThread): Parsing macros/relations.sql
2021-10-06 16:24:37.975904 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:24:38.007439 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:24:38.018169 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:24:38.025443 (MainThread): Parsing macros/core.sql
2021-10-06 16:24:38.037140 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:24:38.106268 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:24:38.123235 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:24:38.136955 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:24:38.152137 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:24:38.183708 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:24:38.192846 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:24:38.238982 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:24:38.257195 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:24:38.281645 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:24:38.286777 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:24:38.296644 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:24:38.305874 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:24:38.310043 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:24:38.317212 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:24:38.330312 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:24:38.335237 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:24:38.339912 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:24:38.343818 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:24:38.348041 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:24:38.354118 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:24:38.360044 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:24:38.375289 (MainThread): Partial parsing not enabled
2021-10-06 16:24:38.419932 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:24:38.454786 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:24:38.489226 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:24:38.780164 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:24:38.794965 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c4c7ef7-ed52-4396-b637-c329c4c7c571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4e6876d0>]}
2021-10-06 16:24:38.857595 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:24:38.862626 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 16:24:38.868932 (MainThread): 
2021-10-06 16:24:38.873125 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:24:38.881146 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:24:38.904838 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:24:38.908218 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:24:38.911562 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:24:38.926702 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 16:24:38.936975 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:24:38.947450 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:24:38.960836 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:24:38.962911 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:24:38.964786 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:24:38.973256 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:24:38.976214 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:24:38.979009 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:24:38.985288 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:24:39.002511 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:24:39.007056 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:24:39.021972 (MainThread): Using postgres connection "master".
2021-10-06 16:24:39.025067 (MainThread): On master: BEGIN
2021-10-06 16:24:39.027197 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:24:39.038802 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:24:39.043450 (MainThread): Using postgres connection "master".
2021-10-06 16:24:39.047312 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:24:39.061045 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:24:39.070131 (MainThread): On master: ROLLBACK
2021-10-06 16:24:39.074118 (MainThread): Using postgres connection "master".
2021-10-06 16:24:39.077525 (MainThread): On master: BEGIN
2021-10-06 16:24:39.081534 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:24:39.085204 (MainThread): On master: COMMIT
2021-10-06 16:24:39.087636 (MainThread): Using postgres connection "master".
2021-10-06 16:24:39.089834 (MainThread): On master: COMMIT
2021-10-06 16:24:39.092885 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:24:39.095912 (MainThread): On master: Close
2021-10-06 16:24:39.098494 (MainThread): 16:24:39 | Concurrency: 2 threads (target='dev')
2021-10-06 16:24:39.101222 (MainThread): 16:24:39 | 
2021-10-06 16:24:39.110333 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:24:39.115444 (Thread-1): 16:24:39 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:24:39.118073 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:24:39.121272 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:24:39.140292 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:24:39.147795 (Thread-1): finished collecting timing info
2021-10-06 16:24:39.187849 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:24:39.190856 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:24:39.193747 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:24:39.203275 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:24:39.217844 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:24:39.220842 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:24:39.226233 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:24:39.243547 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:24:39.254053 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:24:39.257185 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:24:39.262873 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:24:39.267801 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:24:39.272928 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
    sum = 0
        sum = sum + i
    
        sum = sum + i
    
        sum = sum + i
    
        sum = sum + i
    
        sum = sum + i
    
        sum = sum + i
    
        sum = sum + i
    
        sum = sum + i
    
        sum = sum + i
    
        sum = sum + i
    
        sum = sum + i
    
        sum = sum + i
    return(sum)
 
    as LuhnCC, 
    sum(o.totalamount) as Lost_Sum
from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:24:39.280283 (Thread-1): Postgres error: syntax error at or near "="
LINE 8:         sum = sum + i
                    ^

2021-10-06 16:24:39.283783 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:24:39.288406 (Thread-1): finished collecting timing info
2021-10-06 16:24:39.292294 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:24:39.295986 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "="
  LINE 8:         sum = sum + i
                      ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "="
LINE 8:         sum = sum + i
                    ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "="
  LINE 8:         sum = sum + i
                      ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:24:39.305316 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4c7ef7-ed52-4396-b637-c329c4c7c571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4e543fa0>]}
2021-10-06 16:24:39.311346 (Thread-1): 16:24:39 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.19s]
2021-10-06 16:24:39.317430 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:24:39.326279 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:24:39.330301 (MainThread): Using postgres connection "master".
2021-10-06 16:24:39.334002 (MainThread): On master: BEGIN
2021-10-06 16:24:39.337272 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:24:39.349840 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:24:39.354217 (MainThread): On master: COMMIT
2021-10-06 16:24:39.357001 (MainThread): Using postgres connection "master".
2021-10-06 16:24:39.360238 (MainThread): On master: COMMIT
2021-10-06 16:24:39.364881 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:24:39.367823 (MainThread): On master: Close
2021-10-06 16:24:39.372163 (MainThread): 16:24:39 | 
2021-10-06 16:24:39.378885 (MainThread): 16:24:39 | Finished running 1 view model in 0.50s.
2021-10-06 16:24:39.381739 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:24:39.386649 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:24:39.505251 (MainThread): 
2021-10-06 16:24:39.509570 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:24:39.515866 (MainThread): 
2021-10-06 16:24:39.521063 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:24:39.526486 (MainThread):   syntax error at or near "="
2021-10-06 16:24:39.531792 (MainThread):   LINE 8:         sum = sum + i
2021-10-06 16:24:39.536679 (MainThread):                       ^
2021-10-06 16:24:39.542974 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:24:39.548575 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 16:24:39.553113 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4e6746d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4e52cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4e63beb0>]}
2021-10-06 16:24:39.559202 (MainThread): Flushing usage events
2021-10-06 16:25:49.267451 (MainThread): Running with dbt=0.19.0
2021-10-06 16:25:49.511990 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:25:49.523825 (MainThread): Tracking: tracking
2021-10-06 16:25:49.528375 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8a6419a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8c0ed2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8a653190>]}
2021-10-06 16:25:49.574695 (MainThread): Partial parsing not enabled
2021-10-06 16:25:49.583578 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:25:49.587711 (MainThread): Parsing macros/relations.sql
2021-10-06 16:25:49.593868 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:25:49.619552 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:25:49.624686 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:25:49.630361 (MainThread): Parsing macros/core.sql
2021-10-06 16:25:49.637509 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:25:49.682081 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:25:49.693544 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:25:49.703265 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:25:49.710577 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:25:49.730289 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:25:49.734306 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:25:49.766638 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:25:49.784813 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:25:49.808474 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:25:49.814842 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:25:49.824192 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:25:49.834490 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:25:49.837947 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:25:49.841881 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:25:49.852860 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:25:49.857544 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:25:49.861684 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:25:49.864965 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:25:49.869563 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:25:49.874757 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:25:49.878842 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:25:49.893458 (MainThread): Partial parsing not enabled
2021-10-06 16:25:49.935376 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:25:49.975632 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:25:50.001778 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:25:50.227162 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:25:50.248976 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28d3002f-974b-413a-bffb-c3416b181774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8a5085b0>]}
2021-10-06 16:25:50.325186 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:25:50.330105 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-06 16:25:50.338554 (MainThread): 
2021-10-06 16:25:50.343881 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:25:50.352093 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:25:50.372808 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:25:50.375798 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:25:50.378584 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:25:50.392859 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 16:25:50.403220 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:25:50.417856 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:25:50.427924 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:25:50.430308 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:25:50.432500 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:25:50.440584 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:25:50.445354 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:25:50.451148 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:25:50.458083 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:25:50.473365 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:25:50.477116 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:25:50.491887 (MainThread): Using postgres connection "master".
2021-10-06 16:25:50.494295 (MainThread): On master: BEGIN
2021-10-06 16:25:50.497251 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:25:50.509674 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:25:50.512517 (MainThread): Using postgres connection "master".
2021-10-06 16:25:50.517760 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:25:50.529914 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:25:50.539919 (MainThread): On master: ROLLBACK
2021-10-06 16:25:50.543657 (MainThread): Using postgres connection "master".
2021-10-06 16:25:50.547116 (MainThread): On master: BEGIN
2021-10-06 16:25:50.553164 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:25:50.556862 (MainThread): On master: COMMIT
2021-10-06 16:25:50.560989 (MainThread): Using postgres connection "master".
2021-10-06 16:25:50.564367 (MainThread): On master: COMMIT
2021-10-06 16:25:50.567935 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:25:50.570027 (MainThread): On master: Close
2021-10-06 16:25:50.573251 (MainThread): 16:25:50 | Concurrency: 2 threads (target='dev')
2021-10-06 16:25:50.576874 (MainThread): 16:25:50 | 
2021-10-06 16:25:50.585799 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:25:50.589653 (Thread-1): 16:25:50 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:25:50.592315 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:25:50.596296 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:25:50.620781 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:25:50.630895 (Thread-1): finished collecting timing info
2021-10-06 16:25:50.664924 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:25:50.667976 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:25:50.670595 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:25:50.677884 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:25:50.683752 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:25:50.686528 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:25:50.689851 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:25:50.706443 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:25:50.716708 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:25:50.719680 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:25:50.723509 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:25:50.728026 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:25:50.735085 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
     
    as LuhnCC, 
    sum(o.totalamount) as Lost_Sum
from orders o
join customers c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:25:50.742351 (Thread-1): Postgres error: syntax error at or near "i"
LINE 11:         i
                 ^

2021-10-06 16:25:50.756128 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:25:50.759680 (Thread-1): finished collecting timing info
2021-10-06 16:25:50.766273 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:25:50.779324 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "i"
  LINE 11:         i
                   ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "i"
LINE 11:         i
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "i"
  LINE 11:         i
                   ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:25:50.788433 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28d3002f-974b-413a-bffb-c3416b181774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c89b981f0>]}
2021-10-06 16:25:50.804714 (Thread-1): 16:25:50 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.20s]
2021-10-06 16:25:50.809497 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:25:50.817767 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:25:50.822505 (MainThread): Using postgres connection "master".
2021-10-06 16:25:50.825632 (MainThread): On master: BEGIN
2021-10-06 16:25:50.829504 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:25:50.842823 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:25:50.846460 (MainThread): On master: COMMIT
2021-10-06 16:25:50.849878 (MainThread): Using postgres connection "master".
2021-10-06 16:25:50.854367 (MainThread): On master: COMMIT
2021-10-06 16:25:50.858322 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:25:50.861599 (MainThread): On master: Close
2021-10-06 16:25:50.866037 (MainThread): 16:25:50 | 
2021-10-06 16:25:50.870255 (MainThread): 16:25:50 | Finished running 1 view model in 0.52s.
2021-10-06 16:25:50.874333 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:25:50.878725 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:25:50.942265 (MainThread): 
2021-10-06 16:25:50.948213 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:25:50.956070 (MainThread): 
2021-10-06 16:25:50.959304 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:25:50.963554 (MainThread):   syntax error at or near "i"
2021-10-06 16:25:50.969431 (MainThread):   LINE 11:         i
2021-10-06 16:25:50.972950 (MainThread):                    ^
2021-10-06 16:25:50.976323 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:25:50.981037 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 16:25:50.998573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8a5dcd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c89b6f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c89b6f490>]}
2021-10-06 16:25:51.010785 (MainThread): Flushing usage events
2021-10-06 16:27:08.511839 (MainThread): Running with dbt=0.19.0
2021-10-06 16:27:08.860042 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:27:08.873301 (MainThread): Tracking: tracking
2021-10-06 16:27:08.883902 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae5888970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae72b4280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae5899160>]}
2021-10-06 16:27:08.952764 (MainThread): Partial parsing not enabled
2021-10-06 16:27:08.961568 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:27:08.969138 (MainThread): Parsing macros/relations.sql
2021-10-06 16:27:08.977950 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:27:09.008812 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:27:09.016019 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:27:09.023502 (MainThread): Parsing macros/core.sql
2021-10-06 16:27:09.032120 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:27:09.075290 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:27:09.087736 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:27:09.103902 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:27:09.112350 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:27:09.131732 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:27:09.136206 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:27:09.178715 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:27:09.197393 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:27:09.220409 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:27:09.224970 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:27:09.233348 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:27:09.243225 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:27:09.246684 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:27:09.251321 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:27:09.264180 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:27:09.268974 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:27:09.273183 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:27:09.276877 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:27:09.280948 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:27:09.291906 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:27:09.296532 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:27:09.312878 (MainThread): Partial parsing not enabled
2021-10-06 16:27:09.351346 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:27:09.392718 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:27:09.401166 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae57ee730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae56ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ae56a7460>]}
2021-10-06 16:27:09.404311 (MainThread): Flushing usage events
2021-10-06 16:27:09.931298 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:27:09.936561 (MainThread): Encountered an error:
2021-10-06 16:27:09.941467 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  expected token 'end of statement block', got ':'
    line 3
      {%- if creditcard::numeric % 10 > 8 %}
2021-10-06 16:27:09.956618 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of statement block', got ':'
  line 3
    {%- if creditcard::numeric % 10 > 8 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  expected token 'end of statement block', got ':'
    line 3
      {%- if creditcard::numeric % 10 > 8 %}

2021-10-06 16:29:09.057820 (MainThread): Running with dbt=0.19.0
2021-10-06 16:29:09.357805 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:29:09.373470 (MainThread): Tracking: tracking
2021-10-06 16:29:09.382371 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7e8f0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7ce48cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7ce48fd0>]}
2021-10-06 16:29:09.442330 (MainThread): Partial parsing not enabled
2021-10-06 16:29:09.456819 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:29:09.464001 (MainThread): Parsing macros/relations.sql
2021-10-06 16:29:09.473100 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:29:09.501435 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:29:09.507910 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:29:09.514240 (MainThread): Parsing macros/core.sql
2021-10-06 16:29:09.523169 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:29:09.577480 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:29:09.592559 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:29:09.603551 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:29:09.613754 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:29:09.639933 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:29:09.645564 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:29:09.682966 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:29:09.702628 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:29:09.730055 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:29:09.735132 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:29:09.744824 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:29:09.755828 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:29:09.759284 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:29:09.763087 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:29:09.776606 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:29:09.781530 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:29:09.785907 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:29:09.789383 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:29:09.793487 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:29:09.799112 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:29:09.803218 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:29:09.822737 (MainThread): Partial parsing not enabled
2021-10-06 16:29:09.867820 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:29:09.897847 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:29:09.903774 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7cda76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7cc6ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7cc683d0>]}
2021-10-06 16:29:09.906883 (MainThread): Flushing usage events
2021-10-06 16:29:10.445258 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:29:10.454342 (MainThread): Encountered an error:
2021-10-06 16:29:10.460087 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  expected token 'end of statement block', got ':'
    line 3
      {%- if creditcard::numeric % 10 > 8 %}
2021-10-06 16:29:10.474230 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of statement block', got ':'
  line 3
    {%- if creditcard::numeric % 10 > 8 %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  expected token 'end of statement block', got ':'
    line 3
      {%- if creditcard::numeric % 10 > 8 %}

2021-10-06 16:32:34.916127 (MainThread): Running with dbt=0.19.0
2021-10-06 16:32:35.186989 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:32:35.203617 (MainThread): Tracking: tracking
2021-10-06 16:32:35.210153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eefb11970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef153d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eefb22160>]}
2021-10-06 16:32:35.262325 (MainThread): Partial parsing not enabled
2021-10-06 16:32:35.271003 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:32:35.278611 (MainThread): Parsing macros/relations.sql
2021-10-06 16:32:35.289593 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:32:35.318739 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:32:35.329123 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:32:35.341170 (MainThread): Parsing macros/core.sql
2021-10-06 16:32:35.347933 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:32:35.390192 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:32:35.402704 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:32:35.412562 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:32:35.420794 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:32:35.444946 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:32:35.451396 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:32:35.489314 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:32:35.506248 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:32:35.530947 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:32:35.535685 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:32:35.545403 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:32:35.554369 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:32:35.557821 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:32:35.562081 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:32:35.573923 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:32:35.578975 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:32:35.585976 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:32:35.590402 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:32:35.596205 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:32:35.605714 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:32:35.611143 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:32:35.635991 (MainThread): Partial parsing not enabled
2021-10-06 16:32:35.692303 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:32:35.726966 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:32:35.732352 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eefa76730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eef935e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eef9315e0>]}
2021-10-06 16:32:35.735107 (MainThread): Flushing usage events
2021-10-06 16:32:41.056500 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-10-06 16:32:41.063571 (MainThread): Error sending message, disabling tracking
2021-10-06 16:32:41.069553 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:32:41.074203 (MainThread): Encountered an error:
2021-10-06 16:32:41.078819 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  unexpected '}', expected ')'
    line 6
      from {{source("dells","orders"}} o
2021-10-06 16:32:41.089290 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 6, in template
jinja2.exceptions.TemplateSyntaxError: unexpected '}', expected ')'
  line 6
    from {{source("dells","orders"}} o

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  unexpected '}', expected ')'
    line 6
      from {{source("dells","orders"}} o

2021-10-06 16:32:59.754702 (MainThread): Running with dbt=0.19.0
2021-10-06 16:32:59.959888 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:32:59.972185 (MainThread): Tracking: tracking
2021-10-06 16:32:59.975758 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4987992910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498af9a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49879a3100>]}
2021-10-06 16:33:00.017688 (MainThread): Partial parsing not enabled
2021-10-06 16:33:00.024973 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:33:00.032171 (MainThread): Parsing macros/relations.sql
2021-10-06 16:33:00.038536 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:33:00.083949 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:33:00.095283 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:33:00.103776 (MainThread): Parsing macros/core.sql
2021-10-06 16:33:00.110184 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:33:00.160806 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:33:00.178915 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:33:00.187342 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:33:00.194494 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:33:00.216568 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:33:00.221627 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:33:00.254499 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:33:00.270374 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:33:00.294803 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:33:00.299757 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:33:00.308090 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:33:00.318326 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:33:00.322117 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:33:00.326540 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:33:00.337212 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:33:00.341922 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:33:00.345998 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:33:00.349298 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:33:00.353696 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:33:00.358991 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:33:00.363002 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:33:00.383785 (MainThread): Partial parsing not enabled
2021-10-06 16:33:00.432313 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:33:00.464224 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:33:00.470075 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498794ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49877cafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49877b3580>]}
2021-10-06 16:33:00.472659 (MainThread): Flushing usage events
2021-10-06 16:33:01.010889 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:33:01.021318 (MainThread): Encountered an error:
2021-10-06 16:33:01.025393 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  unexpected '}', expected ')'
    line 6
      from {{source("dells","orders"}} o
2021-10-06 16:33:01.037971 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 6, in template
jinja2.exceptions.TemplateSyntaxError: unexpected '}', expected ')'
  line 6
    from {{source("dells","orders"}} o

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  unexpected '}', expected ')'
    line 6
      from {{source("dells","orders"}} o

2021-10-06 16:33:38.288235 (MainThread): Running with dbt=0.19.0
2021-10-06 16:33:38.593429 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:33:38.608025 (MainThread): Tracking: tracking
2021-10-06 16:33:38.613394 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e5bc39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e75ef2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e5bd4190>]}
2021-10-06 16:33:38.671412 (MainThread): Partial parsing not enabled
2021-10-06 16:33:38.680966 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:33:38.686967 (MainThread): Parsing macros/relations.sql
2021-10-06 16:33:38.693675 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:33:38.762109 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:33:38.768444 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:33:38.777904 (MainThread): Parsing macros/core.sql
2021-10-06 16:33:38.789320 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:33:38.870830 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:33:38.891595 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:33:38.907612 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:33:38.934973 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:33:38.976116 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:33:38.983148 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:33:39.037275 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:33:39.069183 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:33:39.114521 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:33:39.121870 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:33:39.144165 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:33:39.162058 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:33:39.167439 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:33:39.173802 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:33:39.195373 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:33:39.221860 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:33:39.242912 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:33:39.248603 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:33:39.254167 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:33:39.262447 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:33:39.269442 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:33:39.301134 (MainThread): Partial parsing not enabled
2021-10-06 16:33:39.405567 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:33:39.464285 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:33:39.520426 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:33:39.851125 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:33:39.867434 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '506f382c-d5c9-44f6-8f70-b7c7fe63fc39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e5a19490>]}
2021-10-06 16:33:39.944659 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:33:39.949853 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 16:33:39.957823 (MainThread): 
2021-10-06 16:33:39.965080 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:33:39.972055 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:33:40.002144 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:33:40.006458 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:33:40.010064 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:33:40.027874 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 16:33:40.044306 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:33:40.079335 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:33:40.095959 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:33:40.099005 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:33:40.102375 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:33:40.116223 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:33:40.121791 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:33:40.125862 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:33:40.132701 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:33:40.149973 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:33:40.153429 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:33:40.173174 (MainThread): Using postgres connection "master".
2021-10-06 16:33:40.177324 (MainThread): On master: BEGIN
2021-10-06 16:33:40.183123 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:33:40.196415 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:33:40.199670 (MainThread): Using postgres connection "master".
2021-10-06 16:33:40.203931 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:33:40.215441 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:33:40.224976 (MainThread): On master: ROLLBACK
2021-10-06 16:33:40.230275 (MainThread): Using postgres connection "master".
2021-10-06 16:33:40.232948 (MainThread): On master: BEGIN
2021-10-06 16:33:40.236683 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:33:40.240982 (MainThread): On master: COMMIT
2021-10-06 16:33:40.247773 (MainThread): Using postgres connection "master".
2021-10-06 16:33:40.251466 (MainThread): On master: COMMIT
2021-10-06 16:33:40.255752 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:33:40.259575 (MainThread): On master: Close
2021-10-06 16:33:40.264697 (MainThread): 16:33:40 | Concurrency: 2 threads (target='dev')
2021-10-06 16:33:40.268492 (MainThread): 16:33:40 | 
2021-10-06 16:33:40.283138 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:33:40.289441 (Thread-1): 16:33:40 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:33:40.297060 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:33:40.303052 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:33:40.343515 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:33:40.354512 (Thread-1): finished collecting timing info
2021-10-06 16:33:40.403343 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:33:40.406882 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:33:40.409263 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:33:40.420374 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:33:40.430750 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:33:40.433365 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:33:40.436818 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:33:40.446972 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:33:40.457280 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:33:40.459927 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:33:40.463254 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:33:40.467058 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:33:40.470248 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    ::numeric % 10
    as modulo, 
    sum(o.totalamount) as Lost_Sum
from "dellstore"."public"."orders" o
join "dellstore"."public"."customers" c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:33:40.475221 (Thread-1): Postgres error: syntax error at or near "::"
LINE 6:     ::numeric % 10
            ^

2021-10-06 16:33:40.480867 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:33:40.485154 (Thread-1): finished collecting timing info
2021-10-06 16:33:40.489094 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:33:40.494349 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "::"
  LINE 6:     ::numeric % 10
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "::"
LINE 6:     ::numeric % 10
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "::"
  LINE 6:     ::numeric % 10
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:33:40.503271 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '506f382c-d5c9-44f6-8f70-b7c7fe63fc39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e51138b0>]}
2021-10-06 16:33:40.509846 (Thread-1): 16:33:40 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.21s]
2021-10-06 16:33:40.512600 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:33:40.519879 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:33:40.523566 (MainThread): Using postgres connection "master".
2021-10-06 16:33:40.528184 (MainThread): On master: BEGIN
2021-10-06 16:33:40.532321 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:33:40.547292 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-06 16:33:40.552139 (MainThread): On master: COMMIT
2021-10-06 16:33:40.556311 (MainThread): Using postgres connection "master".
2021-10-06 16:33:40.560767 (MainThread): On master: COMMIT
2021-10-06 16:33:40.563314 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:33:40.565663 (MainThread): On master: Close
2021-10-06 16:33:40.569284 (MainThread): 16:33:40 | 
2021-10-06 16:33:40.573234 (MainThread): 16:33:40 | Finished running 1 view model in 0.61s.
2021-10-06 16:33:40.580349 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:33:40.588161 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:33:40.654521 (MainThread): 
2021-10-06 16:33:40.660198 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:33:40.663238 (MainThread): 
2021-10-06 16:33:40.668691 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:33:40.672304 (MainThread):   syntax error at or near "::"
2021-10-06 16:33:40.678794 (MainThread):   LINE 6:     ::numeric % 10
2021-10-06 16:33:40.682371 (MainThread):               ^
2021-10-06 16:33:40.685978 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:33:40.689483 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 16:33:40.697730 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e5a7f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e5982ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e598edf0>]}
2021-10-06 16:33:40.702249 (MainThread): Flushing usage events
2021-10-06 16:35:04.523216 (MainThread): Running with dbt=0.19.0
2021-10-06 16:35:04.821044 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:35:04.832053 (MainThread): Tracking: tracking
2021-10-06 16:35:04.836495 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3981761910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3984d68430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3981772100>]}
2021-10-06 16:35:04.884726 (MainThread): Partial parsing not enabled
2021-10-06 16:35:04.891058 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:35:04.896599 (MainThread): Parsing macros/relations.sql
2021-10-06 16:35:04.901750 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:35:04.944856 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:35:04.950931 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:35:04.959080 (MainThread): Parsing macros/core.sql
2021-10-06 16:35:04.969855 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:35:05.019919 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:35:05.033157 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:35:05.043783 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:35:05.052783 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:35:05.081573 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:35:05.087951 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:35:05.124421 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:35:05.143238 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:35:05.170864 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:35:05.175716 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:35:05.185504 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:35:05.196937 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:35:05.200595 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:35:05.206420 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:35:05.219462 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:35:05.224234 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:35:05.229683 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:35:05.232772 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:35:05.236491 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:35:05.243593 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:35:05.247698 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:35:05.267430 (MainThread): Partial parsing not enabled
2021-10-06 16:35:05.318883 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:35:05.355614 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:05.396377 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:35:05.743857 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:35:05.757341 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05fce5ae-ef2c-4ebb-ae9c-d3d7d2418496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39815b1730>]}
2021-10-06 16:35:05.841511 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:35:05.851003 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 16:35:05.856934 (MainThread): 
2021-10-06 16:35:05.866764 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:35:05.878493 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:35:05.909769 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:35:05.916564 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:35:05.921527 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:35:05.936717 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 16:35:05.948986 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:35:05.962511 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:35:05.983604 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:35:05.986290 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:35:05.989217 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:35:06.002817 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:35:06.007572 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:35:06.013700 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:35:06.024296 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:35:06.040826 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:35:06.048272 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:35:06.067207 (MainThread): Using postgres connection "master".
2021-10-06 16:35:06.069748 (MainThread): On master: BEGIN
2021-10-06 16:35:06.072937 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:35:06.085669 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:35:06.089312 (MainThread): Using postgres connection "master".
2021-10-06 16:35:06.094641 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:35:06.106447 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:35:06.117853 (MainThread): On master: ROLLBACK
2021-10-06 16:35:06.121027 (MainThread): Using postgres connection "master".
2021-10-06 16:35:06.124383 (MainThread): On master: BEGIN
2021-10-06 16:35:06.133292 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:35:06.136497 (MainThread): On master: COMMIT
2021-10-06 16:35:06.140782 (MainThread): Using postgres connection "master".
2021-10-06 16:35:06.147467 (MainThread): On master: COMMIT
2021-10-06 16:35:06.152782 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:35:06.156512 (MainThread): On master: Close
2021-10-06 16:35:06.165470 (MainThread): 16:35:06 | Concurrency: 2 threads (target='dev')
2021-10-06 16:35:06.170024 (MainThread): 16:35:06 | 
2021-10-06 16:35:06.189206 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:35:06.202584 (Thread-1): 16:35:06 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:35:06.206983 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:06.216619 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:35:06.270865 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:35:06.285940 (Thread-1): finished collecting timing info
2021-10-06 16:35:06.336445 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:06.339185 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:35:06.341789 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:35:06.352314 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:35:06.361693 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:06.365006 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:35:06.368605 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:35:06.378777 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:35:06.389694 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:06.392662 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:35:06.397643 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:35:06.401354 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:06.406163 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
        i
    
    as Validity, 
    sum(o.totalamount) as Lost_Sum
from "dellstore"."public"."orders" o
join "dellstore"."public"."customers" c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:35:06.410467 (Thread-1): Postgres error: syntax error at or near "i"
LINE 11:         i
                 ^

2021-10-06 16:35:06.415530 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:35:06.421843 (Thread-1): finished collecting timing info
2021-10-06 16:35:06.428713 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:35:06.434066 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "i"
  LINE 11:         i
                   ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "i"
LINE 11:         i
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "i"
  LINE 11:         i
                   ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:35:06.441631 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05fce5ae-ef2c-4ebb-ae9c-d3d7d2418496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3981687d30>]}
2021-10-06 16:35:06.446845 (Thread-1): 16:35:06 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.23s]
2021-10-06 16:35:06.449617 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:35:06.459917 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:35:06.464064 (MainThread): Using postgres connection "master".
2021-10-06 16:35:06.467437 (MainThread): On master: BEGIN
2021-10-06 16:35:06.470573 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:35:06.484010 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:35:06.487567 (MainThread): On master: COMMIT
2021-10-06 16:35:06.490723 (MainThread): Using postgres connection "master".
2021-10-06 16:35:06.496587 (MainThread): On master: COMMIT
2021-10-06 16:35:06.501685 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:35:06.504823 (MainThread): On master: Close
2021-10-06 16:35:06.508881 (MainThread): 16:35:06 | 
2021-10-06 16:35:06.515046 (MainThread): 16:35:06 | Finished running 1 view model in 0.64s.
2021-10-06 16:35:06.518936 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:35:06.525907 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:35:06.612552 (MainThread): 
2021-10-06 16:35:06.617086 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:35:06.621721 (MainThread): 
2021-10-06 16:35:06.628651 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:35:06.634263 (MainThread):   syntax error at or near "i"
2021-10-06 16:35:06.638113 (MainThread):   LINE 11:         i
2021-10-06 16:35:06.642264 (MainThread):                    ^
2021-10-06 16:35:06.650458 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:35:06.653871 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 16:35:06.658093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3981508eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3980c87a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3980c877f0>]}
2021-10-06 16:35:06.663477 (MainThread): Flushing usage events
2021-10-06 16:35:16.853309 (MainThread): Running with dbt=0.19.0
2021-10-06 16:35:17.110455 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:35:17.123639 (MainThread): Tracking: tracking
2021-10-06 16:35:17.129602 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaddb70940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae1177460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaddb81130>]}
2021-10-06 16:35:17.197284 (MainThread): Partial parsing not enabled
2021-10-06 16:35:17.212831 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:35:17.217819 (MainThread): Parsing macros/relations.sql
2021-10-06 16:35:17.223715 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:35:17.252510 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:35:17.257406 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:35:17.262558 (MainThread): Parsing macros/core.sql
2021-10-06 16:35:17.269843 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:35:17.317673 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:35:17.331001 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:35:17.346634 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:35:17.355372 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:35:17.377537 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:35:17.382024 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:35:17.416679 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:35:17.434548 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:35:17.460596 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:35:17.465046 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:35:17.473867 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:35:17.483783 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:35:17.487647 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:35:17.491861 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:35:17.503341 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:35:17.508258 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:35:17.517316 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:35:17.524287 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:35:17.532362 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:35:17.537569 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:35:17.541730 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:35:17.555702 (MainThread): Partial parsing not enabled
2021-10-06 16:35:17.595663 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:35:17.625725 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:17.654468 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:35:17.863778 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:35:17.874921 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2504414-6d23-48f7-ba86-cc0e57c7e5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd9bf820>]}
2021-10-06 16:35:17.933799 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:35:17.937887 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 16:35:17.942938 (MainThread): 
2021-10-06 16:35:17.946881 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:35:17.959093 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:35:17.978585 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:35:17.982262 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:35:17.986478 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:35:18.002264 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 16:35:18.017264 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:35:18.027462 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:35:18.035655 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:35:18.037687 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:35:18.040022 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:35:18.049746 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:35:18.053430 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:35:18.056833 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:35:18.063939 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:35:18.077367 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:35:18.079982 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:35:18.094138 (MainThread): Using postgres connection "master".
2021-10-06 16:35:18.097249 (MainThread): On master: BEGIN
2021-10-06 16:35:18.099644 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:35:18.108900 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:35:18.111368 (MainThread): Using postgres connection "master".
2021-10-06 16:35:18.113762 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:35:18.123064 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:35:18.127798 (MainThread): On master: ROLLBACK
2021-10-06 16:35:18.130652 (MainThread): Using postgres connection "master".
2021-10-06 16:35:18.132628 (MainThread): On master: BEGIN
2021-10-06 16:35:18.137528 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:35:18.141510 (MainThread): On master: COMMIT
2021-10-06 16:35:18.144784 (MainThread): Using postgres connection "master".
2021-10-06 16:35:18.147034 (MainThread): On master: COMMIT
2021-10-06 16:35:18.150342 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:35:18.153056 (MainThread): On master: Close
2021-10-06 16:35:18.156778 (MainThread): 16:35:18 | Concurrency: 2 threads (target='dev')
2021-10-06 16:35:18.160634 (MainThread): 16:35:18 | 
2021-10-06 16:35:18.167295 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:35:18.172340 (Thread-1): 16:35:18 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:35:18.177075 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:18.180407 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:35:18.207249 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:35:18.216847 (Thread-1): finished collecting timing info
2021-10-06 16:35:18.256984 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:18.259291 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:35:18.261620 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:35:18.271674 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:35:18.278655 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:18.281447 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:35:18.284287 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:35:18.296290 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:35:18.306405 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:18.309154 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:35:18.312801 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:35:18.315831 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:18.318938 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
    creditcard::numeric % 10

    as Validity, 
    sum(o.totalamount) as Lost_Sum
from "dellstore"."public"."orders" o
join "dellstore"."public"."customers" c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:35:18.345047 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-10-06 16:35:18.364416 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:18.366893 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 16:35:18.371894 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:35:18.379733 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:18.384308 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 16:35:18.390030 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:35:18.407069 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 16:35:18.410228 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:18.428807 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 16:35:18.432800 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:35:18.463072 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:35:18.465521 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:35:18.471634 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:35:18.479571 (Thread-1): finished collecting timing info
2021-10-06 16:35:18.482200 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:35:18.484486 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2504414-6d23-48f7-ba86-cc0e57c7e5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd943fd0>]}
2021-10-06 16:35:18.488969 (Thread-1): 16:35:18 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.31s]
2021-10-06 16:35:18.491476 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:35:18.511680 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:35:18.514515 (MainThread): Using postgres connection "master".
2021-10-06 16:35:18.517457 (MainThread): On master: BEGIN
2021-10-06 16:35:18.519975 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:35:18.528479 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:35:18.531686 (MainThread): On master: COMMIT
2021-10-06 16:35:18.533754 (MainThread): Using postgres connection "master".
2021-10-06 16:35:18.535556 (MainThread): On master: COMMIT
2021-10-06 16:35:18.538304 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:35:18.540544 (MainThread): On master: Close
2021-10-06 16:35:18.544446 (MainThread): 16:35:18 | 
2021-10-06 16:35:18.546971 (MainThread): 16:35:18 | Finished running 1 view model in 0.60s.
2021-10-06 16:35:18.550998 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:35:18.554846 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:35:18.606569 (MainThread): 
2021-10-06 16:35:18.610595 (MainThread): Completed successfully
2021-10-06 16:35:18.613417 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 16:35:18.618798 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd915e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd93d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffadd93d160>]}
2021-10-06 16:35:18.622484 (MainThread): Flushing usage events
2021-10-06 16:36:13.882607 (MainThread): Running with dbt=0.19.0
2021-10-06 16:36:14.126493 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:36:14.141896 (MainThread): Tracking: tracking
2021-10-06 16:36:14.148245 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12e0fde9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12e2a0a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12e0ff0190>]}
2021-10-06 16:36:14.197425 (MainThread): Partial parsing not enabled
2021-10-06 16:36:14.207476 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:36:14.213723 (MainThread): Parsing macros/relations.sql
2021-10-06 16:36:14.223151 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:36:14.257997 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:36:14.268499 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:36:14.280072 (MainThread): Parsing macros/core.sql
2021-10-06 16:36:14.292657 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:36:14.353887 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:36:14.368320 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:36:14.384683 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:36:14.393281 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:36:14.414905 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:36:14.419266 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:36:14.451087 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:36:14.466875 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:36:14.492890 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:36:14.497413 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:36:14.506812 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:36:14.516446 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:36:14.524970 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:36:14.534453 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:36:14.548903 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:36:14.554109 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:36:14.558533 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:36:14.562546 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:36:14.568344 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:36:14.577750 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:36:14.584559 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:36:14.606359 (MainThread): Partial parsing not enabled
2021-10-06 16:36:14.650268 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:36:14.686369 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:36:14.714479 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:36:14.951540 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:36:14.972101 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '893b949b-42fd-49cf-8356-82009719eee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12e0e2d970>]}
2021-10-06 16:36:15.065801 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:36:15.070788 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 16:36:15.076827 (MainThread): 
2021-10-06 16:36:15.082826 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:36:15.090776 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:36:15.110123 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:36:15.113449 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:36:15.116154 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:36:15.130508 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 16:36:15.146828 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:36:15.157020 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:36:15.173141 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:36:15.176810 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:36:15.181704 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:36:15.197455 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-10-06 16:36:15.201412 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:36:15.208176 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:36:15.219437 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 16:36:15.244371 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:36:15.248977 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:36:15.274923 (MainThread): Using postgres connection "master".
2021-10-06 16:36:15.278900 (MainThread): On master: BEGIN
2021-10-06 16:36:15.283087 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:36:15.294833 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:36:15.299942 (MainThread): Using postgres connection "master".
2021-10-06 16:36:15.306085 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:36:15.314882 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:36:15.324865 (MainThread): On master: ROLLBACK
2021-10-06 16:36:15.327923 (MainThread): Using postgres connection "master".
2021-10-06 16:36:15.330629 (MainThread): On master: BEGIN
2021-10-06 16:36:15.335079 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:36:15.340431 (MainThread): On master: COMMIT
2021-10-06 16:36:15.345582 (MainThread): Using postgres connection "master".
2021-10-06 16:36:15.351383 (MainThread): On master: COMMIT
2021-10-06 16:36:15.356234 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:36:15.359275 (MainThread): On master: Close
2021-10-06 16:36:15.364155 (MainThread): 16:36:15 | Concurrency: 2 threads (target='dev')
2021-10-06 16:36:15.367643 (MainThread): 16:36:15 | 
2021-10-06 16:36:15.385447 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:36:15.403402 (Thread-1): 16:36:15 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:36:15.408840 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:36:15.413754 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:36:15.450907 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:36:15.465164 (Thread-1): finished collecting timing info
2021-10-06 16:36:15.524042 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:36:15.527682 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:36:15.530651 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:36:15.546478 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2021-10-06 16:36:15.554994 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:36:15.558042 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:36:15.561881 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:36:15.573290 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:36:15.583574 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:36:15.587047 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:36:15.591348 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:36:15.595121 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:36:15.600034 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
    digit = 0
    creditcard::numeric % 10


    as Validity, 
    sum(o.totalamount) as Lost_Sum
from "dellstore"."public"."orders" o
join "dellstore"."public"."customers" c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:36:15.606492 (Thread-1): Postgres error: syntax error at or near "::"
LINE 8:     creditcard::numeric % 10
                      ^

2021-10-06 16:36:15.610357 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:36:15.613868 (Thread-1): finished collecting timing info
2021-10-06 16:36:15.618335 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:36:15.622537 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "::"
  LINE 8:     creditcard::numeric % 10
                        ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "::"
LINE 8:     creditcard::numeric % 10
                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  syntax error at or near "::"
  LINE 8:     creditcard::numeric % 10
                        ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:36:15.630074 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '893b949b-42fd-49cf-8356-82009719eee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12e05285e0>]}
2021-10-06 16:36:15.635357 (Thread-1): 16:36:15 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.22s]
2021-10-06 16:36:15.638277 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:36:15.672464 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:36:15.676747 (MainThread): Using postgres connection "master".
2021-10-06 16:36:15.679663 (MainThread): On master: BEGIN
2021-10-06 16:36:15.687906 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:36:15.698738 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:36:15.702651 (MainThread): On master: COMMIT
2021-10-06 16:36:15.705356 (MainThread): Using postgres connection "master".
2021-10-06 16:36:15.708342 (MainThread): On master: COMMIT
2021-10-06 16:36:15.714112 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:36:15.717946 (MainThread): On master: Close
2021-10-06 16:36:15.723160 (MainThread): 16:36:15 | 
2021-10-06 16:36:15.726329 (MainThread): 16:36:15 | Finished running 1 view model in 0.64s.
2021-10-06 16:36:15.731386 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:36:15.737245 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:36:15.806750 (MainThread): 
2021-10-06 16:36:15.809922 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:36:15.814338 (MainThread): 
2021-10-06 16:36:15.820332 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:36:15.824455 (MainThread):   syntax error at or near "::"
2021-10-06 16:36:15.829533 (MainThread):   LINE 8:     creditcard::numeric % 10
2021-10-06 16:36:15.834012 (MainThread):                         ^
2021-10-06 16:36:15.838904 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:36:15.842351 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 16:36:15.847996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12e0d83eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12e0dab4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12e0dab400>]}
2021-10-06 16:36:15.853159 (MainThread): Flushing usage events
2021-10-06 16:37:31.175082 (MainThread): Running with dbt=0.19.0
2021-10-06 16:37:31.419727 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:37:31.430766 (MainThread): Tracking: tracking
2021-10-06 16:37:31.434211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91d297a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91ed42370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91d2a91f0>]}
2021-10-06 16:37:31.481900 (MainThread): Partial parsing not enabled
2021-10-06 16:37:31.500288 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:37:31.503835 (MainThread): Parsing macros/relations.sql
2021-10-06 16:37:31.508566 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:37:31.535376 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:37:31.541112 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:37:31.546537 (MainThread): Parsing macros/core.sql
2021-10-06 16:37:31.555256 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:37:31.601162 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:37:31.614329 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:37:31.623010 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:37:31.631513 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:37:31.651337 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:37:31.656285 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:37:31.689255 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:37:31.707265 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:37:31.731787 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:37:31.736242 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:37:31.744244 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:37:31.754381 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:37:31.757999 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:37:31.763179 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:37:31.776255 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:37:31.781110 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:37:31.785330 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:37:31.788909 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:37:31.793011 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:37:31.798060 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:37:31.802377 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:37:31.817370 (MainThread): Partial parsing not enabled
2021-10-06 16:37:31.861853 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:37:31.891844 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:37:31.922200 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:37:32.111676 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:37:32.127223 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99b03e36-8710-4179-b3a1-8dd52f31a39e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91d0e67c0>]}
2021-10-06 16:37:32.173276 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:37:32.176192 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 16:37:32.180260 (MainThread): 
2021-10-06 16:37:32.186661 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:37:32.196060 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:37:32.216264 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:37:32.219229 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:37:32.221169 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:37:32.234201 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 16:37:32.239179 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:37:32.253585 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:37:32.263122 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:37:32.265277 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:37:32.266965 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:37:32.275055 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:37:32.277320 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:37:32.279812 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:37:32.287466 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:37:32.299038 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:37:32.302602 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:37:32.318266 (MainThread): Using postgres connection "master".
2021-10-06 16:37:32.321124 (MainThread): On master: BEGIN
2021-10-06 16:37:32.323311 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:37:32.331629 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:37:32.335330 (MainThread): Using postgres connection "master".
2021-10-06 16:37:32.339592 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:37:32.349055 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:37:32.355049 (MainThread): On master: ROLLBACK
2021-10-06 16:37:32.358113 (MainThread): Using postgres connection "master".
2021-10-06 16:37:32.360115 (MainThread): On master: BEGIN
2021-10-06 16:37:32.363673 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:37:32.366499 (MainThread): On master: COMMIT
2021-10-06 16:37:32.369401 (MainThread): Using postgres connection "master".
2021-10-06 16:37:32.372706 (MainThread): On master: COMMIT
2021-10-06 16:37:32.376163 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:37:32.379549 (MainThread): On master: Close
2021-10-06 16:37:32.383145 (MainThread): 16:37:32 | Concurrency: 2 threads (target='dev')
2021-10-06 16:37:32.385911 (MainThread): 16:37:32 | 
2021-10-06 16:37:32.394482 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:37:32.397707 (Thread-1): 16:37:32 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:37:32.400133 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:37:32.404549 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:37:32.425339 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:37:32.435501 (Thread-1): finished collecting timing info
2021-10-06 16:37:32.470385 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:37:32.472524 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:37:32.474683 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:37:32.482077 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:37:32.486707 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:37:32.489242 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:37:32.492357 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:37:32.504335 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:37:32.512122 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:37:32.514433 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:37:32.517424 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:37:32.520537 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:37:32.524411 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
    digit = 0,
    creditcard::numeric % 10


    as Validity, 
    sum(o.totalamount) as Lost_Sum
from "dellstore"."public"."orders" o
join "dellstore"."public"."customers" c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:37:32.531445 (Thread-1): Postgres error: column "digit" does not exist
LINE 7:     digit = 0,
            ^

2021-10-06 16:37:32.534656 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:37:32.540860 (Thread-1): finished collecting timing info
2021-10-06 16:37:32.545770 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:37:32.549006 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  column "digit" does not exist
  LINE 7:     digit = 0,
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "digit" does not exist
LINE 7:     digit = 0,
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  column "digit" does not exist
  LINE 7:     digit = 0,
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:37:32.554185 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b03e36-8710-4179-b3a1-8dd52f31a39e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91c7e22b0>]}
2021-10-06 16:37:32.557937 (Thread-1): 16:37:32 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.15s]
2021-10-06 16:37:32.561340 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:37:32.568775 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:37:32.571849 (MainThread): Using postgres connection "master".
2021-10-06 16:37:32.574665 (MainThread): On master: BEGIN
2021-10-06 16:37:32.577443 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:37:32.585110 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:37:32.587639 (MainThread): On master: COMMIT
2021-10-06 16:37:32.590108 (MainThread): Using postgres connection "master".
2021-10-06 16:37:32.593555 (MainThread): On master: COMMIT
2021-10-06 16:37:32.596804 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:37:32.599444 (MainThread): On master: Close
2021-10-06 16:37:32.602168 (MainThread): 16:37:32 | 
2021-10-06 16:37:32.604495 (MainThread): 16:37:32 | Finished running 1 view model in 0.42s.
2021-10-06 16:37:32.608598 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:37:32.614338 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:37:32.659020 (MainThread): 
2021-10-06 16:37:32.661543 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:37:32.665833 (MainThread): 
2021-10-06 16:37:32.669286 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:37:32.674584 (MainThread):   column "digit" does not exist
2021-10-06 16:37:32.677599 (MainThread):   LINE 7:     digit = 0,
2021-10-06 16:37:32.681017 (MainThread):               ^
2021-10-06 16:37:32.684079 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:37:32.688215 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 16:37:32.695787 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91d03cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91d2bca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe91d0d3310>]}
2021-10-06 16:37:32.699899 (MainThread): Flushing usage events
2021-10-06 16:38:27.977737 (MainThread): Running with dbt=0.19.0
2021-10-06 16:38:28.223120 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:38:28.238884 (MainThread): Tracking: tracking
2021-10-06 16:38:28.246830 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff859629d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff857b82fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff857b93130>]}
2021-10-06 16:38:28.289434 (MainThread): Partial parsing not enabled
2021-10-06 16:38:28.301354 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:38:28.305238 (MainThread): Parsing macros/relations.sql
2021-10-06 16:38:28.314674 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:38:28.344349 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:38:28.354284 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:38:28.366376 (MainThread): Parsing macros/core.sql
2021-10-06 16:38:28.373350 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:38:28.418350 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:38:28.429240 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:38:28.437595 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:38:28.444645 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:38:28.465599 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:38:28.470317 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:38:28.501821 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:38:28.517522 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:38:28.541923 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:38:28.546079 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:38:28.555422 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:38:28.573510 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:38:28.580632 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:38:28.584963 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:38:28.598048 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:38:28.602056 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:38:28.606919 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:38:28.612836 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:38:28.620280 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:38:28.625812 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:38:28.629742 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:38:28.647300 (MainThread): Partial parsing not enabled
2021-10-06 16:38:28.697078 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:38:28.737140 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:28.777193 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:38:29.025981 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:38:29.036272 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8322e17f-83f9-45f6-bf73-f11dd3d43968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8579d2670>]}
2021-10-06 16:38:29.097447 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:38:29.101432 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 16:38:29.107309 (MainThread): 
2021-10-06 16:38:29.115890 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:38:29.125387 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:38:29.149286 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:38:29.151762 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:38:29.154253 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:38:29.164080 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 16:38:29.169487 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:38:29.177672 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:38:29.193481 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:38:29.196020 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:38:29.198347 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:38:29.207979 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:38:29.210792 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:38:29.214318 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:38:29.220828 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:38:29.239432 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:38:29.242610 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:38:29.257800 (MainThread): Using postgres connection "master".
2021-10-06 16:38:29.261051 (MainThread): On master: BEGIN
2021-10-06 16:38:29.264050 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:38:29.272821 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:38:29.275860 (MainThread): Using postgres connection "master".
2021-10-06 16:38:29.279161 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:38:29.286713 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:38:29.293423 (MainThread): On master: ROLLBACK
2021-10-06 16:38:29.296161 (MainThread): Using postgres connection "master".
2021-10-06 16:38:29.298443 (MainThread): On master: BEGIN
2021-10-06 16:38:29.301686 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:38:29.304771 (MainThread): On master: COMMIT
2021-10-06 16:38:29.307332 (MainThread): Using postgres connection "master".
2021-10-06 16:38:29.310882 (MainThread): On master: COMMIT
2021-10-06 16:38:29.313483 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:38:29.315344 (MainThread): On master: Close
2021-10-06 16:38:29.317518 (MainThread): 16:38:29 | Concurrency: 2 threads (target='dev')
2021-10-06 16:38:29.320049 (MainThread): 16:38:29 | 
2021-10-06 16:38:29.330308 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:38:29.333557 (Thread-1): 16:38:29 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:38:29.336883 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:29.340787 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:38:29.360851 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:38:29.367758 (Thread-1): finished collecting timing info
2021-10-06 16:38:29.396341 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:29.398607 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:38:29.400362 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:38:29.407209 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:38:29.411911 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:29.413935 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:38:29.416432 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:38:29.423177 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:38:29.430099 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:29.432333 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:38:29.435216 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:38:29.438247 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:29.442814 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
    creditcard::numeric % 10

    as Validity, 
    sum(o.totalamount) as Lost_Sum
from "dellstore"."public"."orders" o
join "dellstore"."public"."customers" c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:38:29.459317 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 16:38:29.476838 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:29.479384 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-06 16:38:29.483695 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:38:29.491817 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:29.494273 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-06 16:38:29.498396 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 16:38:29.519338 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 16:38:29.523185 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:29.526602 (Thread-1): On model.my_new_project.lostamounts: COMMIT
2021-10-06 16:38:29.536077 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-06 16:38:29.546978 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:29.549677 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:38:29.559101 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:38:29.564487 (Thread-1): finished collecting timing info
2021-10-06 16:38:29.567231 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:38:29.569743 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8322e17f-83f9-45f6-bf73-f11dd3d43968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff857a4b5e0>]}
2021-10-06 16:38:29.573830 (Thread-1): 16:38:29 | 1 of 1 OK created view model public.lostamounts...................... [CREATE VIEW in 0.23s]
2021-10-06 16:38:29.576356 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:38:29.582311 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:38:29.586116 (MainThread): Using postgres connection "master".
2021-10-06 16:38:29.588362 (MainThread): On master: BEGIN
2021-10-06 16:38:29.591805 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:38:29.598877 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:38:29.602211 (MainThread): On master: COMMIT
2021-10-06 16:38:29.606317 (MainThread): Using postgres connection "master".
2021-10-06 16:38:29.608514 (MainThread): On master: COMMIT
2021-10-06 16:38:29.610871 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:38:29.612851 (MainThread): On master: Close
2021-10-06 16:38:29.616249 (MainThread): 16:38:29 | 
2021-10-06 16:38:29.618338 (MainThread): 16:38:29 | Finished running 1 view model in 0.50s.
2021-10-06 16:38:29.622060 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:38:29.626526 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:38:29.678421 (MainThread): 
2021-10-06 16:38:29.681253 (MainThread): Completed successfully
2021-10-06 16:38:29.686200 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 16:38:29.691419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff857927ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85794e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85794e640>]}
2021-10-06 16:38:29.695215 (MainThread): Flushing usage events
2021-10-06 16:38:42.506840 (MainThread): Running with dbt=0.19.0
2021-10-06 16:38:42.748006 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:38:42.757569 (MainThread): Tracking: tracking
2021-10-06 16:38:42.760939 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e97f739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e99a1e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e97f841c0>]}
2021-10-06 16:38:42.792611 (MainThread): Partial parsing not enabled
2021-10-06 16:38:42.801895 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:38:42.810564 (MainThread): Parsing macros/relations.sql
2021-10-06 16:38:42.820867 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:38:42.851716 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:38:42.864894 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:38:42.873935 (MainThread): Parsing macros/core.sql
2021-10-06 16:38:42.883566 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:38:42.944518 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:38:42.960181 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:38:42.972257 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:38:42.984417 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:38:43.012423 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:38:43.019252 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:38:43.053913 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:38:43.071861 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:38:43.095571 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:38:43.100264 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:38:43.109831 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:38:43.120477 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:38:43.124398 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:38:43.128422 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:38:43.141597 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:38:43.146604 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:38:43.150437 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:38:43.154608 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:38:43.158710 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:38:43.163862 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:38:43.170496 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:38:43.192498 (MainThread): Partial parsing not enabled
2021-10-06 16:38:43.239675 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:38:43.269236 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:43.295101 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:38:43.502703 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:38:43.528120 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ff686eb-5d71-42e0-bba3-8d6a3514abc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e97dc2610>]}
2021-10-06 16:38:43.612810 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:38:43.618654 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 16:38:43.624585 (MainThread): 
2021-10-06 16:38:43.631454 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:38:43.637725 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:38:43.656964 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:38:43.659113 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:38:43.660911 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:38:43.671863 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 16:38:43.685562 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:38:43.696502 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:38:43.705198 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:38:43.708566 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:38:43.710492 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:38:43.718009 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:38:43.720974 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:38:43.724486 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:38:43.737713 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-10-06 16:38:43.748615 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:38:43.751552 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:38:43.763343 (MainThread): Using postgres connection "master".
2021-10-06 16:38:43.766325 (MainThread): On master: BEGIN
2021-10-06 16:38:43.768462 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:38:43.774711 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:38:43.777365 (MainThread): Using postgres connection "master".
2021-10-06 16:38:43.779505 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:38:43.795289 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:38:43.802169 (MainThread): On master: ROLLBACK
2021-10-06 16:38:43.805479 (MainThread): Using postgres connection "master".
2021-10-06 16:38:43.807696 (MainThread): On master: BEGIN
2021-10-06 16:38:43.810354 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:38:43.813908 (MainThread): On master: COMMIT
2021-10-06 16:38:43.815875 (MainThread): Using postgres connection "master".
2021-10-06 16:38:43.817652 (MainThread): On master: COMMIT
2021-10-06 16:38:43.819681 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:38:43.821983 (MainThread): On master: Close
2021-10-06 16:38:43.827212 (MainThread): 16:38:43 | Concurrency: 2 threads (target='dev')
2021-10-06 16:38:43.830070 (MainThread): 16:38:43 | 
2021-10-06 16:38:43.838196 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:38:43.843705 (Thread-1): 16:38:43 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:38:43.846861 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:43.851847 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:38:43.873965 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:38:43.881675 (Thread-1): finished collecting timing info
2021-10-06 16:38:43.913704 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:43.916471 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:38:43.918611 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:38:43.931611 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:38:43.938843 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:43.941609 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:38:43.945236 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:38:43.953446 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:38:43.960529 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:43.963727 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:38:43.967558 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:38:43.970686 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:38:43.974204 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
    digit = creditcard::numeric % 10

    as Validity, 
    sum(o.totalamount) as Lost_Sum
from "dellstore"."public"."orders" o
join "dellstore"."public"."customers" c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:38:43.979406 (Thread-1): Postgres error: column "digit" does not exist
LINE 7:     digit = creditcard::numeric % 10
            ^

2021-10-06 16:38:43.983975 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:38:43.988971 (Thread-1): finished collecting timing info
2021-10-06 16:38:43.992242 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:38:43.996114 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  column "digit" does not exist
  LINE 7:     digit = creditcard::numeric % 10
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "digit" does not exist
LINE 7:     digit = creditcard::numeric % 10
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  column "digit" does not exist
  LINE 7:     digit = creditcard::numeric % 10
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:38:44.002322 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ff686eb-5d71-42e0-bba3-8d6a3514abc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e97eacc70>]}
2021-10-06 16:38:44.005949 (Thread-1): 16:38:44 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.16s]
2021-10-06 16:38:44.008218 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:38:44.014051 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:38:44.018843 (MainThread): Using postgres connection "master".
2021-10-06 16:38:44.021756 (MainThread): On master: BEGIN
2021-10-06 16:38:44.024681 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:38:44.037838 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:38:44.042975 (MainThread): On master: COMMIT
2021-10-06 16:38:44.046852 (MainThread): Using postgres connection "master".
2021-10-06 16:38:44.049708 (MainThread): On master: COMMIT
2021-10-06 16:38:44.053463 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:38:44.056749 (MainThread): On master: Close
2021-10-06 16:38:44.061090 (MainThread): 16:38:44 | 
2021-10-06 16:38:44.065404 (MainThread): 16:38:44 | Finished running 1 view model in 0.43s.
2021-10-06 16:38:44.068685 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:38:44.072456 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:38:44.131931 (MainThread): 
2021-10-06 16:38:44.136517 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:38:44.142276 (MainThread): 
2021-10-06 16:38:44.147820 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:38:44.151523 (MainThread):   column "digit" does not exist
2021-10-06 16:38:44.154867 (MainThread):   LINE 7:     digit = creditcard::numeric % 10
2021-10-06 16:38:44.158156 (MainThread):               ^
2021-10-06 16:38:44.162485 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:38:44.166339 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 16:38:44.169801 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e97d17ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9749ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9749aaf0>]}
2021-10-06 16:38:44.173271 (MainThread): Flushing usage events
2021-10-06 16:39:02.765006 (MainThread): Running with dbt=0.19.0
2021-10-06 16:39:02.982216 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 16:39:02.991276 (MainThread): Tracking: tracking
2021-10-06 16:39:02.995344 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff610413970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff611ebe280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff610425160>]}
2021-10-06 16:39:03.061261 (MainThread): Partial parsing not enabled
2021-10-06 16:39:03.077465 (MainThread): Parsing macros/Luhns.sql
2021-10-06 16:39:03.081590 (MainThread): Parsing macros/relations.sql
2021-10-06 16:39:03.086108 (MainThread): Parsing macros/adapters.sql
2021-10-06 16:39:03.107733 (MainThread): Parsing macros/catalog.sql
2021-10-06 16:39:03.113991 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 16:39:03.119611 (MainThread): Parsing macros/core.sql
2021-10-06 16:39:03.126076 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 16:39:03.172355 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 16:39:03.186498 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 16:39:03.196669 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 16:39:03.213219 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 16:39:03.245160 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 16:39:03.250650 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 16:39:03.290830 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 16:39:03.311080 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 16:39:03.400431 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 16:39:03.418951 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 16:39:03.430792 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 16:39:03.442838 (MainThread): Parsing macros/etc/query.sql
2021-10-06 16:39:03.447300 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 16:39:03.452332 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 16:39:03.467867 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 16:39:03.473203 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 16:39:03.478086 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 16:39:03.481799 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 16:39:03.486796 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 16:39:03.492574 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 16:39:03.497504 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 16:39:03.518317 (MainThread): Partial parsing not enabled
2021-10-06 16:39:03.558682 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-06 16:39:03.588571 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:39:03.614979 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-06 16:39:03.803743 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 16:39:03.809772 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f33c41-bbea-463c-9b07-c68471aaec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6102626a0>]}
2021-10-06 16:39:03.862826 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 16:39:03.865995 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 16:39:03.869016 (MainThread): 
2021-10-06 16:39:03.872361 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:39:03.879035 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 16:39:03.900384 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 16:39:03.904108 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 16:39:03.906611 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 16:39:03.914645 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 16:39:03.925412 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 16:39:03.934020 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 16:39:03.943575 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:39:03.946208 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 16:39:03.948827 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 16:39:03.956194 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:39:03.959891 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 16:39:03.965437 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 16:39:03.972227 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 16:39:03.983773 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 16:39:03.986541 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 16:39:03.997392 (MainThread): Using postgres connection "master".
2021-10-06 16:39:04.000108 (MainThread): On master: BEGIN
2021-10-06 16:39:04.003422 (MainThread): Opening a new connection, currently in state init
2021-10-06 16:39:04.010972 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:39:04.014328 (MainThread): Using postgres connection "master".
2021-10-06 16:39:04.016963 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 16:39:04.027017 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 16:39:04.032825 (MainThread): On master: ROLLBACK
2021-10-06 16:39:04.036460 (MainThread): Using postgres connection "master".
2021-10-06 16:39:04.039011 (MainThread): On master: BEGIN
2021-10-06 16:39:04.041544 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:39:04.044885 (MainThread): On master: COMMIT
2021-10-06 16:39:04.047491 (MainThread): Using postgres connection "master".
2021-10-06 16:39:04.051421 (MainThread): On master: COMMIT
2021-10-06 16:39:04.053851 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:39:04.055916 (MainThread): On master: Close
2021-10-06 16:39:04.059753 (MainThread): 16:39:04 | Concurrency: 2 threads (target='dev')
2021-10-06 16:39:04.062199 (MainThread): 16:39:04 | 
2021-10-06 16:39:04.073354 (Thread-1): Began running node model.my_new_project.lostamounts
2021-10-06 16:39:04.076844 (Thread-1): 16:39:04 | 1 of 1 START view model public.lostamounts........................... [RUN]
2021-10-06 16:39:04.079484 (Thread-1): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:39:04.084972 (Thread-1): Compiling model.my_new_project.lostamounts
2021-10-06 16:39:04.109248 (Thread-1): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:39:04.117974 (Thread-1): finished collecting timing info
2021-10-06 16:39:04.145664 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:39:04.148080 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-06 16:39:04.150198 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 16:39:04.159086 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 16:39:04.169054 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:39:04.171050 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-06 16:39:04.173576 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 16:39:04.181593 (Thread-1): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-06 16:39:04.189119 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:39:04.191230 (Thread-1): On model.my_new_project.lostamounts: BEGIN
2021-10-06 16:39:04.193603 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 16:39:04.196518 (Thread-1): Using postgres connection "model.my_new_project.lostamounts".
2021-10-06 16:39:04.200022 (Thread-1): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate, 
    
    digit = creditcard::numeric % 10

    as Validity, 
    sum(o.totalamount) as Lost_Sum
from "dellstore"."public"."orders" o
join "dellstore"."public"."customers" c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-06 16:39:04.204834 (Thread-1): Postgres error: column "digit" does not exist
LINE 7:     digit = creditcard::numeric % 10
            ^

2021-10-06 16:39:04.209409 (Thread-1): On model.my_new_project.lostamounts: ROLLBACK
2021-10-06 16:39:04.212197 (Thread-1): finished collecting timing info
2021-10-06 16:39:04.214238 (Thread-1): On model.my_new_project.lostamounts: Close
2021-10-06 16:39:04.219637 (Thread-1): Database Error in model lostamounts (models/lostamounts.sql)
  column "digit" does not exist
  LINE 7:     digit = creditcard::numeric % 10
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "digit" does not exist
LINE 7:     digit = creditcard::numeric % 10
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  column "digit" does not exist
  LINE 7:     digit = creditcard::numeric % 10
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:39:04.226101 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f33c41-bbea-463c-9b07-c68471aaec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6101e5fd0>]}
2021-10-06 16:39:04.229527 (Thread-1): 16:39:04 | 1 of 1 ERROR creating view model public.lostamounts.................. [ERROR in 0.15s]
2021-10-06 16:39:04.232313 (Thread-1): Finished running node model.my_new_project.lostamounts
2021-10-06 16:39:04.241873 (MainThread): Acquiring new postgres connection "master".
2021-10-06 16:39:04.244213 (MainThread): Using postgres connection "master".
2021-10-06 16:39:04.246402 (MainThread): On master: BEGIN
2021-10-06 16:39:04.249309 (MainThread): Opening a new connection, currently in state closed
2021-10-06 16:39:04.257894 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 16:39:04.261392 (MainThread): On master: COMMIT
2021-10-06 16:39:04.266489 (MainThread): Using postgres connection "master".
2021-10-06 16:39:04.269454 (MainThread): On master: COMMIT
2021-10-06 16:39:04.273029 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 16:39:04.276137 (MainThread): On master: Close
2021-10-06 16:39:04.279027 (MainThread): 16:39:04 | 
2021-10-06 16:39:04.282292 (MainThread): 16:39:04 | Finished running 1 view model in 0.41s.
2021-10-06 16:39:04.287371 (MainThread): Connection 'master' was properly closed.
2021-10-06 16:39:04.291283 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-06 16:39:04.358256 (MainThread): 
2021-10-06 16:39:04.364447 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 16:39:04.368263 (MainThread): 
2021-10-06 16:39:04.372923 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-06 16:39:04.376964 (MainThread):   column "digit" does not exist
2021-10-06 16:39:04.379465 (MainThread):   LINE 7:     digit = creditcard::numeric % 10
2021-10-06 16:39:04.384356 (MainThread):               ^
2021-10-06 16:39:04.390581 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-06 16:39:04.394205 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 16:39:04.397700 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6101b8e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60f9398b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60f939850>]}
2021-10-06 16:39:04.403282 (MainThread): Flushing usage events
2021-10-07 12:59:23.871316 (MainThread): Running with dbt=0.19.0
2021-10-07 12:59:25.127644 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 12:59:25.319900 (MainThread): Tracking: tracking
2021-10-07 12:59:25.332064 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3298b429d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329a5ed310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3298b531c0>]}
2021-10-07 12:59:25.421304 (MainThread): Partial parsing not enabled
2021-10-07 12:59:25.435605 (MainThread): Parsing macros/Luhns.sql
2021-10-07 12:59:25.478244 (MainThread): Parsing macros/relations.sql
2021-10-07 12:59:25.523949 (MainThread): Parsing macros/adapters.sql
2021-10-07 12:59:25.618195 (MainThread): Parsing macros/catalog.sql
2021-10-07 12:59:25.625095 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 12:59:25.679954 (MainThread): Parsing macros/core.sql
2021-10-07 12:59:25.719737 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 12:59:25.812793 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 12:59:25.841119 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 12:59:25.854378 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 12:59:25.882634 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 12:59:25.923744 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 12:59:25.943656 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 12:59:25.995315 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 12:59:26.021532 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 12:59:26.096463 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 12:59:26.107293 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 12:59:26.123230 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 12:59:26.157862 (MainThread): Parsing macros/etc/query.sql
2021-10-07 12:59:26.174284 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 12:59:26.217566 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 12:59:26.253958 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 12:59:26.261681 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 12:59:26.294127 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 12:59:26.314538 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 12:59:26.322735 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 12:59:26.356085 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 12:59:26.366702 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 12:59:26.456312 (MainThread): Partial parsing not enabled
2021-10-07 12:59:26.615373 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 12:59:26.747260 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 12:59:26.779893 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3298b14eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3298966eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3298962520>]}
2021-10-07 12:59:26.810285 (MainThread): Flushing usage events
2021-10-07 12:59:29.125033 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 12:59:29.133769 (MainThread): Encountered an error:
2021-10-07 12:59:29.139635 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  expected token ',', got ':'
    line 3
      {{ Luhns('creditcard'::numeric) }}
2021-10-07 12:59:29.426460 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got ':'
  line 3
    {{ Luhns('creditcard'::numeric) }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  expected token ',', got ':'
    line 3
      {{ Luhns('creditcard'::numeric) }}

2021-10-07 13:00:01.785361 (MainThread): Running with dbt=0.19.0
2021-10-07 13:00:02.386448 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['lostamounts'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 13:00:02.421331 (MainThread): Tracking: tracking
2021-10-07 13:00:02.430255 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068a3dbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068d9e2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068a3ec0d0>]}
2021-10-07 13:00:02.486535 (MainThread): Partial parsing not enabled
2021-10-07 13:00:02.519771 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:00:02.525304 (MainThread): Parsing macros/relations.sql
2021-10-07 13:00:02.544242 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:00:02.583543 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:00:02.592808 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:00:02.601511 (MainThread): Parsing macros/core.sql
2021-10-07 13:00:02.663404 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:00:02.755119 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:00:02.779071 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:00:02.797640 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:00:02.817577 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:00:02.855125 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:00:02.861842 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:00:02.918073 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:00:02.948148 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:00:02.986424 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:00:02.994445 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:00:03.012033 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:00:03.031158 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:00:03.038059 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:00:03.047424 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:00:03.069671 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:00:03.084942 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:00:03.093104 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:00:03.099513 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:00:03.108141 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:00:03.117474 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:00:03.131981 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:00:03.162391 (MainThread): Partial parsing not enabled
2021-10-07 13:00:03.269177 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:00:03.361978 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:00:03.385962 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068a339bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068a1fff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f068a1fb820>]}
2021-10-07 13:00:03.391556 (MainThread): Flushing usage events
2021-10-07 13:00:04.646715 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:00:04.654133 (MainThread): Encountered an error:
2021-10-07 13:00:04.659491 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  not all arguments converted during string formatting
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:00:04.795791 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
TypeError: not all arguments converted during string formatting

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  not all arguments converted during string formatting
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 13:04:39.286196 (MainThread): Running with dbt=0.19.0
2021-10-07 13:04:40.173531 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:04:40.207408 (MainThread): Tracking: tracking
2021-10-07 13:04:40.230427 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb282412cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb283eb9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2824233d0>]}
2021-10-07 13:04:40.364241 (MainThread): Partial parsing not enabled
2021-10-07 13:04:40.378296 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:04:40.390936 (MainThread): Parsing macros/relations.sql
2021-10-07 13:04:40.404079 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:04:40.518744 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:04:40.538390 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:04:40.556208 (MainThread): Parsing macros/core.sql
2021-10-07 13:04:40.581386 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:04:40.860318 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:04:40.917371 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:04:40.972015 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:04:41.008968 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:04:41.129895 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:04:41.144470 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:04:41.299706 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:04:41.377527 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:04:41.482268 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:04:41.502458 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:04:41.544452 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:04:41.585395 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:04:41.607255 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:04:41.628066 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:04:41.704613 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:04:41.733271 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:04:41.773125 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:04:41.795884 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:04:41.809287 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:04:41.825523 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:04:41.844090 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:04:41.902402 (MainThread): Partial parsing not enabled
2021-10-07 13:04:42.142993 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:04:42.306457 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:04:42.345305 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb282379220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb282230e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb282239700>]}
2021-10-07 13:04:42.360475 (MainThread): Flushing usage events
2021-10-07 13:04:43.088266 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:04:43.097178 (MainThread): Encountered an error:
2021-10-07 13:04:43.102030 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  not all arguments converted during string formatting
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:04:43.146618 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
TypeError: not all arguments converted during string formatting

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  not all arguments converted during string formatting
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 13:12:16.290830 (MainThread): Running with dbt=0.19.0
2021-10-07 13:12:16.529021 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:12:16.542060 (MainThread): Tracking: tracking
2021-10-07 13:12:16.546058 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e85d6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ea07dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e85e8340>]}
2021-10-07 13:12:16.603707 (MainThread): Partial parsing not enabled
2021-10-07 13:12:16.616145 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:12:16.619762 (MainThread): Parsing macros/relations.sql
2021-10-07 13:12:16.623945 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:12:16.648448 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:12:16.653961 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:12:16.659068 (MainThread): Parsing macros/core.sql
2021-10-07 13:12:16.667916 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:12:16.714171 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:12:16.728948 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:12:16.740894 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:12:16.749590 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:12:16.775034 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:12:16.779684 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:12:16.813172 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:12:16.829868 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:12:16.855124 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:12:16.869078 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:12:16.885558 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:12:16.895140 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:12:16.899165 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:12:16.903960 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:12:16.916575 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:12:16.921369 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:12:16.925946 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:12:16.929327 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:12:16.934238 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:12:16.941431 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:12:16.946247 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:12:16.966444 (MainThread): Partial parsing not enabled
2021-10-07 13:12:17.024959 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:12:17.060169 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:12:17.069169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e853cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e83f3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e83fc370>]}
2021-10-07 13:12:17.072134 (MainThread): Flushing usage events
2021-10-07 13:12:17.705423 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:12:17.713900 (MainThread): Encountered an error:
2021-10-07 13:12:17.718947 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  not all arguments converted during string formatting
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:12:17.743017 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
TypeError: not all arguments converted during string formatting

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  not all arguments converted during string formatting
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 13:13:04.909078 (MainThread): Running with dbt=0.19.0
2021-10-07 13:13:05.563170 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:13:05.590085 (MainThread): Tracking: tracking
2021-10-07 13:13:05.601157 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9154c03cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91566aad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9154c153d0>]}
2021-10-07 13:13:05.752717 (MainThread): Partial parsing not enabled
2021-10-07 13:13:05.786079 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:13:05.803827 (MainThread): Parsing macros/relations.sql
2021-10-07 13:13:05.819465 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:13:05.920219 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:13:05.933399 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:13:05.952108 (MainThread): Parsing macros/core.sql
2021-10-07 13:13:05.985930 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:13:06.220889 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:13:06.265140 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:13:06.299017 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:13:06.337465 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:13:06.421372 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:13:06.450401 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:13:06.605330 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:13:06.706893 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:13:06.834165 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:13:06.847701 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:13:06.884512 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:13:06.920980 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:13:06.930247 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:13:06.942873 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:13:07.001089 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:13:07.014213 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:13:07.024098 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:13:07.034994 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:13:07.050256 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:13:07.066357 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:13:07.079154 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:13:07.141521 (MainThread): Partial parsing not enabled
2021-10-07 13:13:07.374479 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:13:07.523649 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:13:07.564563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9154bc5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9154a21e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9154a2a8e0>]}
2021-10-07 13:13:07.571137 (MainThread): Flushing usage events
2021-10-07 13:13:08.121780 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:13:08.129141 (MainThread): Encountered an error:
2021-10-07 13:13:08.133413 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  unsupported operand type(s) for /: 'str' and 'int'
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:13:08.160375 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
TypeError: unsupported operand type(s) for /: 'str' and 'int'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  unsupported operand type(s) for /: 'str' and 'int'
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 13:13:53.820483 (MainThread): Running with dbt=0.19.0
2021-10-07 13:13:54.113527 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:13:54.128694 (MainThread): Tracking: tracking
2021-10-07 13:13:54.136738 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb69b2cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb6b5d3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb69b3d310>]}
2021-10-07 13:13:54.203850 (MainThread): Partial parsing not enabled
2021-10-07 13:13:54.213999 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:13:54.219952 (MainThread): Parsing macros/relations.sql
2021-10-07 13:13:54.226400 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:13:54.267763 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:13:54.280579 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:13:54.290210 (MainThread): Parsing macros/core.sql
2021-10-07 13:13:54.301059 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:13:54.377941 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:13:54.402713 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:13:54.418771 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:13:54.428787 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:13:54.469119 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:13:54.474514 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:13:54.524206 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:13:54.550068 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:13:54.605061 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:13:54.612996 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:13:54.629944 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:13:54.652187 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:13:54.658140 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:13:54.663764 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:13:54.681198 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:13:54.687587 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:13:54.693741 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:13:54.698598 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:13:54.703969 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:13:54.711107 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:13:54.716671 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:13:54.736697 (MainThread): Partial parsing not enabled
2021-10-07 13:13:54.800734 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:13:54.845660 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:13:54.884883 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:13:55.181431 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:13:55.193281 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f3be6a-1819-44ec-b927-34bad296fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb69984430>]}
2021-10-07 13:13:55.310029 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:13:55.313737 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:13:55.316564 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:13:55.319598 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:13:55.411640 (MainThread): SQL status: BEGIN in 0.09 seconds
2021-10-07 13:13:55.419568 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:13:55.423253 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:13:55.427400 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:13:55.433013 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:13:55.443839 (MainThread): 10005.0
2021-10-07 13:13:55.450813 (MainThread): On macro_Luhns: Close
2021-10-07 13:13:55.468035 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb69b2cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb698d6a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb698d6d90>]}
2021-10-07 13:13:55.475497 (MainThread): Flushing usage events
2021-10-07 13:13:56.057055 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:19:12.792102 (MainThread): Running with dbt=0.19.0
2021-10-07 13:19:13.012413 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 13:19:13.026937 (MainThread): Tracking: tracking
2021-10-07 13:19:13.033732 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a69c70970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6b69c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a69c81160>]}
2021-10-07 13:19:13.112111 (MainThread): Partial parsing not enabled
2021-10-07 13:19:13.122964 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:19:13.127304 (MainThread): Parsing macros/relations.sql
2021-10-07 13:19:13.132427 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:19:13.163650 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:19:13.168502 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:19:13.173517 (MainThread): Parsing macros/core.sql
2021-10-07 13:19:13.180314 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:19:13.235216 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:19:13.254458 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:19:13.269489 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:19:13.283774 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:19:13.309076 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:19:13.314241 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:19:13.348517 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:19:13.366473 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:19:13.394607 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:19:13.399641 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:19:13.409990 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:19:13.424333 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:19:13.428208 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:19:13.432026 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:19:13.445524 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:19:13.449918 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:19:13.454347 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:19:13.458364 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:19:13.463047 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:19:13.471386 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:19:13.476690 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:19:13.495335 (MainThread): Partial parsing not enabled
2021-10-07 13:19:13.539588 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:13.572442 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:13.598014 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:19:13.820319 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:19:13.838892 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c433846-6025-4ad7-bed0-cb5e6dabb35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a69b1f7f0>]}
2021-10-07 13:19:13.904508 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 13:19:13.911439 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 5 sources, 0 exposures
2021-10-07 13:19:13.916834 (MainThread): 
2021-10-07 13:19:13.921503 (MainThread): Acquiring new postgres connection "master".
2021-10-07 13:19:13.952355 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 13:19:13.983211 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 13:19:13.990258 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 13:19:13.994527 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 13:19:14.113764 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.12 seconds
2021-10-07 13:19:14.130316 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 13:19:14.148265 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 13:19:14.169588 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 13:19:14.176882 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 13:19:14.180513 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-07 13:19:14.197364 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-10-07 13:19:14.202272 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 13:19:14.206656 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 13:19:14.286440 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.08 seconds
2021-10-07 13:19:14.305626 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 13:19:14.309967 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 13:19:14.327530 (MainThread): Using postgres connection "master".
2021-10-07 13:19:14.330186 (MainThread): On master: BEGIN
2021-10-07 13:19:14.333032 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:19:14.347399 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:19:14.351179 (MainThread): Using postgres connection "master".
2021-10-07 13:19:14.354564 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 13:19:14.473399 (MainThread): SQL status: SELECT 2 in 0.11 seconds
2021-10-07 13:19:14.481030 (MainThread): On master: ROLLBACK
2021-10-07 13:19:14.484195 (MainThread): Using postgres connection "master".
2021-10-07 13:19:14.486450 (MainThread): On master: BEGIN
2021-10-07 13:19:14.490432 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 13:19:14.494363 (MainThread): On master: COMMIT
2021-10-07 13:19:14.497684 (MainThread): Using postgres connection "master".
2021-10-07 13:19:14.501358 (MainThread): On master: COMMIT
2021-10-07 13:19:14.504897 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:19:14.508131 (MainThread): On master: Close
2021-10-07 13:19:14.511672 (MainThread): 13:19:14 | Concurrency: 2 threads (target='dev')
2021-10-07 13:19:14.516378 (MainThread): 13:19:14 | 
2021-10-07 13:19:14.531717 (Thread-1): Began running node model.my_new_project.firstnames
2021-10-07 13:19:14.532256 (Thread-2): Began running node model.my_new_project.lostamounts
2021-10-07 13:19:14.536996 (Thread-1): 13:19:14 | 1 of 2 START table model public.firstnames........................... [RUN]
2021-10-07 13:19:14.540433 (Thread-2): 13:19:14 | 2 of 2 START view model public.lostamounts........................... [RUN]
2021-10-07 13:19:14.545181 (Thread-1): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:14.549890 (Thread-2): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:14.557116 (Thread-1): Compiling model.my_new_project.firstnames
2021-10-07 13:19:14.560296 (Thread-2): Compiling model.my_new_project.lostamounts
2021-10-07 13:19:14.597944 (Thread-1): Writing injected SQL for node "model.my_new_project.firstnames"
2021-10-07 13:19:14.602059 (Thread-2): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-07 13:19:14.617320 (Thread-1): finished collecting timing info
2021-10-07 13:19:14.620618 (Thread-2): finished collecting timing info
2021-10-07 13:19:14.666808 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:14.682223 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_tmp" cascade
2021-10-07 13:19:14.698193 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 13:19:14.720069 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:14.722550 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-07 13:19:14.725217 (Thread-2): Opening a new connection, currently in state closed
2021-10-07 13:19:14.737571 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-07 13:19:14.738142 (Thread-1): SQL status: DROP TABLE in 0.04 seconds
2021-10-07 13:19:14.745858 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:14.756326 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-07 13:19:14.759079 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-07 13:19:14.753241 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:14.772294 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-07 13:19:14.769139 (Thread-2): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-07 13:19:14.776420 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 13:19:14.793150 (Thread-1): Writing runtime SQL for node "model.my_new_project.firstnames"
2021-10-07 13:19:14.801229 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:14.805045 (Thread-2): On model.my_new_project.lostamounts: BEGIN
2021-10-07 13:19:14.808701 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-07 13:19:14.811006 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:14.813924 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:14.817607 (Thread-1): On model.my_new_project.firstnames: BEGIN
2021-10-07 13:19:14.822471 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate,
    sum(o.totalamount) as Lost_Sum
from "dellstore"."public"."orders" o
join "dellstore"."public"."customers" c
on c.customerid=o.customerid
group by 1,2
  );

2021-10-07 13:19:14.825730 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 13:19:14.843292 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:14.852480 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */


  create  table "dellstore"."public"."firstnames__dbt_tmp"
  as (
    -- 1) TASK
-- Requirements:
-- create a table with following columns:
-- first name of the actor/actress
-- number of movies where such first name has been an actor
-- sum of the price of the movies where such first name has been an actor

-- Use dbt - models, sources, snapshotting
-- try inserting a new row into the products table + running the snapshot again

-- table


-- select
select first_name as id, count(distinct title) title_count, sum(price) price_sum from "dellstore"."public"."products" p
join (
	select distinct concat(split_part(actor, ' ', 1),'%') first_name from "dellstore"."public"."products"
) b
on p.actor like b.first_name
group by 1
order by 1


-- changes I tried with results in snapshot:

-- insert into products
-- values (0, 2, 'NO SUCH MOVIE', 'AAPO EESTLANE', 100.00, 0, 6633)
-- -- new row was added to snapshot

-- update products
-- set price = 1.22
-- where prod_id = 392
-- -- price_sum changed in snapshot

-- delete from products
-- where prod_id = 392
-- -- title_count (also price_sum) changed in snapshot
  );
2021-10-07 13:19:14.872490 (Thread-2): Postgres error: aggregate functions are not allowed in GROUP BY
LINE 6:     sum(o.totalamount) as Lost_Sum
            ^

2021-10-07 13:19:14.882477 (Thread-2): On model.my_new_project.lostamounts: ROLLBACK
2021-10-07 13:19:14.887270 (Thread-2): finished collecting timing info
2021-10-07 13:19:14.891815 (Thread-2): On model.my_new_project.lostamounts: Close
2021-10-07 13:19:14.895771 (Thread-2): Database Error in model lostamounts (models/lostamounts.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 6:     sum(o.totalamount) as Lost_Sum
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.GroupingError: aggregate functions are not allowed in GROUP BY
LINE 6:     sum(o.totalamount) as Lost_Sum
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model lostamounts (models/lostamounts.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 6:     sum(o.totalamount) as Lost_Sum
              ^
  compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-07 13:19:14.935390 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c433846-6025-4ad7-bed0-cb5e6dabb35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a69b873d0>]}
2021-10-07 13:19:14.942545 (Thread-2): 13:19:14 | 2 of 2 ERROR creating view model public.lostamounts.................. [ERROR in 0.39s]
2021-10-07 13:19:14.947222 (Thread-2): Finished running node model.my_new_project.lostamounts
2021-10-07 13:19:15.471415 (Thread-1): SQL status: SELECT 201 in 0.60 seconds
2021-10-07 13:19:15.491088 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:15.495220 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames" rename to "firstnames__dbt_backup"
2021-10-07 13:19:15.516254 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-10-07 13:19:15.544600 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:15.550955 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames__dbt_tmp" rename to "firstnames"
2021-10-07 13:19:15.566878 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 13:19:15.597330 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-07 13:19:15.603327 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:15.607602 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-07 13:19:15.626205 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-10-07 13:19:15.652049 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:15.665101 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-07 13:19:15.842094 (Thread-1): SQL status: DROP TABLE in 0.17 seconds
2021-10-07 13:19:15.861779 (Thread-1): finished collecting timing info
2021-10-07 13:19:15.872715 (Thread-1): On model.my_new_project.firstnames: Close
2021-10-07 13:19:15.886890 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c433846-6025-4ad7-bed0-cb5e6dabb35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a69b96d30>]}
2021-10-07 13:19:15.900726 (Thread-1): 13:19:15 | 1 of 2 OK created table model public.firstnames...................... [SELECT 201 in 1.34s]
2021-10-07 13:19:15.908060 (Thread-1): Finished running node model.my_new_project.firstnames
2021-10-07 13:19:15.924231 (MainThread): Acquiring new postgres connection "master".
2021-10-07 13:19:15.927986 (MainThread): Using postgres connection "master".
2021-10-07 13:19:15.933545 (MainThread): On master: BEGIN
2021-10-07 13:19:15.940178 (MainThread): Opening a new connection, currently in state closed
2021-10-07 13:19:15.957018 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-07 13:19:15.962639 (MainThread): On master: COMMIT
2021-10-07 13:19:15.969427 (MainThread): Using postgres connection "master".
2021-10-07 13:19:15.974075 (MainThread): On master: COMMIT
2021-10-07 13:19:15.978401 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:19:15.982555 (MainThread): On master: Close
2021-10-07 13:19:15.991719 (MainThread): 13:19:15 | 
2021-10-07 13:19:15.997260 (MainThread): 13:19:15 | Finished running 1 view model, 1 table model in 2.07s.
2021-10-07 13:19:16.008080 (MainThread): Connection 'master' was properly closed.
2021-10-07 13:19:16.014388 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:19:16.019501 (MainThread): Connection 'model.my_new_project.firstnames' was properly closed.
2021-10-07 13:19:16.118885 (MainThread): 
2021-10-07 13:19:16.121560 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 13:19:16.125598 (MainThread): 
2021-10-07 13:19:16.131500 (MainThread): Database Error in model lostamounts (models/lostamounts.sql)
2021-10-07 13:19:16.139952 (MainThread):   aggregate functions are not allowed in GROUP BY
2021-10-07 13:19:16.144256 (MainThread):   LINE 6:     sum(o.totalamount) as Lost_Sum
2021-10-07 13:19:16.149466 (MainThread):               ^
2021-10-07 13:19:16.157365 (MainThread):   compiled SQL at target/run/my_new_project/models/lostamounts.sql
2021-10-07 13:19:16.162982 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-10-07 13:19:16.168618 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a69ac1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a69a48b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a69a48820>]}
2021-10-07 13:19:16.177076 (MainThread): Flushing usage events
2021-10-07 13:19:44.407108 (MainThread): Running with dbt=0.19.0
2021-10-07 13:19:44.633354 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 13:19:44.646270 (MainThread): Tracking: tracking
2021-10-07 13:19:44.651199 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb290431940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb293a38460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb290442130>]}
2021-10-07 13:19:44.719227 (MainThread): Partial parsing not enabled
2021-10-07 13:19:44.724479 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:19:44.728692 (MainThread): Parsing macros/relations.sql
2021-10-07 13:19:44.733399 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:19:44.756010 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:19:44.761666 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:19:44.767182 (MainThread): Parsing macros/core.sql
2021-10-07 13:19:44.773758 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:19:44.821607 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:19:44.833161 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:19:44.843293 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:19:44.852884 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:19:44.872913 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:19:44.876983 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:19:44.913002 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:19:44.931273 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:19:45.011336 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:19:45.023398 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:19:45.050334 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:19:45.072597 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:19:45.082420 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:19:45.092144 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:19:45.131545 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:19:45.147187 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:19:45.159756 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:19:45.171548 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:19:45.178806 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:19:45.193078 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:19:45.205507 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:19:45.252467 (MainThread): Partial parsing not enabled
2021-10-07 13:19:45.330935 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:45.367164 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:45.396317 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:19:45.593795 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:19:45.606435 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2902bcdb-d0fd-46ca-9828-49123c802bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2902ff430>]}
2021-10-07 13:19:45.670748 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 13:19:45.674150 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 5 sources, 0 exposures
2021-10-07 13:19:45.678233 (MainThread): 
2021-10-07 13:19:45.682602 (MainThread): Acquiring new postgres connection "master".
2021-10-07 13:19:45.690088 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 13:19:45.711064 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 13:19:45.714145 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 13:19:45.716567 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 13:19:45.726636 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 13:19:45.733966 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 13:19:45.742133 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 13:19:45.751107 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 13:19:45.753555 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 13:19:45.755878 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 13:19:45.764065 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:19:45.768542 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 13:19:45.772095 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 13:19:45.779599 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 13:19:45.795932 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 13:19:45.801463 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 13:19:45.821717 (MainThread): Using postgres connection "master".
2021-10-07 13:19:45.824188 (MainThread): On master: BEGIN
2021-10-07 13:19:45.826528 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:19:45.837741 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:19:45.840145 (MainThread): Using postgres connection "master".
2021-10-07 13:19:45.842170 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 13:19:45.855125 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-07 13:19:45.862260 (MainThread): On master: ROLLBACK
2021-10-07 13:19:45.865907 (MainThread): Using postgres connection "master".
2021-10-07 13:19:45.869278 (MainThread): On master: BEGIN
2021-10-07 13:19:45.873584 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 13:19:45.877033 (MainThread): On master: COMMIT
2021-10-07 13:19:45.879957 (MainThread): Using postgres connection "master".
2021-10-07 13:19:45.881829 (MainThread): On master: COMMIT
2021-10-07 13:19:45.885080 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:19:45.889565 (MainThread): On master: Close
2021-10-07 13:19:45.892645 (MainThread): 13:19:45 | Concurrency: 2 threads (target='dev')
2021-10-07 13:19:45.895046 (MainThread): 13:19:45 | 
2021-10-07 13:19:45.904423 (Thread-1): Began running node model.my_new_project.firstnames
2021-10-07 13:19:45.905097 (Thread-2): Began running node model.my_new_project.lostamounts
2021-10-07 13:19:45.908134 (Thread-1): 13:19:45 | 1 of 2 START table model public.firstnames........................... [RUN]
2021-10-07 13:19:45.913975 (Thread-2): 13:19:45 | 2 of 2 START view model public.lostamounts........................... [RUN]
2021-10-07 13:19:45.917789 (Thread-1): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:45.924376 (Thread-2): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:45.926733 (Thread-1): Compiling model.my_new_project.firstnames
2021-10-07 13:19:45.930614 (Thread-2): Compiling model.my_new_project.lostamounts
2021-10-07 13:19:45.969682 (Thread-2): Writing injected SQL for node "model.my_new_project.lostamounts"
2021-10-07 13:19:45.971994 (Thread-1): Writing injected SQL for node "model.my_new_project.firstnames"
2021-10-07 13:19:45.985126 (Thread-2): finished collecting timing info
2021-10-07 13:19:45.990640 (Thread-1): finished collecting timing info
2021-10-07 13:19:46.058259 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:46.058955 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:46.062898 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_tmp" cascade
2021-10-07 13:19:46.066468 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_tmp" cascade
2021-10-07 13:19:46.068575 (Thread-2): Opening a new connection, currently in state init
2021-10-07 13:19:46.070730 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 13:19:46.084566 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 13:19:46.090586 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:46.093193 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-07 13:19:46.094500 (Thread-2): SQL status: DROP VIEW in 0.03 seconds
2021-10-07 13:19:46.102150 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:46.104976 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-07 13:19:46.096809 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 13:19:46.108705 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-07 13:19:46.122141 (Thread-1): Writing runtime SQL for node "model.my_new_project.firstnames"
2021-10-07 13:19:46.136051 (Thread-2): Writing runtime SQL for node "model.my_new_project.lostamounts"
2021-10-07 13:19:46.149679 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:46.154728 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:46.156917 (Thread-1): On model.my_new_project.firstnames: BEGIN
2021-10-07 13:19:46.161828 (Thread-2): On model.my_new_project.lostamounts: BEGIN
2021-10-07 13:19:46.170222 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 13:19:46.175122 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-07 13:19:46.183689 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:46.188794 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:46.204782 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */


  create  table "dellstore"."public"."firstnames__dbt_tmp"
  as (
    -- 1) TASK
-- Requirements:
-- create a table with following columns:
-- first name of the actor/actress
-- number of movies where such first name has been an actor
-- sum of the price of the movies where such first name has been an actor

-- Use dbt - models, sources, snapshotting
-- try inserting a new row into the products table + running the snapshot again

-- table


-- select
select first_name as id, count(distinct title) title_count, sum(price) price_sum from "dellstore"."public"."products" p
join (
	select distinct concat(split_part(actor, ' ', 1),'%') first_name from "dellstore"."public"."products"
) b
on p.actor like b.first_name
group by 1
order by 1


-- changes I tried with results in snapshot:

-- insert into products
-- values (0, 2, 'NO SUCH MOVIE', 'AAPO EESTLANE', 100.00, 0, 6633)
-- -- new row was added to snapshot

-- update products
-- set price = 1.22
-- where prod_id = 392
-- -- price_sum changed in snapshot

-- delete from products
-- where prod_id = 392
-- -- title_count (also price_sum) changed in snapshot
  );
2021-10-07 13:19:46.209285 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */

  create view "dellstore"."public"."lostamounts__dbt_tmp" as (
    select 
    o.orderdate,
    sum(o.totalamount) as Lost_Sum
from "dellstore"."public"."orders" o
join "dellstore"."public"."customers" c
on c.customerid=o.customerid
group by 1
  );

2021-10-07 13:19:46.254554 (Thread-2): SQL status: CREATE VIEW in 0.03 seconds
2021-10-07 13:19:46.280177 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:46.284084 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts" rename to "lostamounts__dbt_backup"
2021-10-07 13:19:46.293262 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 13:19:46.299729 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:46.303482 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
alter table "dellstore"."public"."lostamounts__dbt_tmp" rename to "lostamounts"
2021-10-07 13:19:46.309943 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 13:19:46.330476 (Thread-2): On model.my_new_project.lostamounts: COMMIT
2021-10-07 13:19:46.333957 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:46.336263 (Thread-2): On model.my_new_project.lostamounts: COMMIT
2021-10-07 13:19:46.343750 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:19:46.362234 (Thread-2): Using postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:46.367037 (Thread-2): On model.my_new_project.lostamounts: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.lostamounts"} */
drop view if exists "dellstore"."public"."lostamounts__dbt_backup" cascade
2021-10-07 13:19:46.381950 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-07 13:19:46.388635 (Thread-2): finished collecting timing info
2021-10-07 13:19:46.391361 (Thread-2): On model.my_new_project.lostamounts: Close
2021-10-07 13:19:46.394253 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902bcdb-d0fd-46ca-9828-49123c802bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28f98cbe0>]}
2021-10-07 13:19:46.398207 (Thread-2): 13:19:46 | 2 of 2 OK created view model public.lostamounts...................... [CREATE VIEW in 0.47s]
2021-10-07 13:19:46.403911 (Thread-2): Finished running node model.my_new_project.lostamounts
2021-10-07 13:19:46.498618 (Thread-1): SQL status: SELECT 201 in 0.29 seconds
2021-10-07 13:19:46.509503 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:46.512786 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames" rename to "firstnames__dbt_backup"
2021-10-07 13:19:46.520561 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 13:19:46.531671 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:46.534274 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
alter table "dellstore"."public"."firstnames__dbt_tmp" rename to "firstnames"
2021-10-07 13:19:46.538158 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 13:19:46.541776 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-07 13:19:46.544517 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:46.547641 (Thread-1): On model.my_new_project.firstnames: COMMIT
2021-10-07 13:19:46.553449 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:19:46.558968 (Thread-1): Using postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:46.561551 (Thread-1): On model.my_new_project.firstnames: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.firstnames"} */
drop table if exists "dellstore"."public"."firstnames__dbt_backup" cascade
2021-10-07 13:19:46.573498 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 13:19:46.580506 (Thread-1): finished collecting timing info
2021-10-07 13:19:46.583702 (Thread-1): On model.my_new_project.firstnames: Close
2021-10-07 13:19:46.589135 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902bcdb-d0fd-46ca-9828-49123c802bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb290265d60>]}
2021-10-07 13:19:46.593882 (Thread-1): 13:19:46 | 1 of 2 OK created table model public.firstnames...................... [SELECT 201 in 0.67s]
2021-10-07 13:19:46.596823 (Thread-1): Finished running node model.my_new_project.firstnames
2021-10-07 13:19:46.605334 (MainThread): Acquiring new postgres connection "master".
2021-10-07 13:19:46.609786 (MainThread): Using postgres connection "master".
2021-10-07 13:19:46.612068 (MainThread): On master: BEGIN
2021-10-07 13:19:46.615711 (MainThread): Opening a new connection, currently in state closed
2021-10-07 13:19:46.629039 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:19:46.632058 (MainThread): On master: COMMIT
2021-10-07 13:19:46.635194 (MainThread): Using postgres connection "master".
2021-10-07 13:19:46.637327 (MainThread): On master: COMMIT
2021-10-07 13:19:46.640526 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:19:46.642702 (MainThread): On master: Close
2021-10-07 13:19:46.645690 (MainThread): 13:19:46 | 
2021-10-07 13:19:46.648231 (MainThread): 13:19:46 | Finished running 1 view model, 1 table model in 0.96s.
2021-10-07 13:19:46.652198 (MainThread): Connection 'master' was properly closed.
2021-10-07 13:19:46.659460 (MainThread): Connection 'model.my_new_project.firstnames' was properly closed.
2021-10-07 13:19:46.661455 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:19:46.719708 (MainThread): 
2021-10-07 13:19:46.722858 (MainThread): Completed successfully
2021-10-07 13:19:46.725910 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-07 13:19:46.729341 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2902eb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2903281c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb290328f40>]}
2021-10-07 13:19:46.734948 (MainThread): Flushing usage events
2021-10-07 13:19:58.346854 (MainThread): Running with dbt=0.19.0
2021-10-07 13:19:58.579653 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:19:58.588477 (MainThread): Tracking: tracking
2021-10-07 13:19:58.592789 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70d2efbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70ed97c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70d300280>]}
2021-10-07 13:19:58.652460 (MainThread): Partial parsing not enabled
2021-10-07 13:19:58.664857 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:19:58.680205 (MainThread): Parsing macros/relations.sql
2021-10-07 13:19:58.692060 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:19:58.723265 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:19:58.735808 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:19:58.749501 (MainThread): Parsing macros/core.sql
2021-10-07 13:19:58.763893 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:19:58.812163 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:19:58.826062 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:19:58.839294 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:19:58.848189 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:19:58.868665 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:19:58.874076 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:19:58.910708 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:19:58.929444 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:19:58.955014 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:19:58.961129 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:19:58.971854 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:19:58.984145 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:19:58.989138 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:19:58.993391 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:19:59.006737 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:19:59.011207 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:19:59.015226 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:19:59.018936 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:19:59.023077 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:19:59.032210 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:19:59.039969 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:19:59.061304 (MainThread): Partial parsing not enabled
2021-10-07 13:19:59.115182 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:19:59.150072 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:19:59.184190 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:19:59.412078 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:19:59.431096 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d74642a-9041-46bf-9cad-13b347446fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70d20b7f0>]}
2021-10-07 13:19:59.481195 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:19:59.485876 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:19:59.489515 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:19:59.492249 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:19:59.502463 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:19:59.504999 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:19:59.507682 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:19:59.512052 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:19:59.517281 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:19:59.527168 (MainThread): 10005.0
2021-10-07 13:19:59.532426 (MainThread): On macro_Luhns: Close
2021-10-07 13:19:59.536954 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70d2efbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70d17eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70d1f1b20>]}
2021-10-07 13:19:59.542524 (MainThread): Flushing usage events
2021-10-07 13:20:00.094826 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:20:45.364904 (MainThread): Running with dbt=0.19.0
2021-10-07 13:20:45.931083 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:20:45.948156 (MainThread): Tracking: tracking
2021-10-07 13:20:45.957032 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843c400d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843dea7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843c411400>]}
2021-10-07 13:20:46.030052 (MainThread): Partial parsing not enabled
2021-10-07 13:20:46.045214 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:20:46.053108 (MainThread): Parsing macros/relations.sql
2021-10-07 13:20:46.062346 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:20:46.159371 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:20:46.170767 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:20:46.193399 (MainThread): Parsing macros/core.sql
2021-10-07 13:20:46.231825 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:20:46.470859 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:20:46.541947 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:20:46.585728 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:20:46.623549 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:20:46.716901 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:20:46.727222 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:20:46.894657 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:20:46.980064 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:20:47.055645 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:20:47.072457 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:20:47.110683 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:20:47.156956 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:20:47.165821 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:20:47.175648 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:20:47.226980 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:20:47.242674 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:20:47.253103 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:20:47.261574 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:20:47.278850 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:20:47.291789 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:20:47.302306 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:20:47.356090 (MainThread): Partial parsing not enabled
2021-10-07 13:20:47.552223 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:20:47.676725 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:20:47.788448 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:20:48.571406 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:20:48.602989 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df629c92-d9de-4e46-baaa-0a587c416794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843c31cac0>]}
2021-10-07 13:20:48.740783 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:20:48.745150 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:20:48.750350 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:20:48.755729 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:20:48.778753 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-07 13:20:48.785698 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:20:48.792697 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:20:48.798718 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:20:48.805866 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:20:48.826086 (MainThread): 0
2021-10-07 13:20:48.832329 (MainThread): On macro_Luhns: Close
2021-10-07 13:20:48.845780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843c400d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843c2cfb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843c2cf790>]}
2021-10-07 13:20:48.849908 (MainThread): Flushing usage events
2021-10-07 13:20:49.378348 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:21:38.312711 (MainThread): Running with dbt=0.19.0
2021-10-07 13:21:38.633750 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:21:38.646319 (MainThread): Tracking: tracking
2021-10-07 13:21:38.655032 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe7257cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe8cffd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe72693a0>]}
2021-10-07 13:21:38.703796 (MainThread): Partial parsing not enabled
2021-10-07 13:21:38.713484 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:21:38.719013 (MainThread): Parsing macros/relations.sql
2021-10-07 13:21:38.726848 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:21:38.759240 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:21:38.765866 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:21:38.772130 (MainThread): Parsing macros/core.sql
2021-10-07 13:21:38.780824 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:21:38.842757 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:21:38.858961 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:21:38.877126 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:21:38.889806 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:21:38.918460 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:21:38.924954 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:21:38.980027 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:21:39.006527 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:21:39.042335 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:21:39.049490 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:21:39.065322 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:21:39.079610 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:21:39.084094 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:21:39.095868 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:21:39.113985 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:21:39.119488 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:21:39.124754 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:21:39.129351 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:21:39.142030 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:21:39.158797 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:21:39.164429 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:21:39.183902 (MainThread): Partial parsing not enabled
2021-10-07 13:21:39.242904 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:21:39.282719 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:21:39.315170 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:21:39.604098 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:21:39.625755 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '206442f3-3b7f-4ddc-a080-406d442d3a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe713dd90>]}
2021-10-07 13:21:39.692644 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:21:39.696268 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:21:39.699890 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:21:39.703202 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:21:39.721207 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-07 13:21:39.726720 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:21:39.735433 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:21:39.739146 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:21:39.743036 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:21:39.760271 (MainThread): Error running SQL: macro Luhns
2021-10-07 13:21:39.769871 (MainThread): Rolling back transaction.
2021-10-07 13:21:39.774449 (MainThread): On macro_Luhns: Close
2021-10-07 13:21:39.777866 (MainThread): Encountered an error while running operation: Compilation Error in macro Luhns (macros/Luhns.sql)
  'length' is undefined
2021-10-07 13:21:39.787244 (MainThread): 
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'length' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 54, in run
    self._run_unsafe()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 41, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro Luhns (macros/Luhns.sql)
  'length' is undefined
2021-10-07 13:21:39.795883 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe7257cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe71242b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe7124c40>]}
2021-10-07 13:21:39.806600 (MainThread): Flushing usage events
2021-10-07 13:21:40.361181 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:32:33.566327 (MainThread): Running with dbt=0.19.0
2021-10-07 13:32:33.754226 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:32:33.764201 (MainThread): Tracking: tracking
2021-10-07 13:32:33.767836 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f803df6fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f803fa15f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f803df813d0>]}
2021-10-07 13:32:33.806428 (MainThread): Partial parsing not enabled
2021-10-07 13:32:33.819635 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:32:33.829382 (MainThread): Parsing macros/relations.sql
2021-10-07 13:32:33.839513 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:32:33.869522 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:32:33.874640 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:32:33.880168 (MainThread): Parsing macros/core.sql
2021-10-07 13:32:33.888103 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:32:33.934754 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:32:33.948256 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:32:33.957440 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:32:33.965202 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:32:33.985676 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:32:33.990328 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:32:34.024366 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:32:34.042561 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:32:34.066925 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:32:34.071937 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:32:34.082543 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:32:34.093260 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:32:34.097122 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:32:34.101489 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:32:34.112705 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:32:34.118364 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:32:34.122710 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:32:34.126477 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:32:34.130264 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:32:34.135932 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:32:34.140782 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:32:34.156071 (MainThread): Partial parsing not enabled
2021-10-07 13:32:34.201582 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:32:34.233716 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:32:34.259190 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:32:34.497165 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:32:34.506074 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11657729-51a6-4fbf-86e2-89cb96d42c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f803de1de20>]}
2021-10-07 13:32:34.548785 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:32:34.551258 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:32:34.553415 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:32:34.555671 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:32:34.564271 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:32:34.567733 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:32:34.573035 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:32:34.578052 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:32:34.581481 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:32:34.606272 (MainThread): Error running SQL: macro Luhns
2021-10-07 13:32:34.609142 (MainThread): Rolling back transaction.
2021-10-07 13:32:34.611383 (MainThread): On macro_Luhns: Close
2021-10-07 13:32:34.617477 (MainThread): Encountered an error while running operation: Compilation Error in macro Luhns (macros/Luhns.sql)
  'Undefined' object cannot be interpreted as an integer
2021-10-07 13:32:34.620116 (MainThread): 
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 54, in run
    self._run_unsafe()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 41, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro Luhns (macros/Luhns.sql)
  'Undefined' object cannot be interpreted as an integer
2021-10-07 13:32:34.625995 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f803df6fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f803de873d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f803de87190>]}
2021-10-07 13:32:34.631026 (MainThread): Flushing usage events
2021-10-07 13:32:35.233013 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:33:01.683446 (MainThread): Running with dbt=0.19.0
2021-10-07 13:33:01.920321 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:33:01.933985 (MainThread): Tracking: tracking
2021-10-07 13:33:01.940637 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de10b8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2b60dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de10c92b0>]}
2021-10-07 13:33:01.993112 (MainThread): Partial parsing not enabled
2021-10-07 13:33:02.001978 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:33:02.010128 (MainThread): Parsing macros/relations.sql
2021-10-07 13:33:02.014882 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:33:02.038819 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:33:02.043489 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:33:02.048858 (MainThread): Parsing macros/core.sql
2021-10-07 13:33:02.056422 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:33:02.102259 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:33:02.113459 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:33:02.121952 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:33:02.129212 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:33:02.151411 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:33:02.156179 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:33:02.188121 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:33:02.206497 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:33:02.240584 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:33:02.246903 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:33:02.259102 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:33:02.268503 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:33:02.272414 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:33:02.278490 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:33:02.292432 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:33:02.302673 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:33:02.306216 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:33:02.309515 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:33:02.315210 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:33:02.320744 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:33:02.325304 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:33:02.342244 (MainThread): Partial parsing not enabled
2021-10-07 13:33:02.391221 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:33:02.421994 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:33:02.459870 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:33:02.667186 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:33:02.677224 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba4854c7-63fb-4fa4-a46c-1c2000670ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de0fcc760>]}
2021-10-07 13:33:02.715705 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:33:02.718146 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:33:02.720231 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:33:02.722109 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:33:02.732258 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:33:02.735755 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:33:02.739008 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:33:02.742296 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:33:02.746891 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:33:02.760842 (MainThread): On macro_Luhns: Close
2021-10-07 13:33:02.763952 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de10b8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de0ee3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de0ee40a0>]}
2021-10-07 13:33:02.766802 (MainThread): Flushing usage events
2021-10-07 13:33:03.301650 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:33:46.090806 (MainThread): Running with dbt=0.19.0
2021-10-07 13:33:46.319936 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:33:46.332823 (MainThread): Tracking: tracking
2021-10-07 13:33:46.338984 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1167316bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168dbee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1167328370>]}
2021-10-07 13:33:46.402400 (MainThread): Partial parsing not enabled
2021-10-07 13:33:46.417699 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:33:46.424345 (MainThread): Parsing macros/relations.sql
2021-10-07 13:33:46.429302 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:33:46.453558 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:33:46.458409 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:33:46.463865 (MainThread): Parsing macros/core.sql
2021-10-07 13:33:46.471472 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:33:46.517631 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:33:46.538406 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:33:46.549340 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:33:46.563369 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:33:46.586440 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:33:46.594309 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:33:46.634100 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:33:46.662263 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:33:46.699192 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:33:46.710285 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:33:46.720736 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:33:46.729288 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:33:46.732332 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:33:46.736540 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:33:46.749630 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:33:46.755272 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:33:46.759749 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:33:46.762795 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:33:46.770908 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:33:46.777116 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:33:46.782412 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:33:46.799072 (MainThread): Partial parsing not enabled
2021-10-07 13:33:46.838302 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:33:46.868353 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:33:46.893959 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:33:47.130339 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:33:47.141309 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7b42a47-a125-41cd-be87-7bf1b2d154af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116721d8e0>]}
2021-10-07 13:33:47.201892 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:33:47.216358 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:33:47.221439 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:33:47.224026 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:33:47.236007 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:33:47.240294 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:33:47.244105 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:33:47.249372 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:33:47.253998 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:33:47.270322 (MainThread): On macro_Luhns: Close
2021-10-07 13:33:47.274037 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1167316bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11671d1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11671d1af0>]}
2021-10-07 13:33:47.277428 (MainThread): Flushing usage events
2021-10-07 13:33:47.962009 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:38:41.212463 (MainThread): Running with dbt=0.19.0
2021-10-07 13:38:41.413703 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 13:38:41.426606 (MainThread): Tracking: tracking
2021-10-07 13:38:41.433205 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9077555970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079000280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9077566160>]}
2021-10-07 13:38:41.507223 (MainThread): Partial parsing not enabled
2021-10-07 13:38:41.522738 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:38:41.530444 (MainThread): Parsing macros/relations.sql
2021-10-07 13:38:41.534696 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:38:41.559309 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:38:41.567364 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:38:41.576886 (MainThread): Parsing macros/core.sql
2021-10-07 13:38:41.590326 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:38:41.639405 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:38:41.650351 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:38:41.659324 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:38:41.666751 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:38:41.688963 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:38:41.693550 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:38:41.727445 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:38:41.749776 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:38:41.773655 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:38:41.778405 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:38:41.788679 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:38:41.799619 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:38:41.802854 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:38:41.812419 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:38:41.823929 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:38:41.828365 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:38:41.832403 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:38:41.835546 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:38:41.839511 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:38:41.848282 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:38:41.855201 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:38:41.872753 (MainThread): Partial parsing not enabled
2021-10-07 13:38:41.917895 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:38:41.950903 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:38:41.962879 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90774d61f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9077379e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90773747c0>]}
2021-10-07 13:38:41.965295 (MainThread): Flushing usage events
2021-10-07 13:38:42.577093 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:38:42.583943 (MainThread): Encountered an error:
2021-10-07 13:38:42.590884 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:38:42.613774 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 13:39:24.251799 (MainThread): Running with dbt=0.19.0
2021-10-07 13:39:24.461622 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 13:39:24.480947 (MainThread): Tracking: tracking
2021-10-07 13:39:24.491023 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be81da9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be9c85310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be81eb1c0>]}
2021-10-07 13:39:24.564467 (MainThread): Partial parsing not enabled
2021-10-07 13:39:24.573575 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:39:24.580755 (MainThread): Parsing macros/relations.sql
2021-10-07 13:39:24.585064 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:39:24.607636 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:39:24.612577 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:39:24.617874 (MainThread): Parsing macros/core.sql
2021-10-07 13:39:24.624555 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:39:24.683491 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:39:24.702797 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:39:24.720155 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:39:24.728772 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:39:24.749969 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:39:24.754730 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:39:24.791048 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:39:24.813267 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:39:24.836248 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:39:24.841455 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:39:24.850882 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:39:24.860085 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:39:24.863567 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:39:24.867499 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:39:24.878677 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:39:24.883658 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:39:24.887725 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:39:24.891031 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:39:24.895624 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:39:24.900633 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:39:24.904950 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:39:24.922901 (MainThread): Partial parsing not enabled
2021-10-07 13:39:24.976973 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:39:25.023443 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:39:25.045976 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be818c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be7ffeeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be7ffa940>]}
2021-10-07 13:39:25.049593 (MainThread): Flushing usage events
2021-10-07 13:39:25.625254 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:39:25.633061 (MainThread): Encountered an error:
2021-10-07 13:39:25.639970 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:39:25.655819 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 13:42:53.788700 (MainThread): Running with dbt=0.19.0
2021-10-07 13:42:54.033919 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:42:54.052894 (MainThread): Tracking: tracking
2021-10-07 13:42:54.057206 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf305bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf4b02e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf306c370>]}
2021-10-07 13:42:54.153078 (MainThread): Partial parsing not enabled
2021-10-07 13:42:54.168798 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:42:54.174577 (MainThread): Parsing macros/relations.sql
2021-10-07 13:42:54.182070 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:42:54.229803 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:42:54.235865 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:42:54.244892 (MainThread): Parsing macros/core.sql
2021-10-07 13:42:54.257027 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:42:54.312539 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:42:54.328802 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:42:54.340161 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:42:54.348892 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:42:54.371209 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:42:54.376100 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:42:54.412738 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:42:54.447680 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:42:54.474235 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:42:54.482998 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:42:54.502218 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:42:54.522886 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:42:54.526891 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:42:54.531418 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:42:54.544696 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:42:54.549792 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:42:54.553632 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:42:54.557157 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:42:54.561561 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:42:54.566680 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:42:54.571359 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:42:54.590450 (MainThread): Partial parsing not enabled
2021-10-07 13:42:54.635449 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:42:54.664691 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:42:54.673374 (MainThread): 0
2021-10-07 13:42:54.707598 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:42:54.919620 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:42:54.934002 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '896dda75-39b8-47af-8caf-e7fe7757daa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf2f76100>]}
2021-10-07 13:42:54.990470 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:42:54.995919 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:42:55.000353 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:42:55.004060 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:42:55.018168 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:42:55.021420 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:42:55.025111 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:42:55.027872 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:42:55.032435 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:42:55.038313 (MainThread): 0
2021-10-07 13:42:55.041136 (MainThread): On macro_Luhns: Close
2021-10-07 13:42:55.046008 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf305bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf2fb1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf2ec5220>]}
2021-10-07 13:42:55.050776 (MainThread): Flushing usage events
2021-10-07 13:42:55.602136 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:43:33.201510 (MainThread): Running with dbt=0.19.0
2021-10-07 13:43:33.467728 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:43:33.479184 (MainThread): Tracking: tracking
2021-10-07 13:43:33.486486 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc95f41ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc979e8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc95f52370>]}
2021-10-07 13:43:33.549758 (MainThread): Partial parsing not enabled
2021-10-07 13:43:33.562605 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:43:33.567287 (MainThread): Parsing macros/relations.sql
2021-10-07 13:43:33.572060 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:43:33.595205 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:43:33.601515 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:43:33.607140 (MainThread): Parsing macros/core.sql
2021-10-07 13:43:33.613756 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:43:33.659330 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:43:33.673120 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:43:33.688122 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:43:33.697400 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:43:33.723683 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:43:33.728613 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:43:33.762810 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:43:33.782857 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:43:33.808316 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:43:33.813041 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:43:33.825064 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:43:33.840233 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:43:33.844529 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:43:33.848589 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:43:33.865332 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:43:33.870610 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:43:33.875532 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:43:33.879193 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:43:33.883658 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:43:33.889782 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:43:33.893875 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:43:33.910237 (MainThread): Partial parsing not enabled
2021-10-07 13:43:33.958812 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:43:33.998644 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:43:34.026134 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:43:34.307242 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:43:34.331611 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d4e93d4-14da-4ac1-b5ca-25bf737f2f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc95deffd0>]}
2021-10-07 13:43:34.427015 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:43:34.430650 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:43:34.433198 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:43:34.435739 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:43:34.449124 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:43:34.454988 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:43:34.458790 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:43:34.464186 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:43:34.469094 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:43:34.475197 (MainThread): On macro_Luhns: Close
2021-10-07 13:43:34.480990 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc95f41ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc95e865e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc95e86c10>]}
2021-10-07 13:43:34.485172 (MainThread): Flushing usage events
2021-10-07 13:43:35.011582 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:44:02.059130 (MainThread): Running with dbt=0.19.0
2021-10-07 13:44:02.347802 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:44:02.360742 (MainThread): Tracking: tracking
2021-10-07 13:44:02.366390 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182ee9dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1830944f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182eeaf3d0>]}
2021-10-07 13:44:02.400173 (MainThread): Partial parsing not enabled
2021-10-07 13:44:02.411527 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:44:02.419232 (MainThread): Parsing macros/relations.sql
2021-10-07 13:44:02.425368 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:44:02.449555 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:44:02.458271 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:44:02.465047 (MainThread): Parsing macros/core.sql
2021-10-07 13:44:02.474510 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:44:02.523585 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:44:02.537812 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:44:02.554723 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:44:02.563509 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:44:02.586222 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:44:02.591612 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:44:02.632567 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:44:02.650897 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:44:02.681705 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:44:02.686259 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:44:02.696649 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:44:02.708283 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:44:02.712565 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:44:02.718909 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:44:02.732853 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:44:02.738041 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:44:02.742257 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:44:02.745700 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:44:02.750259 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:44:02.756203 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:44:02.761206 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:44:02.778129 (MainThread): Partial parsing not enabled
2021-10-07 13:44:02.830429 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:44:02.862203 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:44:02.889202 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:44:03.101396 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:44:03.120479 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3267df10-c735-4865-a66c-fcff4f2316fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182ed8e160>]}
2021-10-07 13:44:03.185209 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:44:03.189072 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:44:03.191487 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:44:03.193649 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:44:03.203316 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:44:03.207413 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:44:03.212902 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:44:03.215937 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:44:03.219526 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:44:03.224545 (MainThread): On macro_Luhns: Close
2021-10-07 13:44:03.227819 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182ee9dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182ed2f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182ed2f250>]}
2021-10-07 13:44:03.230684 (MainThread): Flushing usage events
2021-10-07 13:44:03.739523 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:45:05.254941 (MainThread): Running with dbt=0.19.0
2021-10-07 13:45:05.509222 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:45:05.527510 (MainThread): Tracking: tracking
2021-10-07 13:45:05.534726 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f884d71dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f884f1c4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f884d72f3d0>]}
2021-10-07 13:45:05.599600 (MainThread): Partial parsing not enabled
2021-10-07 13:45:05.609786 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:45:05.615557 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f884d70b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f884d6bc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f884d6bc7c0>]}
2021-10-07 13:45:05.618188 (MainThread): Flushing usage events
2021-10-07 13:45:06.147572 (MainThread): Encountered an error:
2021-10-07 13:45:06.155589 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token 'end of print statement', got '='
    line 4
      {{s=5}}
2021-10-07 13:45:06.167762 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 4, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of print statement', got '='
  line 4
    {{s=5}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token 'end of print statement', got '='
    line 4
      {{s=5}}

2021-10-07 13:45:39.838366 (MainThread): Running with dbt=0.19.0
2021-10-07 13:45:40.098242 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:45:40.111459 (MainThread): Tracking: tracking
2021-10-07 13:45:40.115711 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e6f57bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e71022d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e6f58c430>]}
2021-10-07 13:45:40.168987 (MainThread): Partial parsing not enabled
2021-10-07 13:45:40.180420 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:45:40.186397 (MainThread): Parsing macros/relations.sql
2021-10-07 13:45:40.191649 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:45:40.217489 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:45:40.223123 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:45:40.228230 (MainThread): Parsing macros/core.sql
2021-10-07 13:45:40.236245 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:45:40.282275 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:45:40.296686 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:45:40.305707 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:45:40.314928 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:45:40.339097 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:45:40.346212 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:45:40.383129 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:45:40.405278 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:45:40.434894 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:45:40.439046 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:45:40.447295 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:45:40.456759 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:45:40.460854 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:45:40.465535 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:45:40.476763 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:45:40.482196 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:45:40.487191 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:45:40.490727 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:45:40.495033 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:45:40.500513 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:45:40.505029 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:45:40.523534 (MainThread): Partial parsing not enabled
2021-10-07 13:45:40.567014 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:45:40.595926 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:45:40.604536 (MainThread): 0
2021-10-07 13:45:40.635119 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:45:40.846311 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:45:40.862987 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e665a39-12cf-4a8c-a21f-02e30fbb7466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e6f432d00>]}
2021-10-07 13:45:40.908114 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:45:40.910488 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:45:40.913560 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:45:40.916996 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:45:40.930420 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:45:40.933991 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:45:40.937807 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:45:40.940428 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:45:40.943792 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:45:40.947763 (MainThread): 0
2021-10-07 13:45:40.950564 (MainThread): On macro_Luhns: Close
2021-10-07 13:45:40.957259 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e6f57bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e6f494e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e6f4846a0>]}
2021-10-07 13:45:40.959964 (MainThread): Flushing usage events
2021-10-07 13:45:41.472447 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:46:05.044719 (MainThread): Running with dbt=0.19.0
2021-10-07 13:46:05.310737 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:46:05.327915 (MainThread): Tracking: tracking
2021-10-07 13:46:05.332895 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83247d7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f832627ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83247e8370>]}
2021-10-07 13:46:05.384454 (MainThread): Partial parsing not enabled
2021-10-07 13:46:05.398736 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:46:05.406357 (MainThread): Parsing macros/relations.sql
2021-10-07 13:46:05.412987 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:46:05.448876 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:46:05.454413 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:46:05.460290 (MainThread): Parsing macros/core.sql
2021-10-07 13:46:05.475231 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:46:05.522549 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:46:05.534154 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:46:05.544961 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:46:05.553129 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:46:05.575683 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:46:05.579766 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:46:05.611647 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:46:05.630666 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:46:05.653655 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:46:05.658539 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:46:05.671124 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:46:05.685803 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:46:05.690907 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:46:05.695803 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:46:05.707044 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:46:05.712384 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:46:05.718820 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:46:05.723762 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:46:05.729823 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:46:05.735835 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:46:05.740162 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:46:05.755572 (MainThread): Partial parsing not enabled
2021-10-07 13:46:05.795137 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:46:05.826180 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:46:05.836361 (MainThread): 5
2021-10-07 13:46:05.866131 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:46:06.095757 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:46:06.110024 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2319b974-2279-4234-b6fc-7385bdba9d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83246267c0>]}
2021-10-07 13:46:06.169866 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:46:06.173330 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:46:06.179146 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:46:06.182678 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:46:06.208704 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-10-07 13:46:06.213076 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:46:06.216014 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:46:06.219889 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:46:06.223223 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:46:06.227700 (MainThread): 5
2021-10-07 13:46:06.230371 (MainThread): On macro_Luhns: Close
2021-10-07 13:46:06.235104 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83247d7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8324642a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83245fbd00>]}
2021-10-07 13:46:06.241031 (MainThread): Flushing usage events
2021-10-07 13:46:06.766351 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:46:55.866800 (MainThread): Running with dbt=0.19.0
2021-10-07 13:46:56.084491 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:46:56.097559 (MainThread): Tracking: tracking
2021-10-07 13:46:56.104326 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b67eeac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b69991ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b67efb310>]}
2021-10-07 13:46:56.156561 (MainThread): Partial parsing not enabled
2021-10-07 13:46:56.166290 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:46:56.170593 (MainThread): Parsing macros/relations.sql
2021-10-07 13:46:56.178796 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:46:56.207696 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:46:56.217888 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:46:56.227971 (MainThread): Parsing macros/core.sql
2021-10-07 13:46:56.240490 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:46:56.283324 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:46:56.301517 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:46:56.316272 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:46:56.324251 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:46:56.343684 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:46:56.347990 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:46:56.379596 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:46:56.395364 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:46:56.418383 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:46:56.422525 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:46:56.430369 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:46:56.439462 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:46:56.443075 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:46:56.447250 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:46:56.459172 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:46:56.465940 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:46:56.471815 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:46:56.475042 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:46:56.479347 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:46:56.487277 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:46:56.492855 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:46:56.507299 (MainThread): Partial parsing not enabled
2021-10-07 13:46:56.552312 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:46:56.580739 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:46:56.588883 (MainThread): 5
2021-10-07 13:46:56.612127 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:46:56.818489 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:46:56.830433 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3461cd79-261c-4b5f-9e79-ecb6f4d55c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b67dc8730>]}
2021-10-07 13:46:56.888135 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:46:56.891372 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:46:56.894382 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:46:56.897250 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:46:56.906612 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 13:46:56.910142 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:46:56.915304 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:46:56.918003 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:46:56.920880 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:46:56.925509 (MainThread): 5
2021-10-07 13:46:56.928973 (MainThread): On macro_Luhns: Close
2021-10-07 13:46:56.933683 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b67eeac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b67d9fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b67d9f940>]}
2021-10-07 13:46:56.940455 (MainThread): Flushing usage events
2021-10-07 13:46:57.501454 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:47:07.518284 (MainThread): Running with dbt=0.19.0
2021-10-07 13:47:07.708852 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:47:07.717882 (MainThread): Tracking: tracking
2021-10-07 13:47:07.721050 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd939923c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd93b3cbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd939935370>]}
2021-10-07 13:47:07.754383 (MainThread): Partial parsing not enabled
2021-10-07 13:47:07.761077 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:47:07.765993 (MainThread): Parsing macros/relations.sql
2021-10-07 13:47:07.771786 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:47:07.809325 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:47:07.817810 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:47:07.826595 (MainThread): Parsing macros/core.sql
2021-10-07 13:47:07.832984 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:47:07.875743 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:47:07.888463 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:47:07.897577 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:47:07.904872 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:47:07.924995 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:47:07.929000 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:47:07.963472 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:47:07.979932 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:47:08.001808 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:47:08.006070 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:47:08.014929 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:47:08.024775 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:47:08.028317 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:47:08.032719 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:47:08.044115 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:47:08.048328 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:47:08.052286 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:47:08.055464 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:47:08.059255 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:47:08.064104 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:47:08.068351 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:47:08.082664 (MainThread): Partial parsing not enabled
2021-10-07 13:47:08.124149 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:47:08.152999 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:47:08.162118 (MainThread): 7
2021-10-07 13:47:08.187384 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 13:47:08.396615 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 13:47:08.417315 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fa87e6f-3f5f-4a72-b398-080196f3a0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd939836d30>]}
2021-10-07 13:47:08.477307 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 13:47:08.485412 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:47:08.489364 (MainThread): On macro_Luhns: BEGIN
2021-10-07 13:47:08.493686 (MainThread): Opening a new connection, currently in state init
2021-10-07 13:47:08.509075 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-07 13:47:08.513852 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:47:08.517819 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 13:47:08.521618 (MainThread): On macro_Luhns: COMMIT
2021-10-07 13:47:08.526397 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 13:47:08.532400 (MainThread): 7
2021-10-07 13:47:08.535835 (MainThread): On macro_Luhns: Close
2021-10-07 13:47:08.544075 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd939923c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd93987d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd939986d00>]}
2021-10-07 13:47:08.552092 (MainThread): Flushing usage events
2021-10-07 13:47:09.111910 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 13:47:19.442810 (MainThread): Running with dbt=0.19.0
2021-10-07 13:47:19.677315 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:47:19.688890 (MainThread): Tracking: tracking
2021-10-07 13:47:19.694081 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c6be06cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c6d8add00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c6be17460>]}
2021-10-07 13:47:19.738324 (MainThread): Partial parsing not enabled
2021-10-07 13:47:19.751845 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:47:19.760771 (MainThread): Parsing macros/relations.sql
2021-10-07 13:47:19.769071 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:47:19.799915 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:47:19.806946 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:47:19.817092 (MainThread): Parsing macros/core.sql
2021-10-07 13:47:19.824440 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:47:19.873699 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:47:19.893396 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:47:19.911626 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:47:19.924905 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:47:19.949723 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:47:19.953857 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:47:19.986956 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:47:20.010537 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:47:20.035649 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:47:20.039505 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:47:20.048606 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:47:20.057131 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:47:20.060606 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:47:20.065032 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:47:20.077025 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:47:20.081981 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:47:20.085762 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:47:20.089096 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:47:20.093089 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:47:20.098942 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:47:20.103530 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:47:20.124897 (MainThread): Partial parsing not enabled
2021-10-07 13:47:20.170948 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:47:20.215793 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:47:20.235815 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c6bd6da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c6bc30ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c6bc2c9a0>]}
2021-10-07 13:47:20.240974 (MainThread): Flushing usage events
2021-10-07 13:47:20.771313 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:47:20.778002 (MainThread): Encountered an error:
2021-10-07 13:47:20.782999 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'credcard' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:47:20.799774 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'credcard' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'credcard' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 13:49:08.030694 (MainThread): Running with dbt=0.19.0
2021-10-07 13:49:08.339662 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:49:08.352691 (MainThread): Tracking: tracking
2021-10-07 13:49:08.356613 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dcc40c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5de6e7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dcc523a0>]}
2021-10-07 13:49:08.393189 (MainThread): Partial parsing not enabled
2021-10-07 13:49:08.408207 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:49:08.415318 (MainThread): Parsing macros/relations.sql
2021-10-07 13:49:08.426567 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:49:08.460326 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:49:08.465727 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:49:08.471887 (MainThread): Parsing macros/core.sql
2021-10-07 13:49:08.479579 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:49:08.538560 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:49:08.553910 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:49:08.571677 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:49:08.586630 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:49:08.611590 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:49:08.617392 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:49:08.659369 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:49:08.678243 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:49:08.706880 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:49:08.711616 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:49:08.724179 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:49:08.734219 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:49:08.737863 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:49:08.742230 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:49:08.755256 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:49:08.760103 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:49:08.765072 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:49:08.768868 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:49:08.773235 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:49:08.788574 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:49:08.800098 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:49:08.829309 (MainThread): Partial parsing not enabled
2021-10-07 13:49:08.910945 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:49:08.975373 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:49:08.995138 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dcba70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dca69e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dca64760>]}
2021-10-07 13:49:09.000568 (MainThread): Flushing usage events
2021-10-07 13:49:09.769747 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:49:09.776298 (MainThread): Encountered an error:
2021-10-07 13:49:09.780144 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'credcard' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:49:09.807516 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'credcard' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'credcard' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 13:49:31.223574 (MainThread): Running with dbt=0.19.0
2021-10-07 13:49:31.643577 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:49:31.653690 (MainThread): Tracking: tracking
2021-10-07 13:49:31.656821 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dcacaad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dcc750fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dcacbc430>]}
2021-10-07 13:49:31.690156 (MainThread): Partial parsing not enabled
2021-10-07 13:49:31.695894 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:49:31.701182 (MainThread): Parsing macros/relations.sql
2021-10-07 13:49:31.707063 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:49:31.737266 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:49:31.743074 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:49:31.748327 (MainThread): Parsing macros/core.sql
2021-10-07 13:49:31.756297 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:49:31.810628 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:49:31.825681 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:49:31.835931 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:49:31.844838 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:49:31.875335 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:49:31.880085 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:49:31.923029 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:49:31.942990 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:49:31.974614 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:49:31.979804 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:49:31.991321 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:49:32.001552 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:49:32.005294 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:49:32.009673 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:49:32.021322 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:49:32.025828 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:49:32.030218 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:49:32.034685 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:49:32.038575 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:49:32.043679 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:49:32.047965 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:49:32.063392 (MainThread): Partial parsing not enabled
2021-10-07 13:49:32.109229 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:49:32.147951 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:49:32.158342 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dcac841f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dcaad3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dcaacf640>]}
2021-10-07 13:49:32.162228 (MainThread): Flushing usage events
2021-10-07 13:49:32.720962 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:49:32.728897 (MainThread): Encountered an error:
2021-10-07 13:49:32.733897 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  not all arguments converted during string formatting
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:49:32.750306 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
TypeError: not all arguments converted during string formatting

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  not all arguments converted during string formatting
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 13:50:04.628882 (MainThread): Running with dbt=0.19.0
2021-10-07 13:50:04.838223 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:50:04.850829 (MainThread): Tracking: tracking
2021-10-07 13:50:04.853972 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff378a28dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37a4ced00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff378a39460>]}
2021-10-07 13:50:04.883038 (MainThread): Partial parsing not enabled
2021-10-07 13:50:04.889993 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:50:04.899535 (MainThread): Parsing macros/relations.sql
2021-10-07 13:50:04.907375 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:50:04.942266 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:50:04.954350 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:50:04.968006 (MainThread): Parsing macros/core.sql
2021-10-07 13:50:04.975032 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:50:05.019580 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:50:05.031233 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:50:05.041134 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:50:05.048854 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:50:05.068653 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:50:05.073063 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:50:05.108295 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:50:05.126739 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:50:05.151163 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:50:05.155703 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:50:05.164239 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:50:05.173164 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:50:05.176474 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:50:05.180807 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:50:05.192360 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:50:05.201239 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:50:05.206748 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:50:05.209491 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:50:05.213465 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:50:05.218541 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:50:05.222380 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:50:05.243318 (MainThread): Partial parsing not enabled
2021-10-07 13:50:05.291299 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:50:05.335498 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:50:05.348809 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37898ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff378850ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37884c820>]}
2021-10-07 13:50:05.351427 (MainThread): Flushing usage events
2021-10-07 13:50:06.391567 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:50:06.398353 (MainThread): Encountered an error:
2021-10-07 13:50:06.402900 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'credcard' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:50:06.421801 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'credcard' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'credcard' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 13:50:57.424101 (MainThread): Running with dbt=0.19.0
2021-10-07 13:50:57.636212 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 13:50:57.648028 (MainThread): Tracking: tracking
2021-10-07 13:50:57.651757 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d2df4fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d2f9f6d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d2df60430>]}
2021-10-07 13:50:57.680652 (MainThread): Partial parsing not enabled
2021-10-07 13:50:57.688339 (MainThread): Parsing macros/Luhns.sql
2021-10-07 13:50:57.693920 (MainThread): Parsing macros/relations.sql
2021-10-07 13:50:57.698609 (MainThread): Parsing macros/adapters.sql
2021-10-07 13:50:57.722283 (MainThread): Parsing macros/catalog.sql
2021-10-07 13:50:57.727014 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 13:50:57.731931 (MainThread): Parsing macros/core.sql
2021-10-07 13:50:57.742573 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 13:50:57.804836 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 13:50:57.820241 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 13:50:57.841365 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 13:50:57.855155 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 13:50:57.881457 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 13:50:57.886002 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 13:50:57.917318 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 13:50:57.933078 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 13:50:57.955994 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 13:50:57.960232 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 13:50:57.968712 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 13:50:57.978166 (MainThread): Parsing macros/etc/query.sql
2021-10-07 13:50:57.981563 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 13:50:57.985457 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 13:50:57.996426 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 13:50:58.000397 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 13:50:58.008777 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 13:50:58.014020 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 13:50:58.017618 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 13:50:58.022544 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 13:50:58.026439 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 13:50:58.041203 (MainThread): Partial parsing not enabled
2021-10-07 13:50:58.080631 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 13:50:58.108428 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 13:50:58.117469 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d2df2a1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d2dd78eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d2dd747f0>]}
2021-10-07 13:50:58.121530 (MainThread): Flushing usage events
2021-10-07 13:50:58.678702 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 13:50:58.686396 (MainThread): Encountered an error:
2021-10-07 13:50:58.694741 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 13:50:58.710790 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'n' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 14:00:51.052836 (MainThread): Running with dbt=0.19.0
2021-10-07 14:00:51.267232 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:00:51.281774 (MainThread): Tracking: tracking
2021-10-07 14:00:51.287805 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a0bdec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a2685d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a0bef430>]}
2021-10-07 14:00:51.327840 (MainThread): Partial parsing not enabled
2021-10-07 14:00:51.335279 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:00:51.341252 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a0bfb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a0b7c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a0b7c820>]}
2021-10-07 14:00:51.344128 (MainThread): Flushing usage events
2021-10-07 14:00:51.909407 (MainThread): Encountered an error:
2021-10-07 14:00:51.916043 (MainThread): Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set s = {{n}} %}
2021-10-07 14:00:51.933319 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 2, in template
jinja2.exceptions.TemplateSyntaxError: expected token ':', got '}'
  line 2
    {% set s = {{n}} %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/Luhns.sql)
  expected token ':', got '}'
    line 2
      {% set s = {{n}} %}

2021-10-07 14:03:46.877311 (MainThread): Running with dbt=0.19.0
2021-10-07 14:03:47.086648 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:03:47.097476 (MainThread): Tracking: tracking
2021-10-07 14:03:47.102649 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3965c74d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396771bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3965c854c0>]}
2021-10-07 14:03:47.170319 (MainThread): Partial parsing not enabled
2021-10-07 14:03:47.178982 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:03:47.183498 (MainThread): Parsing macros/relations.sql
2021-10-07 14:03:47.187691 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:03:47.209835 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:03:47.214401 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:03:47.219186 (MainThread): Parsing macros/core.sql
2021-10-07 14:03:47.225508 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:03:47.268227 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:03:47.283188 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:03:47.293592 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:03:47.301415 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:03:47.321420 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:03:47.326068 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:03:47.358269 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:03:47.374715 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:03:47.398394 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:03:47.402637 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:03:47.412142 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:03:47.421861 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:03:47.427971 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:03:47.433879 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:03:47.445623 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:03:47.450235 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:03:47.454267 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:03:47.457600 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:03:47.461437 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:03:47.466664 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:03:47.471064 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:03:47.484888 (MainThread): Partial parsing not enabled
2021-10-07 14:03:47.525711 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:03:47.557596 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:03:47.571072 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3965c39a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3965aadf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3965a956a0>]}
2021-10-07 14:03:47.573723 (MainThread): Flushing usage events
2021-10-07 14:03:48.124437 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 14:03:48.132789 (MainThread): Encountered an error:
2021-10-07 14:03:48.139344 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 14:03:48.179302 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'n' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 14:04:14.756249 (MainThread): Running with dbt=0.19.0
2021-10-07 14:04:14.970268 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:04:14.984067 (MainThread): Tracking: tracking
2021-10-07 14:04:14.989455 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a39a2b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a544adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a39b22e0>]}
2021-10-07 14:04:15.060826 (MainThread): Partial parsing not enabled
2021-10-07 14:04:15.073626 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:04:15.081075 (MainThread): Parsing macros/relations.sql
2021-10-07 14:04:15.088741 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:04:15.118029 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:04:15.130688 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:04:15.143844 (MainThread): Parsing macros/core.sql
2021-10-07 14:04:15.158984 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:04:15.207691 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:04:15.220353 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:04:15.229369 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:04:15.242947 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:04:15.271650 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:04:15.278487 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:04:15.313842 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:04:15.330364 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:04:15.353276 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:04:15.357558 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:04:15.366233 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:04:15.375267 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:04:15.379212 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:04:15.385326 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:04:15.399675 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:04:15.404171 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:04:15.408436 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:04:15.412018 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:04:15.415978 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:04:15.425770 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:04:15.430216 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:04:15.443563 (MainThread): Partial parsing not enabled
2021-10-07 14:04:15.481743 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:04:15.510438 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:04:15.520411 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a395dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a37dad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a37c46a0>]}
2021-10-07 14:04:15.522742 (MainThread): Flushing usage events
2021-10-07 14:04:16.035764 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 14:04:16.041901 (MainThread): Encountered an error:
2021-10-07 14:04:16.048285 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 14:04:16.064110 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'n' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 14:04:35.497411 (MainThread): Running with dbt=0.19.0
2021-10-07 14:04:35.756590 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:04:35.768996 (MainThread): Tracking: tracking
2021-10-07 14:04:35.779001 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b01192cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b02c39dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b011a3400>]}
2021-10-07 14:04:35.840425 (MainThread): Partial parsing not enabled
2021-10-07 14:04:35.853650 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:04:35.858920 (MainThread): Parsing macros/relations.sql
2021-10-07 14:04:35.865329 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:04:35.896992 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:04:35.901948 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:04:35.907462 (MainThread): Parsing macros/core.sql
2021-10-07 14:04:35.915352 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:04:35.966019 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:04:35.981771 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:04:35.993947 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:04:36.001233 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:04:36.025750 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:04:36.030492 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:04:36.066934 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:04:36.082970 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:04:36.105705 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:04:36.110361 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:04:36.119258 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:04:36.127904 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:04:36.131445 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:04:36.135255 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:04:36.146210 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:04:36.150517 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:04:36.154178 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:04:36.157483 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:04:36.161622 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:04:36.167654 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:04:36.171739 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:04:36.186627 (MainThread): Partial parsing not enabled
2021-10-07 14:04:36.225361 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:04:36.253820 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:04:36.265580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b010f4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b00fcbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b00fb47c0>]}
2021-10-07 14:04:36.267941 (MainThread): Flushing usage events
2021-10-07 14:04:36.825317 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 14:04:36.833391 (MainThread): Encountered an error:
2021-10-07 14:04:36.841627 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 14:04:36.862680 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'n' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 14:05:25.570398 (MainThread): Running with dbt=0.19.0
2021-10-07 14:05:25.781573 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:05:25.796348 (MainThread): Tracking: tracking
2021-10-07 14:05:25.802701 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2914e9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd292f91d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2914fb280>]}
2021-10-07 14:05:25.849645 (MainThread): Partial parsing not enabled
2021-10-07 14:05:25.861697 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:05:25.870182 (MainThread): Parsing macros/relations.sql
2021-10-07 14:05:25.875884 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:05:25.915857 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:05:25.921026 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:05:25.926058 (MainThread): Parsing macros/core.sql
2021-10-07 14:05:25.934659 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:05:25.978118 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:05:25.990931 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:05:25.999140 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:05:26.006534 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:05:26.026951 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:05:26.031075 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:05:26.062533 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:05:26.088127 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:05:26.112113 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:05:26.116484 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:05:26.124774 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:05:26.133352 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:05:26.137150 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:05:26.144070 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:05:26.163169 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:05:26.168006 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:05:26.171947 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:05:26.175430 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:05:26.180826 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:05:26.188678 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:05:26.196360 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:05:26.221733 (MainThread): Partial parsing not enabled
2021-10-07 14:05:26.275920 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:05:26.316952 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:05:26.327093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2914ad670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd291320d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29130d940>]}
2021-10-07 14:05:26.329710 (MainThread): Flushing usage events
2021-10-07 14:05:26.883210 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 14:05:26.890732 (MainThread): Encountered an error:
2021-10-07 14:05:26.898651 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 14:05:26.914319 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'n' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 14:07:14.239357 (MainThread): Running with dbt=0.19.0
2021-10-07 14:07:14.465126 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Lunna', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:07:14.475386 (MainThread): Tracking: tracking
2021-10-07 14:07:14.479286 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0aa1acaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0abc53df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0aa1bc2e0>]}
2021-10-07 14:07:14.529728 (MainThread): Partial parsing not enabled
2021-10-07 14:07:14.540893 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:07:14.549102 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:07:14.553269 (MainThread): Parsing macros/relations.sql
2021-10-07 14:07:14.557287 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:07:14.580205 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:07:14.588802 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:07:14.597674 (MainThread): Parsing macros/core.sql
2021-10-07 14:07:14.610391 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:07:14.660618 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:07:14.673421 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:07:14.682774 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:07:14.691118 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:07:14.713605 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:07:14.717631 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:07:14.751482 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:07:14.769897 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:07:14.799108 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:07:14.803283 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:07:14.811529 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:07:14.820271 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:07:14.823749 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:07:14.827650 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:07:14.839269 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:07:14.843839 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:07:14.847803 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:07:14.850932 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:07:14.854806 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:07:14.860157 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:07:14.864502 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:07:14.879373 (MainThread): Partial parsing not enabled
2021-10-07 14:07:14.931338 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:07:14.971620 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:07:14.980898 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0aa10c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a9fe4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a9ff6220>]}
2021-10-07 14:07:14.983274 (MainThread): Flushing usage events
2021-10-07 14:07:15.529369 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 14:07:15.536015 (MainThread): Encountered an error:
2021-10-07 14:07:15.540221 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 14:07:15.564733 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'n' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'n' is undefined
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 14:08:13.517925 (MainThread): Running with dbt=0.19.0
2021-10-07 14:08:13.718494 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Lunna', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:08:13.729760 (MainThread): Tracking: tracking
2021-10-07 14:08:13.735334 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dddac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4f882d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4ddeb3a0>]}
2021-10-07 14:08:13.780731 (MainThread): Partial parsing not enabled
2021-10-07 14:08:13.791152 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:08:13.798890 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:08:13.803523 (MainThread): Parsing macros/relations.sql
2021-10-07 14:08:13.808263 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:08:13.833284 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:08:13.838917 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:08:13.846616 (MainThread): Parsing macros/core.sql
2021-10-07 14:08:13.858861 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:08:13.911959 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:08:13.923938 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:08:13.932980 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:08:13.940558 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:08:13.960443 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:08:13.964798 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:08:13.997635 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:08:14.012784 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:08:14.041313 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:08:14.048810 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:08:14.057649 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:08:14.066917 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:08:14.070292 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:08:14.074736 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:08:14.086349 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:08:14.090693 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:08:14.095182 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:08:14.098252 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:08:14.102243 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:08:14.107354 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:08:14.111261 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:08:14.124379 (MainThread): Partial parsing not enabled
2021-10-07 14:08:14.175205 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:08:14.213583 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:08:14.237196 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:08:14.429629 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:08:14.436908 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c37fe88-e95e-4a30-b3ee-78039154539e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dc2b340>]}
2021-10-07 14:08:14.478500 (MainThread): Acquiring new postgres connection "macro_Lunna".
2021-10-07 14:08:14.480404 (MainThread): Using postgres connection "macro_Lunna".
2021-10-07 14:08:14.482444 (MainThread): On macro_Lunna: BEGIN
2021-10-07 14:08:14.484398 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:08:14.492745 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:08:14.496606 (MainThread): On macro_Lunna: COMMIT
2021-10-07 14:08:14.499473 (MainThread): Using postgres connection "macro_Lunna".
2021-10-07 14:08:14.502680 (MainThread): On macro_Lunna: COMMIT
2021-10-07 14:08:14.507013 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:08:14.516479 (MainThread): 10005.0
2021-10-07 14:08:14.519386 (MainThread): On macro_Lunna: Close
2021-10-07 14:08:14.525964 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dddac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dc7ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dc7f580>]}
2021-10-07 14:08:14.530138 (MainThread): Flushing usage events
2021-10-07 14:08:15.037850 (MainThread): Connection 'macro_Lunna' was properly closed.
2021-10-07 14:14:10.284419 (MainThread): Running with dbt=0.19.0
2021-10-07 14:14:10.478550 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:14:10.494058 (MainThread): Tracking: tracking
2021-10-07 14:14:10.497538 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265079eca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2652245e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26507af2b0>]}
2021-10-07 14:14:10.548040 (MainThread): Partial parsing not enabled
2021-10-07 14:14:10.557449 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:14:10.563784 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:14:10.567602 (MainThread): Parsing macros/relations.sql
2021-10-07 14:14:10.571974 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:14:10.594952 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:14:10.599715 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:14:10.605144 (MainThread): Parsing macros/core.sql
2021-10-07 14:14:10.611714 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:14:10.660095 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:14:10.676304 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:14:10.692735 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:14:10.700544 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:14:10.719951 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:14:10.724391 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:14:10.771935 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:14:10.788677 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:14:10.812210 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:14:10.816442 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:14:10.825090 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:14:10.833897 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:14:10.837408 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:14:10.844340 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:14:10.861397 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:14:10.866174 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:14:10.870227 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:14:10.873529 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:14:10.877921 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:14:10.883156 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:14:10.887280 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:14:10.900444 (MainThread): Partial parsing not enabled
2021-10-07 14:14:10.943202 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:14:10.972005 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:14:10.998829 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:14:11.199231 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:14:11.215805 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa4b6fe5-b7c9-4edd-9285-0481f7141ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26505f90d0>]}
2021-10-07 14:14:11.256609 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:14:11.259326 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:14:11.261560 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:14:11.263591 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:14:11.270915 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:14:11.273761 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:14:11.275972 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:14:11.280649 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:14:11.284028 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:14:11.291760 (MainThread): 7
2021-10-07 14:14:11.294047 (MainThread): On macro_Luhns: Close
2021-10-07 14:14:11.300011 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265079eca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2650642430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2650642850>]}
2021-10-07 14:14:11.304454 (MainThread): Flushing usage events
2021-10-07 14:14:11.901456 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:16:43.924674 (MainThread): Running with dbt=0.19.0
2021-10-07 14:16:44.205478 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:16:44.214039 (MainThread): Tracking: tracking
2021-10-07 14:16:44.217329 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de280eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de42b4ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de281f310>]}
2021-10-07 14:16:44.246705 (MainThread): Partial parsing not enabled
2021-10-07 14:16:44.255896 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:16:44.271344 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:16:44.277322 (MainThread): Parsing macros/relations.sql
2021-10-07 14:16:44.284089 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:16:44.312323 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:16:44.326776 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:16:44.338029 (MainThread): Parsing macros/core.sql
2021-10-07 14:16:44.344652 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:16:44.397190 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:16:44.414029 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:16:44.428517 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:16:44.441937 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:16:44.469555 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:16:44.474964 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:16:44.521159 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:16:44.541439 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:16:44.572892 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:16:44.579811 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:16:44.594064 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:16:44.609878 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:16:44.613933 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:16:44.619557 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:16:44.631712 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:16:44.636154 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:16:44.639804 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:16:44.643201 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:16:44.647211 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:16:44.651945 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:16:44.655729 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:16:44.670930 (MainThread): Partial parsing not enabled
2021-10-07 14:16:44.719116 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:16:44.752870 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:16:44.776249 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:16:44.985956 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:16:44.998854 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '052af4a7-180f-4694-8db5-95bb1ca85658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de26691c0>]}
2021-10-07 14:16:45.055491 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:16:45.058020 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:16:45.060886 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:16:45.063726 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:16:45.076910 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:16:45.080613 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:16:45.085689 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:16:45.090680 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:16:45.094566 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:16:45.105780 (MainThread): 5
2021-10-07 14:16:45.111283 (MainThread): On macro_Luhns: Close
2021-10-07 14:16:45.117063 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de280eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de274f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de429e9d0>]}
2021-10-07 14:16:45.120433 (MainThread): Flushing usage events
2021-10-07 14:16:45.667818 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:19:27.094708 (MainThread): Running with dbt=0.19.0
2021-10-07 14:19:27.349498 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:19:27.363752 (MainThread): Tracking: tracking
2021-10-07 14:19:27.366972 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63275fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd634206eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd632770310>]}
2021-10-07 14:19:27.399947 (MainThread): Partial parsing not enabled
2021-10-07 14:19:27.412643 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:19:27.423170 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:19:27.429842 (MainThread): Parsing macros/relations.sql
2021-10-07 14:19:27.435783 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:19:27.480005 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:19:27.485875 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:19:27.491113 (MainThread): Parsing macros/core.sql
2021-10-07 14:19:27.498669 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:19:27.547350 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:19:27.561195 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:19:27.571859 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:19:27.581680 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:19:27.606849 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:19:27.613003 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:19:27.649546 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:19:27.669527 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:19:27.695576 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:19:27.700239 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:19:27.710708 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:19:27.722106 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:19:27.726535 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:19:27.731169 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:19:27.745065 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:19:27.754522 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:19:27.759068 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:19:27.764523 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:19:27.769336 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:19:27.775324 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:19:27.781316 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:19:27.802852 (MainThread): Partial parsing not enabled
2021-10-07 14:19:27.857437 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:19:27.884786 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:19:27.910383 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:19:28.124469 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:19:28.138123 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7342458a-182d-4afd-a3f7-f1713c8702e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6325bb310>]}
2021-10-07 14:19:28.202880 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:19:28.206357 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:19:28.209315 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:19:28.212120 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:19:28.224111 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:19:28.229321 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:19:28.236899 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:19:28.239867 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:19:28.243557 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:19:28.255975 (MainThread): 100050
2021-10-07 14:19:28.262430 (MainThread): On macro_Luhns: Close
2021-10-07 14:19:28.267350 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63275fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd632602c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd632602820>]}
2021-10-07 14:19:28.271378 (MainThread): Flushing usage events
2021-10-07 14:19:28.800294 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:20:37.640320 (MainThread): Running with dbt=0.19.0
2021-10-07 14:20:37.917789 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:20:37.926069 (MainThread): Tracking: tracking
2021-10-07 14:20:37.929235 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d7e65be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d990deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d7e773a0>]}
2021-10-07 14:20:37.959237 (MainThread): Partial parsing not enabled
2021-10-07 14:20:37.970793 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:20:37.977555 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:20:37.981179 (MainThread): Parsing macros/relations.sql
2021-10-07 14:20:37.985043 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:20:38.007311 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:20:38.017135 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:20:38.022933 (MainThread): Parsing macros/core.sql
2021-10-07 14:20:38.029783 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:20:38.073036 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:20:38.083713 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:20:38.098896 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:20:38.106781 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:20:38.135845 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:20:38.142197 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:20:38.179664 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:20:38.201705 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:20:38.230941 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:20:38.236943 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:20:38.248732 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:20:38.262901 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:20:38.267662 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:20:38.273546 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:20:38.290972 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:20:38.297257 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:20:38.303326 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:20:38.311296 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:20:38.320931 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:20:38.328719 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:20:38.334914 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:20:38.354896 (MainThread): Partial parsing not enabled
2021-10-07 14:20:38.410731 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:20:38.438221 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:20:38.461216 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:20:38.643418 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:20:38.657520 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec6ce170-9bc3-40c2-95a0-cb9b3f67bdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d7cb81c0>]}
2021-10-07 14:20:38.698418 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:20:38.700462 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:20:38.702313 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:20:38.704151 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:20:38.711955 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:20:38.714801 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:20:38.718403 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:20:38.721318 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:20:38.725655 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:20:38.734446 (MainThread): 100050
2021-10-07 14:20:38.736800 (MainThread): On macro_Luhns: Close
2021-10-07 14:20:38.739626 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d7e65be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d7d0aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d7d0aac0>]}
2021-10-07 14:20:38.743184 (MainThread): Flushing usage events
2021-10-07 14:20:39.265051 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:21:00.406058 (MainThread): Running with dbt=0.19.0
2021-10-07 14:21:00.630509 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:21:00.641111 (MainThread): Tracking: tracking
2021-10-07 14:21:00.644909 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60f878cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61131ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60f889400>]}
2021-10-07 14:21:00.673539 (MainThread): Partial parsing not enabled
2021-10-07 14:21:00.683247 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:21:00.702191 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:21:00.710978 (MainThread): Parsing macros/relations.sql
2021-10-07 14:21:00.721727 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:21:00.762009 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:21:00.771520 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:21:00.780452 (MainThread): Parsing macros/core.sql
2021-10-07 14:21:00.786755 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:21:00.838025 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:21:00.855451 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:21:00.867977 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:21:00.878634 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:21:00.900706 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:21:00.907291 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:21:00.941209 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:21:00.956511 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:21:00.978897 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:21:00.983234 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:21:00.991241 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:21:01.000037 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:21:01.003182 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:21:01.007399 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:21:01.019125 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:21:01.023122 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:21:01.027588 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:21:01.030872 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:21:01.034898 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:21:01.040022 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:21:01.045112 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:21:01.061964 (MainThread): Partial parsing not enabled
2021-10-07 14:21:01.103363 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:21:01.132055 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:21:01.155359 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:21:01.333346 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:21:01.341920 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd6bcf2-5859-4d98-af5a-953b5a2894a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60f6cb280>]}
2021-10-07 14:21:01.356111 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:21:01.359038 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:21:01.362561 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:21:01.365127 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:21:01.380114 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:21:01.385087 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:21:01.390416 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:21:01.396370 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:21:01.405231 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:21:01.415002 (MainThread): 0
2021-10-07 14:21:01.417513 (MainThread): On macro_Luhns: Close
2021-10-07 14:21:01.421451 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60f878cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60f737fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60f737790>]}
2021-10-07 14:21:01.424471 (MainThread): Flushing usage events
2021-10-07 14:21:01.946542 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:21:37.387061 (MainThread): Running with dbt=0.19.0
2021-10-07 14:21:37.573674 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:21:37.587271 (MainThread): Tracking: tracking
2021-10-07 14:21:37.590646 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ee78fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f0236d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ee7a13d0>]}
2021-10-07 14:21:37.656069 (MainThread): Partial parsing not enabled
2021-10-07 14:21:37.666426 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:21:37.672369 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:21:37.676155 (MainThread): Parsing macros/relations.sql
2021-10-07 14:21:37.680159 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:21:37.702540 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:21:37.706973 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:21:37.712137 (MainThread): Parsing macros/core.sql
2021-10-07 14:21:37.718733 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:21:37.761904 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:21:37.773491 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:21:37.782338 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:21:37.790220 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:21:37.810388 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:21:37.815149 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:21:37.855401 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:21:37.880411 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:21:37.913720 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:21:37.919868 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:21:37.933222 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:21:37.947378 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:21:37.952629 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:21:37.956921 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:21:37.967535 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:21:37.972657 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:21:37.978754 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:21:37.982103 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:21:37.985926 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:21:37.990839 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:21:37.994744 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:21:38.011468 (MainThread): Partial parsing not enabled
2021-10-07 14:21:38.057322 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:21:38.096362 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:21:38.124421 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:21:38.341255 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:21:38.355246 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cff93340-cc65-468b-8f56-8269f9d9415a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ee5df250>]}
2021-10-07 14:21:38.400786 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:21:38.403739 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:21:38.406431 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:21:38.408758 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:21:38.417869 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:21:38.421319 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:21:38.424954 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:21:38.428077 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:21:38.431157 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:21:38.440977 (MainThread): 10005
2021-10-07 14:21:38.444725 (MainThread): On macro_Luhns: Close
2021-10-07 14:21:38.453176 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ee78fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ee5acf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ee616bb0>]}
2021-10-07 14:21:38.456278 (MainThread): Flushing usage events
2021-10-07 14:21:38.966113 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:22:26.529134 (MainThread): Running with dbt=0.19.0
2021-10-07 14:22:26.730539 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:22:26.739517 (MainThread): Tracking: tracking
2021-10-07 14:22:26.743271 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0d894d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0f33cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0d8a63a0>]}
2021-10-07 14:22:26.771419 (MainThread): Partial parsing not enabled
2021-10-07 14:22:26.780961 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:22:26.790565 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:22:26.794561 (MainThread): Parsing macros/relations.sql
2021-10-07 14:22:26.799083 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:22:26.831553 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:22:26.838105 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:22:26.844760 (MainThread): Parsing macros/core.sql
2021-10-07 14:22:26.861489 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:22:26.904385 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:22:26.916300 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:22:26.924609 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:22:26.932196 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:22:26.952710 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:22:26.960410 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:22:26.999490 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:22:27.021600 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:22:27.045223 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:22:27.049581 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:22:27.057949 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:22:27.066693 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:22:27.070251 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:22:27.074055 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:22:27.085249 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:22:27.090114 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:22:27.094147 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:22:27.097533 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:22:27.101527 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:22:27.106755 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:22:27.112592 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:22:27.133367 (MainThread): Partial parsing not enabled
2021-10-07 14:22:27.190581 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:22:27.218350 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:22:27.241681 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:22:27.421822 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:22:27.430125 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7734082e-94d7-4bf4-a5dc-a99c9be498fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0d6e7280>]}
2021-10-07 14:22:27.469133 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:22:27.472892 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:22:27.475855 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:22:27.477846 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:22:27.484744 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:22:27.488373 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:22:27.491601 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:22:27.494998 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:22:27.498447 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:22:27.511330 (MainThread): 10005
2021-10-07 14:22:27.514528 (MainThread): On macro_Luhns: Close
2021-10-07 14:22:27.523563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0d894d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0d7384c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0d7386a0>]}
2021-10-07 14:22:27.529329 (MainThread): Flushing usage events
2021-10-07 14:22:28.058565 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:23:06.263574 (MainThread): Running with dbt=0.19.0
2021-10-07 14:23:06.467021 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:23:06.480768 (MainThread): Tracking: tracking
2021-10-07 14:23:06.484305 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdacb839b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdacd2e1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdacb84b310>]}
2021-10-07 14:23:06.545623 (MainThread): Partial parsing not enabled
2021-10-07 14:23:06.565501 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:23:06.572351 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:23:06.577888 (MainThread): Parsing macros/relations.sql
2021-10-07 14:23:06.584926 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:23:06.613491 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:23:06.623584 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:23:06.631228 (MainThread): Parsing macros/core.sql
2021-10-07 14:23:06.637916 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:23:06.680741 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:23:06.691890 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:23:06.700873 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:23:06.708586 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:23:06.728490 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:23:06.733038 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:23:06.765088 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:23:06.785470 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:23:06.808909 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:23:06.814135 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:23:06.822841 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:23:06.832092 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:23:06.835639 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:23:06.839860 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:23:06.851671 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:23:06.856186 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:23:06.860059 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:23:06.864713 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:23:06.868109 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:23:06.874023 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:23:06.877850 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:23:06.898066 (MainThread): Partial parsing not enabled
2021-10-07 14:23:06.942201 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:23:06.972994 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:23:06.995632 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:23:07.210222 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:23:07.227768 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7ed8fdf-38fa-4bfd-88bb-fe896a394836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdacb696190>]}
2021-10-07 14:23:07.273364 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:23:07.276258 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:23:07.278367 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:23:07.280997 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:23:07.291791 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:23:07.294779 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:23:07.299195 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:23:07.302906 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:23:07.306021 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:23:07.321123 (MainThread): 100050
2021-10-07 14:23:07.326700 (MainThread): On macro_Luhns: Close
2021-10-07 14:23:07.332810 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdacb839b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdacb6fb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdacb73bbe0>]}
2021-10-07 14:23:07.336243 (MainThread): Flushing usage events
2021-10-07 14:23:07.872587 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:23:23.891588 (MainThread): Running with dbt=0.19.0
2021-10-07 14:23:24.198049 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:23:24.210585 (MainThread): Tracking: tracking
2021-10-07 14:23:24.216573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69317bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb694c23e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69318d370>]}
2021-10-07 14:23:24.259233 (MainThread): Partial parsing not enabled
2021-10-07 14:23:24.265334 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:23:24.274786 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:23:24.278938 (MainThread): Parsing macros/relations.sql
2021-10-07 14:23:24.283364 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:23:24.309930 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:23:24.327925 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:23:24.334118 (MainThread): Parsing macros/core.sql
2021-10-07 14:23:24.341317 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:23:24.415978 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:23:24.426812 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:23:24.435834 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:23:24.443625 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:23:24.467840 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:23:24.472120 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:23:24.508058 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:23:24.532807 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:23:24.557995 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:23:24.561989 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:23:24.570614 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:23:24.582445 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:23:24.586480 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:23:24.591250 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:23:24.604833 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:23:24.609985 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:23:24.615113 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:23:24.619697 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:23:24.624479 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:23:24.630455 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:23:24.635251 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:23:24.653869 (MainThread): Partial parsing not enabled
2021-10-07 14:23:24.699229 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:23:24.738360 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:23:24.774177 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:23:25.004311 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:23:25.017339 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6672e13-5f91-458f-9636-5a0fc0dfe434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb692fce250>]}
2021-10-07 14:23:25.063683 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:23:25.066121 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:23:25.068891 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:23:25.071574 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:23:25.085232 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:23:25.089462 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:23:25.094030 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:23:25.098616 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:23:25.103763 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:23:25.115697 (MainThread): 100050
2021-10-07 14:23:25.118292 (MainThread): On macro_Luhns: Close
2021-10-07 14:23:25.123933 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69317bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6930d3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb692fb09d0>]}
2021-10-07 14:23:25.126305 (MainThread): Flushing usage events
2021-10-07 14:23:25.614893 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:24:31.929712 (MainThread): Running with dbt=0.19.0
2021-10-07 14:24:32.133040 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:24:32.145052 (MainThread): Tracking: tracking
2021-10-07 14:24:32.148279 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66301a7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6631c4ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66301b8460>]}
2021-10-07 14:24:32.175408 (MainThread): Partial parsing not enabled
2021-10-07 14:24:32.181714 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:24:32.192850 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:24:32.198289 (MainThread): Parsing macros/relations.sql
2021-10-07 14:24:32.203577 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:24:32.253123 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:24:32.267528 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:24:32.282638 (MainThread): Parsing macros/core.sql
2021-10-07 14:24:32.297892 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:24:32.346892 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:24:32.358770 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:24:32.371560 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:24:32.379281 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:24:32.398488 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:24:32.402438 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:24:32.435517 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:24:32.451064 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:24:32.474250 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:24:32.478623 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:24:32.486747 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:24:32.496312 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:24:32.499808 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:24:32.503910 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:24:32.515788 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:24:32.519973 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:24:32.524032 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:24:32.527290 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:24:32.535022 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:24:32.545156 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:24:32.553351 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:24:32.572950 (MainThread): Partial parsing not enabled
2021-10-07 14:24:32.613847 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:24:32.653017 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:24:32.676719 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:24:32.868722 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:24:32.881479 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed9ee146-f476-4b60-84c0-5a4e0bfb4d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662fffa340>]}
2021-10-07 14:24:32.933088 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:24:32.935546 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:24:32.937542 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:24:32.939244 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:24:32.948542 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:24:32.951540 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:24:32.955390 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:24:32.959949 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:24:32.963910 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:24:32.976702 (MainThread): 100050
2021-10-07 14:24:32.981218 (MainThread): On macro_Luhns: Close
2021-10-07 14:24:32.985848 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66301a7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663004c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663004cf10>]}
2021-10-07 14:24:32.988423 (MainThread): Flushing usage events
2021-10-07 14:24:33.567982 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:28:02.982453 (MainThread): Running with dbt=0.19.0
2021-10-07 14:28:03.189669 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:28:03.202115 (MainThread): Tracking: tracking
2021-10-07 14:28:03.206333 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc709e94c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70b93ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc709ea6370>]}
2021-10-07 14:28:03.240956 (MainThread): Partial parsing not enabled
2021-10-07 14:28:03.249650 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:28:03.257089 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:28:03.260606 (MainThread): Parsing macros/relations.sql
2021-10-07 14:28:03.264276 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:28:03.286842 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:28:03.294117 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:28:03.302623 (MainThread): Parsing macros/core.sql
2021-10-07 14:28:03.313075 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:28:03.369133 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:28:03.386474 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:28:03.401492 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:28:03.410186 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:28:03.431818 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:28:03.438384 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:28:03.472810 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:28:03.488812 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:28:03.511278 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:28:03.515607 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:28:03.523680 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:28:03.532490 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:28:03.536068 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:28:03.540281 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:28:03.551286 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:28:03.555691 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:28:03.560017 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:28:03.563544 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:28:03.567576 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:28:03.576698 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:28:03.581594 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:28:03.596116 (MainThread): Partial parsing not enabled
2021-10-07 14:28:03.643882 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:28:03.679427 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:28:03.702902 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:28:03.879357 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:28:03.889533 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f984f21e-9e20-466a-a23e-671ed6732f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc709ce7280>]}
2021-10-07 14:28:03.930851 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:28:03.933864 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:28:03.936585 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:28:03.939065 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:28:03.950115 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:28:03.953346 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:28:03.957673 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:28:03.961058 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:28:03.965314 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:28:03.974332 (MainThread): 100050
2021-10-07 14:28:03.977748 (MainThread): On macro_Luhns: Close
2021-10-07 14:28:03.982544 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc709e94c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc709d42eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc709d42e50>]}
2021-10-07 14:28:03.985401 (MainThread): Flushing usage events
2021-10-07 14:28:04.568616 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:29:05.374994 (MainThread): Running with dbt=0.19.0
2021-10-07 14:29:05.598020 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:29:05.610532 (MainThread): Tracking: tracking
2021-10-07 14:29:05.619036 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bd74d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2d81bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bd86460>]}
2021-10-07 14:29:05.683609 (MainThread): Partial parsing not enabled
2021-10-07 14:29:05.693851 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:29:05.705942 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:29:05.709701 (MainThread): Parsing macros/relations.sql
2021-10-07 14:29:05.713206 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:29:05.737405 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:29:05.742646 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:29:05.752943 (MainThread): Parsing macros/core.sql
2021-10-07 14:29:05.765608 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:29:05.813628 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:29:05.826300 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:29:05.836777 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:29:05.844735 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:29:05.866808 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:29:05.871037 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:29:05.904060 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:29:05.921376 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:29:05.946856 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:29:05.951216 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:29:05.963293 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:29:05.974542 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:29:05.978313 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:29:05.983086 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:29:05.994253 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:29:05.998734 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:29:06.002693 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:29:06.006186 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:29:06.010495 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:29:06.016211 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:29:06.020825 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:29:06.039886 (MainThread): Partial parsing not enabled
2021-10-07 14:29:06.086137 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:29:06.119213 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:29:06.145608 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:29:06.342125 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:29:06.354541 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e6e7678-90a9-4616-9058-f01a684bcfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bbc7280>]}
2021-10-07 14:29:06.397551 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:29:06.399611 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:29:06.401820 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:29:06.405293 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:29:06.417244 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:29:06.421785 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:29:06.426404 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:29:06.430719 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:29:06.435693 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:29:06.452291 (MainThread): 100050
2021-10-07 14:29:06.457180 (MainThread): On macro_Luhns: Close
2021-10-07 14:29:06.463143 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bbaa2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bca3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2bc03df0>]}
2021-10-07 14:29:06.466151 (MainThread): Flushing usage events
2021-10-07 14:29:11.559204 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:32:29.866840 (MainThread): Running with dbt=0.19.0
2021-10-07 14:32:30.438661 (MainThread): running dbt with arguments Namespace(args='{cc: 100050,n: 6}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:32:30.453662 (MainThread): Tracking: tracking
2021-10-07 14:32:30.460728 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838da3cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838f4e3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838da4e3d0>]}
2021-10-07 14:32:30.554023 (MainThread): Partial parsing not enabled
2021-10-07 14:32:30.573421 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:32:30.592431 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:32:30.601425 (MainThread): Parsing macros/relations.sql
2021-10-07 14:32:30.609910 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:32:30.699054 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:32:30.722346 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:32:30.714135 (MainThread): Parsing macros/core.sql
2021-10-07 14:32:30.731019 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:32:30.919851 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:32:30.972641 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:32:31.013851 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:32:31.032661 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:32:31.126647 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:32:31.149561 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:32:31.280196 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:32:31.357453 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:32:31.441856 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:32:31.467048 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:32:31.499756 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:32:31.527569 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:32:31.534284 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:32:31.543246 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:32:31.579153 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:32:31.590332 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:32:31.601068 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:32:31.610682 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:32:31.621625 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:32:31.633513 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:32:31.642421 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:32:31.688045 (MainThread): Partial parsing not enabled
2021-10-07 14:32:31.850508 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:32:31.945963 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:32:32.030725 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:32:32.781409 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:32:32.804644 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c10d24c-fadc-4d36-8d79-31cf34d59a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838d8971f0>]}
2021-10-07 14:32:32.950440 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:32:32.954920 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:32:32.959452 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:32:32.964752 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:32:32.985882 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-07 14:32:32.994827 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:32:33.005600 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:32:33.012809 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:32:33.018402 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:32:33.072683 (MainThread): 1
2021-10-07 14:32:33.079795 (MainThread): On macro_Luhns: Close
2021-10-07 14:32:33.089341 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838da3cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838d8202b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838d8206d0>]}
2021-10-07 14:32:33.097347 (MainThread): Flushing usage events
2021-10-07 14:32:33.674338 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:35:01.291562 (MainThread): Running with dbt=0.19.0
2021-10-07 14:35:01.483031 (MainThread): running dbt with arguments Namespace(args='{cc: 9375586740987475,n: 12}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:35:01.495550 (MainThread): Tracking: tracking
2021-10-07 14:35:01.500446 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c190f1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c1ab98d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c19102430>]}
2021-10-07 14:35:01.536205 (MainThread): Partial parsing not enabled
2021-10-07 14:35:01.544477 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:35:01.551695 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:35:01.555523 (MainThread): Parsing macros/relations.sql
2021-10-07 14:35:01.559494 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:35:01.581371 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:35:01.588906 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:35:01.599064 (MainThread): Parsing macros/core.sql
2021-10-07 14:35:01.612833 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:35:01.665792 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:35:01.678000 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:35:01.687085 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:35:01.694510 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:35:01.715749 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:35:01.719785 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:35:01.751759 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:35:01.767929 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:35:01.791183 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:35:01.795883 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:35:01.804894 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:35:01.813620 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:35:01.818361 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:35:01.822469 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:35:01.833014 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:35:01.837005 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:35:01.841140 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:35:01.844661 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:35:01.848504 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:35:01.853472 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:35:01.857600 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:35:01.872574 (MainThread): Partial parsing not enabled
2021-10-07 14:35:01.913696 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:35:01.950563 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:35:01.974074 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:35:02.156556 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:35:02.168861 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '481bb8f5-aab7-489a-bad2-5fad17473cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c18f442b0>]}
2021-10-07 14:35:02.211276 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:35:02.213997 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:35:02.216460 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:35:02.218981 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:35:02.231103 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:35:02.235096 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:35:02.240462 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:35:02.242775 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:35:02.245705 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:35:02.259666 (MainThread): 1
2021-10-07 14:35:02.263578 (MainThread): On macro_Luhns: Close
2021-10-07 14:35:02.266750 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c190f1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c18edb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c18edb2b0>]}
2021-10-07 14:35:02.269918 (MainThread): Flushing usage events
2021-10-07 14:35:02.859383 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:35:21.183205 (MainThread): Running with dbt=0.19.0
2021-10-07 14:35:21.384895 (MainThread): running dbt with arguments Namespace(args='{cc: 9375586740987475,n: 12}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:35:21.395341 (MainThread): Tracking: tracking
2021-10-07 14:35:21.398943 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c3b65c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c560de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c3b77370>]}
2021-10-07 14:35:21.445747 (MainThread): Partial parsing not enabled
2021-10-07 14:35:21.455282 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:35:21.468697 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:35:21.473693 (MainThread): Parsing macros/relations.sql
2021-10-07 14:35:21.480514 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:35:21.515633 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:35:21.520611 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:35:21.525713 (MainThread): Parsing macros/core.sql
2021-10-07 14:35:21.532522 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:35:21.576576 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:35:21.587489 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:35:21.596138 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:35:21.603461 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:35:21.623554 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:35:21.628005 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:35:21.660956 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:35:21.677349 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:35:21.701161 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:35:21.706240 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:35:21.716402 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:35:21.725379 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:35:21.728845 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:35:21.733100 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:35:21.746051 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:35:21.750854 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:35:21.755693 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:35:21.758971 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:35:21.763400 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:35:21.768557 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:35:21.772709 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:35:21.788796 (MainThread): Partial parsing not enabled
2021-10-07 14:35:21.829007 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:35:21.857656 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:35:21.882706 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:35:22.071435 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:35:22.081727 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d6a0d0d-af80-4e89-9992-7565e4a3ed0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c39b81f0>]}
2021-10-07 14:35:22.136597 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:35:22.138471 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:35:22.140263 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:35:22.142166 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:35:22.150759 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:35:22.155357 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:35:22.160403 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:35:22.163149 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:35:22.166497 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:35:22.176810 (MainThread): 0
2021-10-07 14:35:22.179133 (MainThread): On macro_Luhns: Close
2021-10-07 14:35:22.182111 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c3b65c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c394d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c394dee0>]}
2021-10-07 14:35:22.185587 (MainThread): Flushing usage events
2021-10-07 14:35:22.692183 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:36:27.143433 (MainThread): Running with dbt=0.19.0
2021-10-07 14:36:27.470837 (MainThread): running dbt with arguments Namespace(args='{cc: 9375586740987475,n: 12}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:36:27.483032 (MainThread): Tracking: tracking
2021-10-07 14:36:27.487328 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2a07cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bb23d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2a08d490>]}
2021-10-07 14:36:27.529520 (MainThread): Partial parsing not enabled
2021-10-07 14:36:27.539073 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:36:27.547803 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:36:27.554114 (MainThread): Parsing macros/relations.sql
2021-10-07 14:36:27.558486 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:36:27.596826 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:36:27.602091 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:36:27.608256 (MainThread): Parsing macros/core.sql
2021-10-07 14:36:27.616464 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:36:27.664037 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:36:27.675961 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:36:27.685652 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:36:27.693899 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:36:27.715926 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:36:27.720937 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:36:27.755977 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:36:27.774586 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:36:27.799700 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:36:27.804294 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:36:27.812791 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:36:27.824492 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:36:27.828254 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:36:27.832576 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:36:27.846299 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:36:27.851249 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:36:27.855313 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:36:27.858362 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:36:27.862621 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:36:27.868022 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:36:27.872345 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:36:27.887576 (MainThread): Partial parsing not enabled
2021-10-07 14:36:27.930809 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:36:27.966692 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:36:27.995075 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:36:28.196145 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:36:28.208032 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '347b5df6-fc54-456a-9c01-18def85208dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b29ecf3a0>]}
2021-10-07 14:36:28.261823 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:36:28.264852 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:36:28.267211 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:36:28.269743 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:36:28.282235 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:36:28.285613 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:36:28.288726 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:36:28.292379 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:36:28.297771 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:36:28.311217 (MainThread): 0
2021-10-07 14:36:28.315537 (MainThread): On macro_Luhns: Close
2021-10-07 14:36:28.321152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2a07cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b29eb4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b29eb4cd0>]}
2021-10-07 14:36:28.327673 (MainThread): Flushing usage events
2021-10-07 14:36:28.874048 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:36:50.692557 (MainThread): Running with dbt=0.19.0
2021-10-07 14:36:50.893343 (MainThread): running dbt with arguments Namespace(args='{cc: 9375586740987475,n: 12}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:36:50.901319 (MainThread): Tracking: tracking
2021-10-07 14:36:50.905343 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8515debe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb853085ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8515ef340>]}
2021-10-07 14:36:50.934392 (MainThread): Partial parsing not enabled
2021-10-07 14:36:50.941413 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:36:50.950051 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:36:50.956181 (MainThread): Parsing macros/relations.sql
2021-10-07 14:36:50.963520 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:36:50.997036 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:36:51.010141 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:36:51.028335 (MainThread): Parsing macros/core.sql
2021-10-07 14:36:51.042841 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:36:51.088920 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:36:51.100980 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:36:51.109492 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:36:51.116660 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:36:51.137552 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:36:51.142087 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:36:51.174537 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:36:51.190429 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:36:51.213123 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:36:51.217247 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:36:51.225747 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:36:51.234316 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:36:51.239342 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:36:51.247114 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:36:51.258768 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:36:51.262559 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:36:51.266460 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:36:51.269883 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:36:51.273399 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:36:51.278518 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:36:51.285342 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:36:51.308446 (MainThread): Partial parsing not enabled
2021-10-07 14:36:51.347434 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:36:51.376603 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:36:51.400629 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:36:51.618959 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:36:51.631026 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '148fe157-45da-4b9f-835f-00136d871a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb851430250>]}
2021-10-07 14:36:51.686527 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:36:51.689821 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:36:51.692358 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:36:51.695053 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:36:51.704925 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 14:36:51.708597 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:36:51.711236 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:36:51.713865 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:36:51.718250 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:36:51.730794 (MainThread): 1
2021-10-07 14:36:51.733998 (MainThread): On macro_Luhns: Close
2021-10-07 14:36:51.738744 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8515debe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb851515130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb851515100>]}
2021-10-07 14:36:51.743904 (MainThread): Flushing usage events
2021-10-07 14:36:52.580638 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:37:49.177037 (MainThread): Running with dbt=0.19.0
2021-10-07 14:37:49.742882 (MainThread): running dbt with arguments Namespace(args='{cc: 9375586740987475,n: 12}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:37:49.755085 (MainThread): Tracking: tracking
2021-10-07 14:37:49.761203 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae00188dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae01c2fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae00199430>]}
2021-10-07 14:37:49.841539 (MainThread): Partial parsing not enabled
2021-10-07 14:37:49.860302 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:37:49.879643 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:37:49.886455 (MainThread): Parsing macros/relations.sql
2021-10-07 14:37:49.895280 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:37:50.008050 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:37:50.020364 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:37:50.032181 (MainThread): Parsing macros/core.sql
2021-10-07 14:37:50.063675 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:37:50.276062 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:37:50.340848 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:37:50.366289 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:37:50.388184 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:37:50.492770 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:37:50.502910 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:37:50.649304 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:37:50.706025 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:37:50.825626 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:37:50.836915 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:37:50.881986 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:37:50.918151 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:37:50.932784 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:37:50.941919 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:37:50.982180 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:37:50.990484 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:37:51.008057 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:37:51.015295 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:37:51.023420 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:37:51.034966 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:37:51.043786 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:37:51.089003 (MainThread): Partial parsing not enabled
2021-10-07 14:37:51.301367 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:37:51.404132 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:37:51.513190 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:37:52.240908 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:37:52.272399 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b64ca97-35bf-470d-859c-a4dfab0c6450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfffdb0a0>]}
2021-10-07 14:37:52.401057 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:37:52.408081 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:37:52.413012 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:37:52.416924 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:37:52.433696 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-07 14:37:52.438531 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:37:52.444728 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:37:52.448878 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:37:52.453903 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:37:52.497792 (MainThread): 1
2021-10-07 14:37:52.503046 (MainThread): On macro_Luhns: Close
2021-10-07 14:37:52.510246 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae00188dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae00026ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae00026d30>]}
2021-10-07 14:37:52.515995 (MainThread): Flushing usage events
2021-10-07 14:37:53.068877 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:38:29.269708 (MainThread): Running with dbt=0.19.0
2021-10-07 14:38:29.885901 (MainThread): running dbt with arguments Namespace(args='{cc: 9375586740987475,n: 12}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:38:29.907753 (MainThread): Tracking: tracking
2021-10-07 14:38:29.922087 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99fdec6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ff96dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99fded7340>]}
2021-10-07 14:38:30.056763 (MainThread): Partial parsing not enabled
2021-10-07 14:38:30.077328 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:38:30.121969 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:38:30.129861 (MainThread): Parsing macros/relations.sql
2021-10-07 14:38:30.139536 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:38:30.255446 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:38:30.266199 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:38:30.277107 (MainThread): Parsing macros/core.sql
2021-10-07 14:38:30.321128 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:38:30.497739 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:38:30.548939 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:38:30.575410 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:38:30.595821 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:38:30.687179 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:38:30.696243 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:38:30.860892 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:38:30.943713 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:38:31.069215 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:38:31.078771 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:38:31.113713 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:38:31.153020 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:38:31.160401 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:38:31.167933 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:38:31.214232 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:38:31.224536 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:38:31.233831 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:38:31.245776 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:38:31.256080 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:38:31.268070 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:38:31.289531 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:38:31.326175 (MainThread): Partial parsing not enabled
2021-10-07 14:38:31.561291 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:38:31.713612 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:38:31.829477 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:38:32.759486 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:38:32.791570 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00a385a6-0cb5-4bb3-b03c-ba7614a10513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99fdd18370>]}
2021-10-07 14:38:32.934743 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:38:32.939937 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:38:32.944414 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:38:32.948204 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:38:32.966879 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-07 14:38:32.973131 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:38:32.979896 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:38:32.984858 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:38:32.990841 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:38:33.019086 (MainThread): 0
2021-10-07 14:38:33.026215 (MainThread): On macro_Luhns: Close
2021-10-07 14:38:33.038489 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99fdec6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99fdd63af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99fdd63a90>]}
2021-10-07 14:38:33.044283 (MainThread): Flushing usage events
2021-10-07 14:38:33.582879 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:38:55.252774 (MainThread): Running with dbt=0.19.0
2021-10-07 14:38:55.943335 (MainThread): running dbt with arguments Namespace(args='{cc: 9375586740987475,n: 12}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 14:38:55.956536 (MainThread): Tracking: tracking
2021-10-07 14:38:55.963274 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bba28cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bbbd33d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bba29d490>]}
2021-10-07 14:38:56.029925 (MainThread): Partial parsing not enabled
2021-10-07 14:38:56.052898 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:38:56.080969 (MainThread): Parsing macros/Lunna.sql
2021-10-07 14:38:56.098254 (MainThread): Parsing macros/relations.sql
2021-10-07 14:38:56.120842 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:38:56.248069 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:38:56.260821 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:38:56.272319 (MainThread): Parsing macros/core.sql
2021-10-07 14:38:56.289223 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:38:56.537920 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:38:56.590241 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:38:56.623469 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:38:56.652709 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:38:56.795299 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:38:56.804767 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:38:56.978429 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:38:57.069024 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:38:57.208393 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:38:57.228092 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:38:57.268333 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:38:57.299980 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:38:57.310603 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:38:57.330245 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:38:57.392250 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:38:57.402654 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:38:57.411373 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:38:57.419190 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:38:57.428031 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:38:57.441253 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:38:57.451713 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:38:57.512277 (MainThread): Partial parsing not enabled
2021-10-07 14:38:57.761217 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:38:57.911146 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:38:58.033138 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.firstnames_snapshot".
2021-10-07 14:38:58.972904 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 14:38:58.998373 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3875120-a54e-438a-8fbf-3f26d7ae46e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bba0df400>]}
2021-10-07 14:38:59.212811 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 14:38:59.217782 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:38:59.221303 (MainThread): On macro_Luhns: BEGIN
2021-10-07 14:38:59.224647 (MainThread): Opening a new connection, currently in state init
2021-10-07 14:38:59.244821 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-07 14:38:59.251363 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:38:59.260266 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 14:38:59.275264 (MainThread): On macro_Luhns: COMMIT
2021-10-07 14:38:59.291729 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 14:38:59.330723 (MainThread): 0
2021-10-07 14:38:59.335904 (MainThread): On macro_Luhns: Close
2021-10-07 14:38:59.346241 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bba28cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bba149ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bba149ee0>]}
2021-10-07 14:38:59.352200 (MainThread): Flushing usage events
2021-10-07 14:38:59.873883 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 14:44:34.706909 (MainThread): Running with dbt=0.19.0
2021-10-07 14:44:34.909441 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 14:44:34.923994 (MainThread): Tracking: tracking
2021-10-07 14:44:34.929843 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d718f0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d74ef83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d719020a0>]}
2021-10-07 14:44:34.964782 (MainThread): Partial parsing not enabled
2021-10-07 14:44:34.973238 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:44:34.985633 (MainThread): Parsing macros/relations.sql
2021-10-07 14:44:34.993304 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:44:35.028165 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:44:35.038058 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:44:35.048810 (MainThread): Parsing macros/core.sql
2021-10-07 14:44:35.057330 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:44:35.102161 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:44:35.114461 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:44:35.123797 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:44:35.131994 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:44:35.151268 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:44:35.155734 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:44:35.187960 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:44:35.204381 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:44:35.226891 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:44:35.231022 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:44:35.239433 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:44:35.255704 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:44:35.261255 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:44:35.268402 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:44:35.279346 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:44:35.283608 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:44:35.287575 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:44:35.291145 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:44:35.295059 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:44:35.300762 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:44:35.304926 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:44:35.320751 (MainThread): Partial parsing not enabled
2021-10-07 14:44:35.372002 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:44:35.411428 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:44:35.425083 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7184e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d71713f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d7170f9d0>]}
2021-10-07 14:44:35.427648 (MainThread): Flushing usage events
2021-10-07 14:44:35.985204 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 14:44:35.990963 (MainThread): Encountered an error:
2021-10-07 14:44:35.995109 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'str' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 14:44:36.007508 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'str' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'str' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 14:45:13.100186 (MainThread): Running with dbt=0.19.0
2021-10-07 14:45:13.324898 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 14:45:13.340191 (MainThread): Tracking: tracking
2021-10-07 14:45:13.347510 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea7ff09a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea9a9b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea8002190>]}
2021-10-07 14:45:13.418412 (MainThread): Partial parsing not enabled
2021-10-07 14:45:13.430746 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:45:13.442270 (MainThread): Parsing macros/relations.sql
2021-10-07 14:45:13.446570 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:45:13.469394 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:45:13.474179 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:45:13.478758 (MainThread): Parsing macros/core.sql
2021-10-07 14:45:13.484849 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:45:13.528533 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:45:13.539464 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:45:13.547921 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:45:13.555184 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:45:13.576287 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:45:13.580515 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:45:13.613661 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:45:13.639129 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:45:13.677050 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:45:13.684494 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:45:13.699373 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:45:13.714643 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:45:13.725100 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:45:13.730927 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:45:13.750931 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:45:13.756193 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:45:13.759855 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:45:13.765621 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:45:13.772389 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:45:13.781749 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:45:13.790824 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:45:13.812067 (MainThread): Partial parsing not enabled
2021-10-07 14:45:13.866173 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:45:13.896298 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:45:13.908489 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea7f54550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea7e15e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea7e119a0>]}
2021-10-07 14:45:13.910861 (MainThread): Flushing usage events
2021-10-07 14:45:14.424794 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 14:45:14.431858 (MainThread): Encountered an error:
2021-10-07 14:45:14.437424 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 14:45:14.453366 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 14:45:42.319844 (MainThread): Running with dbt=0.19.0
2021-10-07 14:45:42.535256 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 14:45:42.546947 (MainThread): Tracking: tracking
2021-10-07 14:45:42.551241 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c413ee940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c449f5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c41400130>]}
2021-10-07 14:45:42.607597 (MainThread): Partial parsing not enabled
2021-10-07 14:45:42.618998 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:45:42.625977 (MainThread): Parsing macros/relations.sql
2021-10-07 14:45:42.630249 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:45:42.653663 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:45:42.660345 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:45:42.667106 (MainThread): Parsing macros/core.sql
2021-10-07 14:45:42.675971 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:45:42.726749 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:45:42.738069 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:45:42.747775 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:45:42.756274 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:45:42.775812 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:45:42.780295 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:45:42.812826 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:45:42.830323 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:45:42.853521 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:45:42.857484 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:45:42.866139 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:45:42.874843 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:45:42.878028 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:45:42.882164 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:45:42.893748 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:45:42.898165 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:45:42.902385 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:45:42.905766 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:45:42.909577 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:45:42.915035 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:45:42.919866 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:45:42.935520 (MainThread): Partial parsing not enabled
2021-10-07 14:45:42.977654 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:45:43.013617 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:45:43.035031 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c41352130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c41213fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c4120f3d0>]}
2021-10-07 14:45:43.038426 (MainThread): Flushing usage events
2021-10-07 14:45:43.551902 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 14:45:43.559610 (MainThread): Encountered an error:
2021-10-07 14:45:43.565096 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 14:45:43.577970 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 14:46:22.500626 (MainThread): Running with dbt=0.19.0
2021-10-07 14:46:22.717368 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 14:46:22.728243 (MainThread): Tracking: tracking
2021-10-07 14:46:22.732146 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0d065970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0eb10280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0d076160>]}
2021-10-07 14:46:22.761775 (MainThread): Partial parsing not enabled
2021-10-07 14:46:22.768352 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:46:22.774935 (MainThread): Parsing macros/relations.sql
2021-10-07 14:46:22.780164 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:46:22.803250 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:46:22.810549 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:46:22.817695 (MainThread): Parsing macros/core.sql
2021-10-07 14:46:22.832188 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:46:22.881686 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:46:22.893674 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:46:22.903155 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:46:22.911200 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:46:22.933007 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:46:22.937506 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:46:22.969425 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:46:22.985156 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:46:23.008241 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:46:23.012747 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:46:23.021382 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:46:23.030800 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:46:23.034569 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:46:23.038996 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:46:23.049514 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:46:23.054172 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:46:23.058040 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:46:23.061232 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:46:23.064899 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:46:23.070478 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:46:23.075133 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:46:23.089275 (MainThread): Partial parsing not enabled
2021-10-07 14:46:23.132261 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:46:23.162300 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:46:23.175153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0d02e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0ce89e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0ce84430>]}
2021-10-07 14:46:23.177840 (MainThread): Flushing usage events
2021-10-07 14:46:23.716685 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 14:46:23.728436 (MainThread): Encountered an error:
2021-10-07 14:46:23.732728 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 14:46:23.742791 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

2021-10-07 14:46:34.057087 (MainThread): Running with dbt=0.19.0
2021-10-07 14:46:34.270014 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 14:46:34.283160 (MainThread): Tracking: tracking
2021-10-07 14:46:34.288955 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55a0615fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55a3c1c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55a06260a0>]}
2021-10-07 14:46:34.337914 (MainThread): Partial parsing not enabled
2021-10-07 14:46:34.344233 (MainThread): Parsing macros/Luhns.sql
2021-10-07 14:46:34.355880 (MainThread): Parsing macros/relations.sql
2021-10-07 14:46:34.366574 (MainThread): Parsing macros/adapters.sql
2021-10-07 14:46:34.393372 (MainThread): Parsing macros/catalog.sql
2021-10-07 14:46:34.398241 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 14:46:34.404322 (MainThread): Parsing macros/core.sql
2021-10-07 14:46:34.410628 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 14:46:34.454283 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 14:46:34.465406 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 14:46:34.475348 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 14:46:34.483482 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 14:46:34.503521 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 14:46:34.511454 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 14:46:34.547849 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 14:46:34.563815 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 14:46:34.585977 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 14:46:34.590373 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 14:46:34.600641 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 14:46:34.609919 (MainThread): Parsing macros/etc/query.sql
2021-10-07 14:46:34.615651 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 14:46:34.623014 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 14:46:34.640512 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 14:46:34.645166 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 14:46:34.649245 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 14:46:34.652420 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 14:46:34.656177 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 14:46:34.661447 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 14:46:34.665942 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 14:46:34.685353 (MainThread): Partial parsing not enabled
2021-10-07 14:46:34.724464 (MainThread): Acquiring new postgres connection "model.my_new_project.firstnames".
2021-10-07 14:46:34.759740 (MainThread): Acquiring new postgres connection "model.my_new_project.lostamounts".
2021-10-07 14:46:34.772899 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55a05749a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55a0438f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55a0435340>]}
2021-10-07 14:46:34.775188 (MainThread): Flushing usage events
2021-10-07 14:46:35.306147 (MainThread): Connection 'model.my_new_project.lostamounts' was properly closed.
2021-10-07 14:46:35.314176 (MainThread): Encountered an error:
2021-10-07 14:46:35.319233 (MainThread): Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)
2021-10-07 14:46:35.334063 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 170, in safe_range
    rng = range_type(*args)
TypeError: 'Undefined' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model lostamounts (models/lostamounts.sql)
  'Undefined' object cannot be interpreted as an integer
  
  > in macro Luhns (macros/Luhns.sql)
  > called by model lostamounts (models/lostamounts.sql)

